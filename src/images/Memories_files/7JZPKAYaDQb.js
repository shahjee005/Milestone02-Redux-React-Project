if (self.CavalryLogger) { CavalryLogger.start_js(["qUkdb"]); }

__d("createExponentialMovingAverage",[],(function(a,b,c,d,e,f){function a(a,b){b===void 0&&(b=0);var c=b;return function(b){return c+=a*(b-c)}}function g(a){return function(b){return 1-Math.exp(-b/a)}}function b(a,b){b===void 0&&(b=0);var c=b,d=g(a);return function(a,b){return c+=d(b)*(a-c)}}a.createContinuous=b;e.exports=a}),null);
__d("VelocityTracker",["createExponentialMovingAverage","performanceNow"],(function(a,b,c,d,e,f){var g;a=function(){"use strict";function a(a,c){a===void 0&&(a=50),c===void 0&&(c={x:0,y:0}),this.$5=c.x,this.$6=c.y,this.$1=(g||(g=b("performanceNow")))(),this.$2=b("createExponentialMovingAverage").createContinuous(a,this.$5),this.$3=b("createExponentialMovingAverage").createContinuous(a,this.$6)}var c=a.prototype;c.update=function(a,c){var d=0;this.$4?(d=(g||(g=b("performanceNow")))()-this.$1,d=this.updateVelocity((a-this.$4.x)*1e3/d,(c-this.$4.y)*1e3/d)):this.$1=(g||(g=b("performanceNow")))();this.$4={x:a,y:c};return d};c.updateVelocity=function(a,c){var d=(g||(g=b("performanceNow")))(),e=d-this.$1;this.$1=d;this.$5=this.$2(a,e);this.$6=this.$3(c,e);return e};c.getVelocityX=function(){return Math.trunc(this.$5)};c.getVelocityY=function(){return Math.trunc(this.$6)};c.getSpeed=function(){return Math.trunc(Math.sqrt(this.$5*this.$5+this.$6*this.$6))};return a}();e.exports=a}),null);
__d("VideoComposerVideoEditorToolTypes",["keyMirror"],(function(a,b,c,d,e,f){"use strict";a=b("keyMirror")({TRIM:"",SOUND:""});e.exports={VideoComposerVideoEditorTools:a}}),null);
__d("VideoComposerDragAndDropScrubberTypes",["keyMirror"],(function(a,b,c,d,e,f){"use strict";a=b("keyMirror")({ADD:"",MOVE:"",RESIZE:"",TRACK_VOLUME:""});c=b("keyMirror")({AUDIO:""});d=b("keyMirror")({CIRCLE:"",SQUARE:""});e.exports={VideoComposerDragAndDropScrubberActionTypes:a,VideoComposerDragAndDropScrubberItemSourceNumberShapeTypes:d,VideoComposerDragAndDropScrubberItemSourceTypes:c}}),null);
__d("VideoComposerPollsTypes",["ImmutableRecordWithV4Types","immutable","keyMirror"],(function(a,b,c,d,e,f){"use strict";a=b("ImmutableRecordWithV4Types").Record;c=a({id:"",text:"",stickerID:"",imageURL:null,imageFile:null});d=a({id:"",isPersisted:!1,canChangePollType:!0,options:b("immutable").List(),questionText:"",startTime:"",endTime:"",showResults:!0,displayResultsTimestamp:void 0,votingClosedTimestamp:void 0,isAdBreakPoll:!1,pollType:void 0,optionType:"TEXT"});f=a({id:"",isPersisted:!1,questionText:"",emoji:"",startTime:"",endTime:""});a=b("keyMirror")({CLOSED:null,LIST_VIEW:null,ADDING_NEW_POLL:null,EDITING_POLL:null,ADDING_NEW_SLIDER:null,EDITING_SLIDER:null});e.exports={EditorState:a,PollDataRecordFactory:d,PollOptionDataRecordFactory:c,SliderDataRecordFactory:f}}),null);
/**
 * License: https://www.facebook.com/legal/license/MDzNl_j9yvg/
 */
__d("gl-matrix-3.0.0",[],(function(a,b,c,d,e,f){"use strict";var g={},h={exports:g};function i(){Object.defineProperty(g,"__esModule",{value:!0});g.setMatrixArrayType=b;g.toRadian=d;g.equals=e;g.RANDOM=g.ARRAY_TYPE=g.EPSILON=void 0;var a=1e-6;g.EPSILON=a;b=typeof Float32Array!=="undefined"?Float32Array:Array;g.ARRAY_TYPE=b;d=Math.random;g.RANDOM=d;function b(a){g.ARRAY_TYPE=a}var c=Math.PI/180;function d(a){return a*c}function e(b,c){return Math.abs(b-c)<=a*Math.max(1,Math.abs(b),Math.abs(c))}}var j=!1,k=function(){j||(j=!0,i());return h.exports},l={},m={exports:l};function n(){Object.defineProperty(l,"__esModule",{value:!0});l.create=c;l.clone=d;l.copy=e;l.identity=f;l.fromValues=g;l.set=h;l.transpose=i;l.invert=j;l.adjoint=m;l.determinant=n;l.multiply=o;l.rotate=p;l.scale=q;l.fromRotation=r;l.fromScaling=s;l.str=t;l.frob=u;l.LDU=v;l.add=w;l.subtract=x;l.exactEquals=y;l.equals=z;l.multiplyScalar=A;l.multiplyScalarAndAdd=B;l.sub=l.mul=void 0;var a=b(k());function b(a){if(a&&a.__esModule)return a;else{var b={};if(a!=null)for(var c in a)if(Object.prototype.hasOwnProperty.call(a,c)){var d=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(a,c):{};d.get||d.set?Object.defineProperty(b,c,d):b[c]=a[c]}b["default"]=a;return b}}function c(){var b=new a.ARRAY_TYPE(4);a.ARRAY_TYPE!=Float32Array&&(b[1]=0,b[2]=0);b[0]=1;b[3]=1;return b}function d(b){var c=new a.ARRAY_TYPE(4);c[0]=b[0];c[1]=b[1];c[2]=b[2];c[3]=b[3];return c}function e(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];return a}function f(a){a[0]=1;a[1]=0;a[2]=0;a[3]=1;return a}function g(b,c,d,e){var f=new a.ARRAY_TYPE(4);f[0]=b;f[1]=c;f[2]=d;f[3]=e;return f}function h(a,b,c,d,e){a[0]=b;a[1]=c;a[2]=d;a[3]=e;return a}function i(a,b){if(a===b){var c=b[1];a[1]=b[2];a[2]=c}else a[0]=b[0],a[1]=b[2],a[2]=b[1],a[3]=b[3];return a}function j(a,b){var c=b[0],d=b[1],e=b[2];b=b[3];var f=c*b-e*d;if(!f)return null;f=1/f;a[0]=b*f;a[1]=-d*f;a[2]=-e*f;a[3]=c*f;return a}function m(a,b){var c=b[0];a[0]=b[3];a[1]=-b[1];a[2]=-b[2];a[3]=c;return a}function n(a){return a[0]*a[3]-a[2]*a[1]}function o(a,b,c){var d=b[0],e=b[1],f=b[2];b=b[3];var g=c[0],h=c[1],i=c[2];c=c[3];a[0]=d*g+f*h;a[1]=e*g+b*h;a[2]=d*i+f*c;a[3]=e*i+b*c;return a}function p(a,b,c){var d=b[0],e=b[1],f=b[2];b=b[3];var g=Math.sin(c);c=Math.cos(c);a[0]=d*c+f*g;a[1]=e*c+b*g;a[2]=d*-g+f*c;a[3]=e*-g+b*c;return a}function q(a,b,c){var d=b[0],e=b[1],f=b[2];b=b[3];var g=c[0];c=c[1];a[0]=d*g;a[1]=e*g;a[2]=f*c;a[3]=b*c;return a}function r(a,b){var c=Math.sin(b);b=Math.cos(b);a[0]=b;a[1]=c;a[2]=-c;a[3]=b;return a}function s(a,b){a[0]=b[0];a[1]=0;a[2]=0;a[3]=b[1];return a}function t(a){return"mat2("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"}function u(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2))}function v(a,b,c,d){a[2]=d[2]/d[0];c[0]=d[0];c[1]=d[1];c[3]=d[3]-a[2]*c[1];return[a,b,c]}function w(a,b,c){a[0]=b[0]+c[0];a[1]=b[1]+c[1];a[2]=b[2]+c[2];a[3]=b[3]+c[3];return a}function x(a,b,c){a[0]=b[0]-c[0];a[1]=b[1]-c[1];a[2]=b[2]-c[2];a[3]=b[3]-c[3];return a}function y(a,b){return a[0]===b[0]&&a[1]===b[1]&&a[2]===b[2]&&a[3]===b[3]}function z(b,c){var d=b[0],e=b[1],f=b[2];b=b[3];var g=c[0],h=c[1],i=c[2];c=c[3];return Math.abs(d-g)<=a.EPSILON*Math.max(1,Math.abs(d),Math.abs(g))&&Math.abs(e-h)<=a.EPSILON*Math.max(1,Math.abs(e),Math.abs(h))&&Math.abs(f-i)<=a.EPSILON*Math.max(1,Math.abs(f),Math.abs(i))&&Math.abs(b-c)<=a.EPSILON*Math.max(1,Math.abs(b),Math.abs(c))}function A(a,b,c){a[0]=b[0]*c;a[1]=b[1]*c;a[2]=b[2]*c;a[3]=b[3]*c;return a}function B(b,c,d,a){b[0]=c[0]+d[0]*a;b[1]=c[1]+d[1]*a;b[2]=c[2]+d[2]*a;b[3]=c[3]+d[3]*a;return b}c=o;l.mul=c;d=x;l.sub=d}var o=!1,p=function(){o||(o=!0,n());return m.exports},q={},r={exports:q};function s(){Object.defineProperty(q,"__esModule",{value:!0});q.create=c;q.clone=d;q.copy=e;q.identity=f;q.fromValues=g;q.set=h;q.invert=i;q.determinant=j;q.multiply=l;q.rotate=m;q.scale=n;q.translate=o;q.fromRotation=p;q.fromScaling=r;q.fromTranslation=s;q.str=t;q.frob=u;q.add=v;q.subtract=w;q.multiplyScalar=x;q.multiplyScalarAndAdd=y;q.exactEquals=z;q.equals=A;q.sub=q.mul=void 0;var a=b(k());function b(a){if(a&&a.__esModule)return a;else{var b={};if(a!=null)for(var c in a)if(Object.prototype.hasOwnProperty.call(a,c)){var d=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(a,c):{};d.get||d.set?Object.defineProperty(b,c,d):b[c]=a[c]}b["default"]=a;return b}}function c(){var b=new a.ARRAY_TYPE(6);a.ARRAY_TYPE!=Float32Array&&(b[1]=0,b[2]=0,b[4]=0,b[5]=0);b[0]=1;b[3]=1;return b}function d(b){var c=new a.ARRAY_TYPE(6);c[0]=b[0];c[1]=b[1];c[2]=b[2];c[3]=b[3];c[4]=b[4];c[5]=b[5];return c}function e(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];a[4]=b[4];a[5]=b[5];return a}function f(a){a[0]=1;a[1]=0;a[2]=0;a[3]=1;a[4]=0;a[5]=0;return a}function g(b,c,d,e,f,g){var h=new a.ARRAY_TYPE(6);h[0]=b;h[1]=c;h[2]=d;h[3]=e;h[4]=f;h[5]=g;return h}function h(a,b,c,d,e,f,g){a[0]=b;a[1]=c;a[2]=d;a[3]=e;a[4]=f;a[5]=g;return a}function i(a,b){var c=b[0],d=b[1],e=b[2],f=b[3],g=b[4];b=b[5];var h=c*f-d*e;if(!h)return null;h=1/h;a[0]=f*h;a[1]=-d*h;a[2]=-e*h;a[3]=c*h;a[4]=(e*b-f*g)*h;a[5]=(d*g-c*b)*h;return a}function j(a){return a[0]*a[3]-a[1]*a[2]}function l(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3],h=b[4];b=b[5];var i=c[0],j=c[1],k=c[2],l=c[3],m=c[4];c=c[5];a[0]=d*i+f*j;a[1]=e*i+g*j;a[2]=d*k+f*l;a[3]=e*k+g*l;a[4]=d*m+f*c+h;a[5]=e*m+g*c+b;return a}function m(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3],h=b[4];b=b[5];var i=Math.sin(c);c=Math.cos(c);a[0]=d*c+f*i;a[1]=e*c+g*i;a[2]=d*-i+f*c;a[3]=e*-i+g*c;a[4]=h;a[5]=b;return a}function n(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3],h=b[4];b=b[5];var i=c[0];c=c[1];a[0]=d*i;a[1]=e*i;a[2]=f*c;a[3]=g*c;a[4]=h;a[5]=b;return a}function o(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3],h=b[4];b=b[5];var i=c[0];c=c[1];a[0]=d;a[1]=e;a[2]=f;a[3]=g;a[4]=d*i+f*c+h;a[5]=e*i+g*c+b;return a}function p(a,b){var c=Math.sin(b);b=Math.cos(b);a[0]=b;a[1]=c;a[2]=-c;a[3]=b;a[4]=0;a[5]=0;return a}function r(a,b){a[0]=b[0];a[1]=0;a[2]=0;a[3]=b[1];a[4]=0;a[5]=0;return a}function s(a,b){a[0]=1;a[1]=0;a[2]=0;a[3]=1;a[4]=b[0];a[5]=b[1];return a}function t(a){return"mat2d("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+")"}function u(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+1)}function v(a,b,c){a[0]=b[0]+c[0];a[1]=b[1]+c[1];a[2]=b[2]+c[2];a[3]=b[3]+c[3];a[4]=b[4]+c[4];a[5]=b[5]+c[5];return a}function w(a,b,c){a[0]=b[0]-c[0];a[1]=b[1]-c[1];a[2]=b[2]-c[2];a[3]=b[3]-c[3];a[4]=b[4]-c[4];a[5]=b[5]-c[5];return a}function x(a,b,c){a[0]=b[0]*c;a[1]=b[1]*c;a[2]=b[2]*c;a[3]=b[3]*c;a[4]=b[4]*c;a[5]=b[5]*c;return a}function y(b,c,d,a){b[0]=c[0]+d[0]*a;b[1]=c[1]+d[1]*a;b[2]=c[2]+d[2]*a;b[3]=c[3]+d[3]*a;b[4]=c[4]+d[4]*a;b[5]=c[5]+d[5]*a;return b}function z(a,b){return a[0]===b[0]&&a[1]===b[1]&&a[2]===b[2]&&a[3]===b[3]&&a[4]===b[4]&&a[5]===b[5]}function A(b,c){var d=b[0],e=b[1],f=b[2],g=b[3],h=b[4];b=b[5];var i=c[0],j=c[1],k=c[2],l=c[3],m=c[4];c=c[5];return Math.abs(d-i)<=a.EPSILON*Math.max(1,Math.abs(d),Math.abs(i))&&Math.abs(e-j)<=a.EPSILON*Math.max(1,Math.abs(e),Math.abs(j))&&Math.abs(f-k)<=a.EPSILON*Math.max(1,Math.abs(f),Math.abs(k))&&Math.abs(g-l)<=a.EPSILON*Math.max(1,Math.abs(g),Math.abs(l))&&Math.abs(h-m)<=a.EPSILON*Math.max(1,Math.abs(h),Math.abs(m))&&Math.abs(b-c)<=a.EPSILON*Math.max(1,Math.abs(b),Math.abs(c))}c=l;q.mul=c;d=w;q.sub=d}var t=!1,u=function(){t||(t=!0,s());return r.exports},v={},w={exports:v};function x(){Object.defineProperty(v,"__esModule",{value:!0});v.create=c;v.fromMat4=d;v.clone=e;v.copy=f;v.fromValues=g;v.set=h;v.identity=i;v.transpose=j;v.invert=l;v.adjoint=m;v.determinant=n;v.multiply=o;v.translate=p;v.rotate=q;v.scale=r;v.fromTranslation=s;v.fromRotation=t;v.fromScaling=u;v.fromMat2d=w;v.fromQuat=x;v.normalFromMat4=y;v.projection=z;v.str=A;v.frob=B;v.add=C;v.subtract=D;v.multiplyScalar=E;v.multiplyScalarAndAdd=F;v.exactEquals=G;v.equals=H;v.sub=v.mul=void 0;var a=b(k());function b(a){if(a&&a.__esModule)return a;else{var b={};if(a!=null)for(var c in a)if(Object.prototype.hasOwnProperty.call(a,c)){var d=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(a,c):{};d.get||d.set?Object.defineProperty(b,c,d):b[c]=a[c]}b["default"]=a;return b}}function c(){var b=new a.ARRAY_TYPE(9);a.ARRAY_TYPE!=Float32Array&&(b[1]=0,b[2]=0,b[3]=0,b[5]=0,b[6]=0,b[7]=0);b[0]=1;b[4]=1;b[8]=1;return b}function d(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[4];a[4]=b[5];a[5]=b[6];a[6]=b[8];a[7]=b[9];a[8]=b[10];return a}function e(b){var c=new a.ARRAY_TYPE(9);c[0]=b[0];c[1]=b[1];c[2]=b[2];c[3]=b[3];c[4]=b[4];c[5]=b[5];c[6]=b[6];c[7]=b[7];c[8]=b[8];return c}function f(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];a[4]=b[4];a[5]=b[5];a[6]=b[6];a[7]=b[7];a[8]=b[8];return a}function g(b,c,d,e,f,g,h,i,j){var k=new a.ARRAY_TYPE(9);k[0]=b;k[1]=c;k[2]=d;k[3]=e;k[4]=f;k[5]=g;k[6]=h;k[7]=i;k[8]=j;return k}function h(a,b,c,d,e,f,g,h,i,j){a[0]=b;a[1]=c;a[2]=d;a[3]=e;a[4]=f;a[5]=g;a[6]=h;a[7]=i;a[8]=j;return a}function i(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a}function j(a,b){if(a===b){var c=b[1],d=b[2],e=b[5];a[1]=b[3];a[2]=b[6];a[3]=c;a[5]=b[7];a[6]=d;a[7]=e}else a[0]=b[0],a[1]=b[3],a[2]=b[6],a[3]=b[1],a[4]=b[4],a[5]=b[7],a[6]=b[2],a[7]=b[5],a[8]=b[8];return a}function l(a,b){var c=b[0],d=b[1],e=b[2],f=b[3],g=b[4],h=b[5],i=b[6],j=b[7];b=b[8];var k=b*g-h*j,l=-b*f+h*i,m=j*f-g*i,n=c*k+d*l+e*m;if(!n)return null;n=1/n;a[0]=k*n;a[1]=(-b*d+e*j)*n;a[2]=(h*d-e*g)*n;a[3]=l*n;a[4]=(b*c-e*i)*n;a[5]=(-h*c+e*f)*n;a[6]=m*n;a[7]=(-j*c+d*i)*n;a[8]=(g*c-d*f)*n;return a}function m(a,b){var c=b[0],d=b[1],e=b[2],f=b[3],g=b[4],h=b[5],i=b[6],j=b[7];b=b[8];a[0]=g*b-h*j;a[1]=e*j-d*b;a[2]=d*h-e*g;a[3]=h*i-f*b;a[4]=c*b-e*i;a[5]=e*f-c*h;a[6]=f*j-g*i;a[7]=d*i-c*j;a[8]=c*g-d*f;return a}function n(a){var b=a[0],c=a[1],d=a[2],e=a[3],f=a[4],g=a[5],h=a[6],i=a[7];a=a[8];return b*(a*f-g*i)+c*(-a*e+g*h)+d*(i*e-f*h)}function o(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3],h=b[4],i=b[5],j=b[6],k=b[7];b=b[8];var l=c[0],m=c[1],n=c[2],o=c[3],p=c[4],q=c[5],r=c[6],s=c[7];c=c[8];a[0]=l*d+m*g+n*j;a[1]=l*e+m*h+n*k;a[2]=l*f+m*i+n*b;a[3]=o*d+p*g+q*j;a[4]=o*e+p*h+q*k;a[5]=o*f+p*i+q*b;a[6]=r*d+s*g+c*j;a[7]=r*e+s*h+c*k;a[8]=r*f+s*i+c*b;return a}function p(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3],h=b[4],i=b[5],j=b[6],k=b[7];b=b[8];var l=c[0];c=c[1];a[0]=d;a[1]=e;a[2]=f;a[3]=g;a[4]=h;a[5]=i;a[6]=l*d+c*g+j;a[7]=l*e+c*h+k;a[8]=l*f+c*i+b;return a}function q(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3],h=b[4],i=b[5],j=b[6],k=b[7];b=b[8];var l=Math.sin(c);c=Math.cos(c);a[0]=c*d+l*g;a[1]=c*e+l*h;a[2]=c*f+l*i;a[3]=c*g-l*d;a[4]=c*h-l*e;a[5]=c*i-l*f;a[6]=j;a[7]=k;a[8]=b;return a}function r(a,b,c){var d=c[0];c=c[1];a[0]=d*b[0];a[1]=d*b[1];a[2]=d*b[2];a[3]=c*b[3];a[4]=c*b[4];a[5]=c*b[5];a[6]=b[6];a[7]=b[7];a[8]=b[8];return a}function s(a,b){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=b[0];a[7]=b[1];a[8]=1;return a}function t(a,b){var c=Math.sin(b);b=Math.cos(b);a[0]=b;a[1]=c;a[2]=0;a[3]=-c;a[4]=b;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a}function u(a,b){a[0]=b[0];a[1]=0;a[2]=0;a[3]=0;a[4]=b[1];a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a}function w(a,b){a[0]=b[0];a[1]=b[1];a[2]=0;a[3]=b[2];a[4]=b[3];a[5]=0;a[6]=b[4];a[7]=b[5];a[8]=1;return a}function x(a,b){var c=b[0],d=b[1],e=b[2];b=b[3];var f=c+c,g=d+d,h=e+e;c=c*f;var i=d*f;d=d*g;var j=e*f,k=e*g;e=e*h;f=b*f;g=b*g;b=b*h;a[0]=1-d-e;a[3]=i-b;a[6]=j+g;a[1]=i+b;a[4]=1-c-e;a[7]=k-f;a[2]=j-g;a[5]=k+f;a[8]=1-c-d;return a}function y(a,b){var c=b[0],d=b[1],e=b[2],f=b[3],g=b[4],h=b[5],i=b[6],j=b[7],k=b[8],l=b[9],m=b[10],n=b[11],o=b[12],p=b[13],q=b[14];b=b[15];var r=c*h-d*g,s=c*i-e*g,t=c*j-f*g,u=d*i-e*h,v=d*j-f*h,w=e*j-f*i,x=k*p-l*o,y=k*q-m*o;k=k*b-n*o;var z=l*q-m*p;l=l*b-n*p;m=m*b-n*q;n=r*m-s*l+t*z+u*k-v*y+w*x;if(!n)return null;n=1/n;a[0]=(h*m-i*l+j*z)*n;a[1]=(i*k-g*m-j*y)*n;a[2]=(g*l-h*k+j*x)*n;a[3]=(e*l-d*m-f*z)*n;a[4]=(c*m-e*k+f*y)*n;a[5]=(d*k-c*l-f*x)*n;a[6]=(p*w-q*v+b*u)*n;a[7]=(q*t-o*w-b*s)*n;a[8]=(o*v-p*t+b*r)*n;return a}function z(a,b,c){a[0]=2/b;a[1]=0;a[2]=0;a[3]=0;a[4]=-2/c;a[5]=0;a[6]=-1;a[7]=1;a[8]=1;return a}function A(a){return"mat3("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+")"}function B(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[7],2)+Math.pow(a[8],2))}function C(a,b,c){a[0]=b[0]+c[0];a[1]=b[1]+c[1];a[2]=b[2]+c[2];a[3]=b[3]+c[3];a[4]=b[4]+c[4];a[5]=b[5]+c[5];a[6]=b[6]+c[6];a[7]=b[7]+c[7];a[8]=b[8]+c[8];return a}function D(a,b,c){a[0]=b[0]-c[0];a[1]=b[1]-c[1];a[2]=b[2]-c[2];a[3]=b[3]-c[3];a[4]=b[4]-c[4];a[5]=b[5]-c[5];a[6]=b[6]-c[6];a[7]=b[7]-c[7];a[8]=b[8]-c[8];return a}function E(a,b,c){a[0]=b[0]*c;a[1]=b[1]*c;a[2]=b[2]*c;a[3]=b[3]*c;a[4]=b[4]*c;a[5]=b[5]*c;a[6]=b[6]*c;a[7]=b[7]*c;a[8]=b[8]*c;return a}function F(b,c,d,a){b[0]=c[0]+d[0]*a;b[1]=c[1]+d[1]*a;b[2]=c[2]+d[2]*a;b[3]=c[3]+d[3]*a;b[4]=c[4]+d[4]*a;b[5]=c[5]+d[5]*a;b[6]=c[6]+d[6]*a;b[7]=c[7]+d[7]*a;b[8]=c[8]+d[8]*a;return b}function G(a,b){return a[0]===b[0]&&a[1]===b[1]&&a[2]===b[2]&&a[3]===b[3]&&a[4]===b[4]&&a[5]===b[5]&&a[6]===b[6]&&a[7]===b[7]&&a[8]===b[8]}function H(b,c){var d=b[0],e=b[1],f=b[2],g=b[3],h=b[4],i=b[5],j=b[6],k=b[7];b=b[8];var l=c[0],m=c[1],n=c[2],o=c[3],p=c[4],q=c[5],r=c[6],s=c[7];c=c[8];return Math.abs(d-l)<=a.EPSILON*Math.max(1,Math.abs(d),Math.abs(l))&&Math.abs(e-m)<=a.EPSILON*Math.max(1,Math.abs(e),Math.abs(m))&&Math.abs(f-n)<=a.EPSILON*Math.max(1,Math.abs(f),Math.abs(n))&&Math.abs(g-o)<=a.EPSILON*Math.max(1,Math.abs(g),Math.abs(o))&&Math.abs(h-p)<=a.EPSILON*Math.max(1,Math.abs(h),Math.abs(p))&&Math.abs(i-q)<=a.EPSILON*Math.max(1,Math.abs(i),Math.abs(q))&&Math.abs(j-r)<=a.EPSILON*Math.max(1,Math.abs(j),Math.abs(r))&&Math.abs(k-s)<=a.EPSILON*Math.max(1,Math.abs(k),Math.abs(s))&&Math.abs(b-c)<=a.EPSILON*Math.max(1,Math.abs(b),Math.abs(c))}c=o;v.mul=c;d=D;v.sub=d}var y=!1,z=function(){y||(y=!0,x());return w.exports},A={},B={exports:A};function C(){Object.defineProperty(A,"__esModule",{value:!0});A.create=c;A.clone=d;A.copy=e;A.fromValues=f;A.set=g;A.identity=h;A.transpose=i;A.invert=j;A.adjoint=l;A.determinant=m;A.multiply=n;A.translate=o;A.scale=p;A.rotate=q;A.rotateX=r;A.rotateY=s;A.rotateZ=t;A.fromTranslation=u;A.fromScaling=v;A.fromRotation=w;A.fromXRotation=x;A.fromYRotation=y;A.fromZRotation=z;A.fromRotationTranslation=B;A.fromQuat2=C;A.getTranslation=D;A.getScaling=E;A.getRotation=F;A.fromRotationTranslationScale=G;A.fromRotationTranslationScaleOrigin=H;A.fromQuat=I;A.frustum=J;A.perspective=K;A.perspectiveFromFieldOfView=L;A.ortho=M;A.lookAt=N;A.targetTo=O;A.str=P;A.frob=Q;A.add=R;A.subtract=S;A.multiplyScalar=T;A.multiplyScalarAndAdd=U;A.exactEquals=V;A.equals=W;A.sub=A.mul=void 0;var a=b(k());function b(a){if(a&&a.__esModule)return a;else{var b={};if(a!=null)for(var c in a)if(Object.prototype.hasOwnProperty.call(a,c)){var d=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(a,c):{};d.get||d.set?Object.defineProperty(b,c,d):b[c]=a[c]}b["default"]=a;return b}}function c(){var b=new a.ARRAY_TYPE(16);a.ARRAY_TYPE!=Float32Array&&(b[1]=0,b[2]=0,b[3]=0,b[4]=0,b[6]=0,b[7]=0,b[8]=0,b[9]=0,b[11]=0,b[12]=0,b[13]=0,b[14]=0);b[0]=1;b[5]=1;b[10]=1;b[15]=1;return b}function d(b){var c=new a.ARRAY_TYPE(16);c[0]=b[0];c[1]=b[1];c[2]=b[2];c[3]=b[3];c[4]=b[4];c[5]=b[5];c[6]=b[6];c[7]=b[7];c[8]=b[8];c[9]=b[9];c[10]=b[10];c[11]=b[11];c[12]=b[12];c[13]=b[13];c[14]=b[14];c[15]=b[15];return c}function e(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];a[4]=b[4];a[5]=b[5];a[6]=b[6];a[7]=b[7];a[8]=b[8];a[9]=b[9];a[10]=b[10];a[11]=b[11];a[12]=b[12];a[13]=b[13];a[14]=b[14];a[15]=b[15];return a}function f(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){var r=new a.ARRAY_TYPE(16);r[0]=b;r[1]=c;r[2]=d;r[3]=e;r[4]=f;r[5]=g;r[6]=h;r[7]=i;r[8]=j;r[9]=k;r[10]=l;r[11]=m;r[12]=n;r[13]=o;r[14]=p;r[15]=q;return r}function g(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){a[0]=b;a[1]=c;a[2]=d;a[3]=e;a[4]=f;a[5]=g;a[6]=h;a[7]=i;a[8]=j;a[9]=k;a[10]=l;a[11]=m;a[12]=n;a[13]=o;a[14]=p;a[15]=q;return a}function h(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a}function i(a,b){if(a===b){var c=b[1],d=b[2],e=b[3],f=b[6],g=b[7],h=b[11];a[1]=b[4];a[2]=b[8];a[3]=b[12];a[4]=c;a[6]=b[9];a[7]=b[13];a[8]=d;a[9]=f;a[11]=b[14];a[12]=e;a[13]=g;a[14]=h}else a[0]=b[0],a[1]=b[4],a[2]=b[8],a[3]=b[12],a[4]=b[1],a[5]=b[5],a[6]=b[9],a[7]=b[13],a[8]=b[2],a[9]=b[6],a[10]=b[10],a[11]=b[14],a[12]=b[3],a[13]=b[7],a[14]=b[11],a[15]=b[15];return a}function j(a,b){var c=b[0],d=b[1],e=b[2],f=b[3],g=b[4],h=b[5],i=b[6],j=b[7],k=b[8],l=b[9],m=b[10],n=b[11],o=b[12],p=b[13],q=b[14];b=b[15];var r=c*h-d*g,s=c*i-e*g,t=c*j-f*g,u=d*i-e*h,v=d*j-f*h,w=e*j-f*i,x=k*p-l*o,y=k*q-m*o,z=k*b-n*o,A=l*q-m*p,B=l*b-n*p,C=m*b-n*q,D=r*C-s*B+t*A+u*z-v*y+w*x;if(!D)return null;D=1/D;a[0]=(h*C-i*B+j*A)*D;a[1]=(e*B-d*C-f*A)*D;a[2]=(p*w-q*v+b*u)*D;a[3]=(m*v-l*w-n*u)*D;a[4]=(i*z-g*C-j*y)*D;a[5]=(c*C-e*z+f*y)*D;a[6]=(q*t-o*w-b*s)*D;a[7]=(k*w-m*t+n*s)*D;a[8]=(g*B-h*z+j*x)*D;a[9]=(d*z-c*B-f*x)*D;a[10]=(o*v-p*t+b*r)*D;a[11]=(l*t-k*v-n*r)*D;a[12]=(h*y-g*A-i*x)*D;a[13]=(c*A-d*y+e*x)*D;a[14]=(p*s-o*u-q*r)*D;a[15]=(k*u-l*s+m*r)*D;return a}function l(a,b){var c=b[0],d=b[1],e=b[2],f=b[3],g=b[4],h=b[5],i=b[6],j=b[7],k=b[8],l=b[9],m=b[10],n=b[11],o=b[12],p=b[13],q=b[14];b=b[15];a[0]=h*(m*b-n*q)-l*(i*b-j*q)+p*(i*n-j*m);a[1]=-(d*(m*b-n*q)-l*(e*b-f*q)+p*(e*n-f*m));a[2]=d*(i*b-j*q)-h*(e*b-f*q)+p*(e*j-f*i);a[3]=-(d*(i*n-j*m)-h*(e*n-f*m)+l*(e*j-f*i));a[4]=-(g*(m*b-n*q)-k*(i*b-j*q)+o*(i*n-j*m));a[5]=c*(m*b-n*q)-k*(e*b-f*q)+o*(e*n-f*m);a[6]=-(c*(i*b-j*q)-g*(e*b-f*q)+o*(e*j-f*i));a[7]=c*(i*n-j*m)-g*(e*n-f*m)+k*(e*j-f*i);a[8]=g*(l*b-n*p)-k*(h*b-j*p)+o*(h*n-j*l);a[9]=-(c*(l*b-n*p)-k*(d*b-f*p)+o*(d*n-f*l));a[10]=c*(h*b-j*p)-g*(d*b-f*p)+o*(d*j-f*h);a[11]=-(c*(h*n-j*l)-g*(d*n-f*l)+k*(d*j-f*h));a[12]=-(g*(l*q-m*p)-k*(h*q-i*p)+o*(h*m-i*l));a[13]=c*(l*q-m*p)-k*(d*q-e*p)+o*(d*m-e*l);a[14]=-(c*(h*q-i*p)-g*(d*q-e*p)+o*(d*i-e*h));a[15]=c*(h*m-i*l)-g*(d*m-e*l)+k*(d*i-e*h);return a}function m(a){var b=a[0],c=a[1],d=a[2],e=a[3],f=a[4],g=a[5],h=a[6],i=a[7],j=a[8],k=a[9],l=a[10],m=a[11],n=a[12],o=a[13],p=a[14];a=a[15];var q=b*g-c*f,r=b*h-d*f;b=b*i-e*f;f=c*h-d*g;c=c*i-e*g;g=d*i-e*h;d=j*o-k*n;i=j*p-l*n;e=j*a-m*n;h=k*p-l*o;j=k*a-m*o;n=l*a-m*p;return q*n-r*j+b*h+f*e-c*i+g*d}function n(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3],h=b[4],i=b[5],j=b[6],k=b[7],l=b[8],m=b[9],n=b[10],o=b[11],p=b[12],q=b[13],r=b[14];b=b[15];var s=c[0],t=c[1],u=c[2],v=c[3];a[0]=s*d+t*h+u*l+v*p;a[1]=s*e+t*i+u*m+v*q;a[2]=s*f+t*j+u*n+v*r;a[3]=s*g+t*k+u*o+v*b;s=c[4];t=c[5];u=c[6];v=c[7];a[4]=s*d+t*h+u*l+v*p;a[5]=s*e+t*i+u*m+v*q;a[6]=s*f+t*j+u*n+v*r;a[7]=s*g+t*k+u*o+v*b;s=c[8];t=c[9];u=c[10];v=c[11];a[8]=s*d+t*h+u*l+v*p;a[9]=s*e+t*i+u*m+v*q;a[10]=s*f+t*j+u*n+v*r;a[11]=s*g+t*k+u*o+v*b;s=c[12];t=c[13];u=c[14];v=c[15];a[12]=s*d+t*h+u*l+v*p;a[13]=s*e+t*i+u*m+v*q;a[14]=s*f+t*j+u*n+v*r;a[15]=s*g+t*k+u*o+v*b;return a}function o(a,b,c){var d=c[0],e=c[1];c=c[2];var f,g,h,i,j,k,l,m,n,o,p,q;b===a?(a[12]=b[0]*d+b[4]*e+b[8]*c+b[12],a[13]=b[1]*d+b[5]*e+b[9]*c+b[13],a[14]=b[2]*d+b[6]*e+b[10]*c+b[14],a[15]=b[3]*d+b[7]*e+b[11]*c+b[15]):(f=b[0],g=b[1],h=b[2],i=b[3],j=b[4],k=b[5],l=b[6],m=b[7],n=b[8],o=b[9],p=b[10],q=b[11],a[0]=f,a[1]=g,a[2]=h,a[3]=i,a[4]=j,a[5]=k,a[6]=l,a[7]=m,a[8]=n,a[9]=o,a[10]=p,a[11]=q,a[12]=f*d+j*e+n*c+b[12],a[13]=g*d+k*e+o*c+b[13],a[14]=h*d+l*e+p*c+b[14],a[15]=i*d+m*e+q*c+b[15]);return a}function p(a,b,c){var d=c[0],e=c[1];c=c[2];a[0]=b[0]*d;a[1]=b[1]*d;a[2]=b[2]*d;a[3]=b[3]*d;a[4]=b[4]*e;a[5]=b[5]*e;a[6]=b[6]*e;a[7]=b[7]*e;a[8]=b[8]*c;a[9]=b[9]*c;a[10]=b[10]*c;a[11]=b[11]*c;a[12]=b[12];a[13]=b[13];a[14]=b[14];a[15]=b[15];return a}function q(b,c,d,e){var f=e[0],g=e[1];e=e[2];var h=Math.sqrt(f*f+g*g+e*e),i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B;if(h<a.EPSILON)return null;h=1/h;f*=h;g*=h;e*=h;h=Math.sin(d);d=Math.cos(d);i=1-d;j=c[0];k=c[1];l=c[2];m=c[3];n=c[4];o=c[5];p=c[6];q=c[7];r=c[8];s=c[9];t=c[10];u=c[11];v=f*f*i+d;w=g*f*i+e*h;x=e*f*i-g*h;y=f*g*i-e*h;z=g*g*i+d;A=e*g*i+f*h;B=f*e*i+g*h;g=g*e*i-f*h;f=e*e*i+d;b[0]=j*v+n*w+r*x;b[1]=k*v+o*w+s*x;b[2]=l*v+p*w+t*x;b[3]=m*v+q*w+u*x;b[4]=j*y+n*z+r*A;b[5]=k*y+o*z+s*A;b[6]=l*y+p*z+t*A;b[7]=m*y+q*z+u*A;b[8]=j*B+n*g+r*f;b[9]=k*B+o*g+s*f;b[10]=l*B+p*g+t*f;b[11]=m*B+q*g+u*f;c!==b&&(b[12]=c[12],b[13]=c[13],b[14]=c[14],b[15]=c[15]);return b}function r(a,b,c){var d=Math.sin(c);c=Math.cos(c);var e=b[4],f=b[5],g=b[6],h=b[7],i=b[8],j=b[9],k=b[10],l=b[11];b!==a&&(a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);a[4]=e*c+i*d;a[5]=f*c+j*d;a[6]=g*c+k*d;a[7]=h*c+l*d;a[8]=i*c-e*d;a[9]=j*c-f*d;a[10]=k*c-g*d;a[11]=l*c-h*d;return a}function s(a,b,c){var d=Math.sin(c);c=Math.cos(c);var e=b[0],f=b[1],g=b[2],h=b[3],i=b[8],j=b[9],k=b[10],l=b[11];b!==a&&(a[4]=b[4],a[5]=b[5],a[6]=b[6],a[7]=b[7],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);a[0]=e*c-i*d;a[1]=f*c-j*d;a[2]=g*c-k*d;a[3]=h*c-l*d;a[8]=e*d+i*c;a[9]=f*d+j*c;a[10]=g*d+k*c;a[11]=h*d+l*c;return a}function t(a,b,c){var d=Math.sin(c);c=Math.cos(c);var e=b[0],f=b[1],g=b[2],h=b[3],i=b[4],j=b[5],k=b[6],l=b[7];b!==a&&(a[8]=b[8],a[9]=b[9],a[10]=b[10],a[11]=b[11],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);a[0]=e*c+i*d;a[1]=f*c+j*d;a[2]=g*c+k*d;a[3]=h*c+l*d;a[4]=i*c-e*d;a[5]=j*c-f*d;a[6]=k*c-g*d;a[7]=l*c-h*d;return a}function u(a,b){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=b[0];a[13]=b[1];a[14]=b[2];a[15]=1;return a}function v(a,b){a[0]=b[0];a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=b[1];a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=b[2];a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a}function w(b,c,d){var e=d[0],f=d[1];d=d[2];var g=Math.sqrt(e*e+f*f+d*d),h;if(g<a.EPSILON)return null;g=1/g;e*=g;f*=g;d*=g;g=Math.sin(c);c=Math.cos(c);h=1-c;b[0]=e*e*h+c;b[1]=f*e*h+d*g;b[2]=d*e*h-f*g;b[3]=0;b[4]=e*f*h-d*g;b[5]=f*f*h+c;b[6]=d*f*h+e*g;b[7]=0;b[8]=e*d*h+f*g;b[9]=f*d*h-e*g;b[10]=d*d*h+c;b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return b}function x(a,b){var c=Math.sin(b);b=Math.cos(b);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=b;a[6]=c;a[7]=0;a[8]=0;a[9]=-c;a[10]=b;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a}function y(a,b){var c=Math.sin(b);b=Math.cos(b);a[0]=b;a[1]=0;a[2]=-c;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=c;a[9]=0;a[10]=b;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a}function z(a,b){var c=Math.sin(b);b=Math.cos(b);a[0]=b;a[1]=c;a[2]=0;a[3]=0;a[4]=-c;a[5]=b;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a}function B(a,b,c){var d=b[0],e=b[1],f=b[2];b=b[3];var g=d+d,h=e+e,i=f+f,j=d*g,k=d*h;d=d*i;var l=e*h;e=e*i;f=f*i;g=b*g;h=b*h;b=b*i;a[0]=1-(l+f);a[1]=k+b;a[2]=d-h;a[3]=0;a[4]=k-b;a[5]=1-(j+f);a[6]=e+g;a[7]=0;a[8]=d+h;a[9]=e-g;a[10]=1-(j+l);a[11]=0;a[12]=c[0];a[13]=c[1];a[14]=c[2];a[15]=1;return a}function C(b,c){var d=new a.ARRAY_TYPE(3),e=-c[0],f=-c[1],g=-c[2],h=c[3],i=c[4],j=c[5],k=c[6],l=c[7],m=e*e+f*f+g*g+h*h;m>0?(d[0]=(i*h+l*e+j*g-k*f)*2/m,d[1]=(j*h+l*f+k*e-i*g)*2/m,d[2]=(k*h+l*g+i*f-j*e)*2/m):(d[0]=(i*h+l*e+j*g-k*f)*2,d[1]=(j*h+l*f+k*e-i*g)*2,d[2]=(k*h+l*g+i*f-j*e)*2);B(b,c,d);return b}function D(a,b){a[0]=b[12];a[1]=b[13];a[2]=b[14];return a}function E(a,b){var c=b[0],d=b[1],e=b[2],f=b[4],g=b[5],h=b[6],i=b[8],j=b[9];b=b[10];a[0]=Math.sqrt(c*c+d*d+e*e);a[1]=Math.sqrt(f*f+g*g+h*h);a[2]=Math.sqrt(i*i+j*j+b*b);return a}function F(a,b){var c=b[0]+b[5]+b[10];c>0?(c=Math.sqrt(c+1)*2,a[3]=.25*c,a[0]=(b[6]-b[9])/c,a[1]=(b[8]-b[2])/c,a[2]=(b[1]-b[4])/c):b[0]>b[5]&&b[0]>b[10]?(c=Math.sqrt(1+b[0]-b[5]-b[10])*2,a[3]=(b[6]-b[9])/c,a[0]=.25*c,a[1]=(b[1]+b[4])/c,a[2]=(b[8]+b[2])/c):b[5]>b[10]?(c=Math.sqrt(1+b[5]-b[0]-b[10])*2,a[3]=(b[8]-b[2])/c,a[0]=(b[1]+b[4])/c,a[1]=.25*c,a[2]=(b[6]+b[9])/c):(c=Math.sqrt(1+b[10]-b[0]-b[5])*2,a[3]=(b[1]-b[4])/c,a[0]=(b[8]+b[2])/c,a[1]=(b[6]+b[9])/c,a[2]=.25*c);return a}function G(a,b,c,d){var e=b[0],f=b[1],g=b[2];b=b[3];var h=e+e,i=f+f,j=g+g,k=e*h,l=e*i;e=e*j;var m=f*i;f=f*j;g=g*j;h=b*h;i=b*i;b=b*j;j=d[0];var n=d[1];d=d[2];a[0]=(1-(m+g))*j;a[1]=(l+b)*j;a[2]=(e-i)*j;a[3]=0;a[4]=(l-b)*n;a[5]=(1-(k+g))*n;a[6]=(f+h)*n;a[7]=0;a[8]=(e+i)*d;a[9]=(f-h)*d;a[10]=(1-(k+m))*d;a[11]=0;a[12]=c[0];a[13]=c[1];a[14]=c[2];a[15]=1;return a}function H(a,b,c,d,e){var f=b[0],g=b[1],h=b[2];b=b[3];var i=f+f,j=g+g,k=h+h,l=f*i,m=f*j;f=f*k;var n=g*j;g=g*k;h=h*k;i=b*i;j=b*j;b=b*k;k=d[0];var o=d[1];d=d[2];var p=e[0],q=e[1];e=e[2];var r=(1-(n+h))*k,s=(m+b)*k;k=(f-j)*k;m=(m-b)*o;b=(1-(l+h))*o;h=(g+i)*o;o=(f+j)*d;f=(g-i)*d;j=(1-(l+n))*d;a[0]=r;a[1]=s;a[2]=k;a[3]=0;a[4]=m;a[5]=b;a[6]=h;a[7]=0;a[8]=o;a[9]=f;a[10]=j;a[11]=0;a[12]=c[0]+p-(r*p+m*q+o*e);a[13]=c[1]+q-(s*p+b*q+f*e);a[14]=c[2]+e-(k*p+h*q+j*e);a[15]=1;return a}function I(a,b){var c=b[0],d=b[1],e=b[2];b=b[3];var f=c+c,g=d+d,h=e+e;c=c*f;var i=d*f;d=d*g;var j=e*f,k=e*g;e=e*h;f=b*f;g=b*g;b=b*h;a[0]=1-d-e;a[1]=i+b;a[2]=j-g;a[3]=0;a[4]=i-b;a[5]=1-c-e;a[6]=k+f;a[7]=0;a[8]=j+g;a[9]=k-f;a[10]=1-c-d;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a}function J(a,b,c,d,e,f,g){var h=1/(c-b),i=1/(e-d),j=1/(f-g);a[0]=f*2*h;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=f*2*i;a[6]=0;a[7]=0;a[8]=(c+b)*h;a[9]=(e+d)*i;a[10]=(g+f)*j;a[11]=-1;a[12]=0;a[13]=0;a[14]=g*f*2*j;a[15]=0;return a}function K(a,b,c,d,e){b=1/Math.tan(b/2);a[0]=b/c;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=b;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[11]=-1;a[12]=0;a[13]=0;a[15]=0;e!=null&&e!==Infinity?(c=1/(d-e),a[10]=(e+d)*c,a[14]=2*e*d*c):(a[10]=-1,a[14]=-2*d);return a}function L(a,b,c,d){var e=Math.tan(b.upDegrees*Math.PI/180),f=Math.tan(b.downDegrees*Math.PI/180),g=Math.tan(b.leftDegrees*Math.PI/180);b=Math.tan(b.rightDegrees*Math.PI/180);var h=2/(g+b),i=2/(e+f);a[0]=h;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=i;a[6]=0;a[7]=0;a[8]=-((g-b)*h*.5);a[9]=(e-f)*i*.5;a[10]=d/(c-d);a[11]=-1;a[12]=0;a[13]=0;a[14]=d*c/(c-d);a[15]=0;return a}function M(a,b,c,d,e,f,g){var h=1/(b-c),i=1/(d-e),j=1/(f-g);a[0]=-2*h;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=-2*i;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=2*j;a[11]=0;a[12]=(b+c)*h;a[13]=(e+d)*i;a[14]=(g+f)*j;a[15]=1;return a}function N(b,c,d,e){var f,g,i,j,k=c[0],l=c[1];c=c[2];var m=e[0],n=e[1];e=e[2];var o=d[0],p=d[1];d=d[2];if(Math.abs(k-o)<a.EPSILON&&Math.abs(l-p)<a.EPSILON&&Math.abs(c-d)<a.EPSILON)return h(b);o=k-o;p=l-p;d=c-d;j=1/Math.sqrt(o*o+p*p+d*d);o*=j;p*=j;d*=j;f=n*d-e*p;e=e*o-m*d;m=m*p-n*o;j=Math.sqrt(f*f+e*e+m*m);!j?(f=0,e=0,m=0):(j=1/j,f*=j,e*=j,m*=j);n=p*m-d*e;g=d*f-o*m;i=o*e-p*f;j=Math.sqrt(n*n+g*g+i*i);!j?(n=0,g=0,i=0):(j=1/j,n*=j,g*=j,i*=j);b[0]=f;b[1]=n;b[2]=o;b[3]=0;b[4]=e;b[5]=g;b[6]=p;b[7]=0;b[8]=m;b[9]=i;b[10]=d;b[11]=0;b[12]=-(f*k+e*l+m*c);b[13]=-(n*k+g*l+i*c);b[14]=-(o*k+p*l+d*c);b[15]=1;return b}function O(a,b,c,d){var e=b[0],f=b[1];b=b[2];var g=d[0],h=d[1];d=d[2];var i=e-c[0],j=f-c[1];c=b-c[2];var k=i*i+j*j+c*c;k>0&&(k=1/Math.sqrt(k),i*=k,j*=k,c*=k);var l=h*c-d*j;d=d*i-g*c;g=g*j-h*i;k=l*l+d*d+g*g;k>0&&(k=1/Math.sqrt(k),l*=k,d*=k,g*=k);a[0]=l;a[1]=d;a[2]=g;a[3]=0;a[4]=j*g-c*d;a[5]=c*l-i*g;a[6]=i*d-j*l;a[7]=0;a[8]=i;a[9]=j;a[10]=c;a[11]=0;a[12]=e;a[13]=f;a[14]=b;a[15]=1;return a}function P(a){return"mat4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+", "+a[9]+", "+a[10]+", "+a[11]+", "+a[12]+", "+a[13]+", "+a[14]+", "+a[15]+")"}function Q(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[7],2)+Math.pow(a[8],2)+Math.pow(a[9],2)+Math.pow(a[10],2)+Math.pow(a[11],2)+Math.pow(a[12],2)+Math.pow(a[13],2)+Math.pow(a[14],2)+Math.pow(a[15],2))}function R(a,b,c){a[0]=b[0]+c[0];a[1]=b[1]+c[1];a[2]=b[2]+c[2];a[3]=b[3]+c[3];a[4]=b[4]+c[4];a[5]=b[5]+c[5];a[6]=b[6]+c[6];a[7]=b[7]+c[7];a[8]=b[8]+c[8];a[9]=b[9]+c[9];a[10]=b[10]+c[10];a[11]=b[11]+c[11];a[12]=b[12]+c[12];a[13]=b[13]+c[13];a[14]=b[14]+c[14];a[15]=b[15]+c[15];return a}function S(a,b,c){a[0]=b[0]-c[0];a[1]=b[1]-c[1];a[2]=b[2]-c[2];a[3]=b[3]-c[3];a[4]=b[4]-c[4];a[5]=b[5]-c[5];a[6]=b[6]-c[6];a[7]=b[7]-c[7];a[8]=b[8]-c[8];a[9]=b[9]-c[9];a[10]=b[10]-c[10];a[11]=b[11]-c[11];a[12]=b[12]-c[12];a[13]=b[13]-c[13];a[14]=b[14]-c[14];a[15]=b[15]-c[15];return a}function T(a,b,c){a[0]=b[0]*c;a[1]=b[1]*c;a[2]=b[2]*c;a[3]=b[3]*c;a[4]=b[4]*c;a[5]=b[5]*c;a[6]=b[6]*c;a[7]=b[7]*c;a[8]=b[8]*c;a[9]=b[9]*c;a[10]=b[10]*c;a[11]=b[11]*c;a[12]=b[12]*c;a[13]=b[13]*c;a[14]=b[14]*c;a[15]=b[15]*c;return a}function U(b,c,d,a){b[0]=c[0]+d[0]*a;b[1]=c[1]+d[1]*a;b[2]=c[2]+d[2]*a;b[3]=c[3]+d[3]*a;b[4]=c[4]+d[4]*a;b[5]=c[5]+d[5]*a;b[6]=c[6]+d[6]*a;b[7]=c[7]+d[7]*a;b[8]=c[8]+d[8]*a;b[9]=c[9]+d[9]*a;b[10]=c[10]+d[10]*a;b[11]=c[11]+d[11]*a;b[12]=c[12]+d[12]*a;b[13]=c[13]+d[13]*a;b[14]=c[14]+d[14]*a;b[15]=c[15]+d[15]*a;return b}function V(a,b){return a[0]===b[0]&&a[1]===b[1]&&a[2]===b[2]&&a[3]===b[3]&&a[4]===b[4]&&a[5]===b[5]&&a[6]===b[6]&&a[7]===b[7]&&a[8]===b[8]&&a[9]===b[9]&&a[10]===b[10]&&a[11]===b[11]&&a[12]===b[12]&&a[13]===b[13]&&a[14]===b[14]&&a[15]===b[15]}function W(b,c){var d=b[0],e=b[1],f=b[2],g=b[3],h=b[4],i=b[5],j=b[6],k=b[7],l=b[8],m=b[9],n=b[10],o=b[11],p=b[12],q=b[13],r=b[14];b=b[15];var s=c[0],t=c[1],u=c[2],v=c[3],w=c[4],x=c[5],y=c[6],z=c[7],A=c[8],B=c[9],C=c[10],D=c[11],E=c[12],F=c[13],G=c[14];c=c[15];return Math.abs(d-s)<=a.EPSILON*Math.max(1,Math.abs(d),Math.abs(s))&&Math.abs(e-t)<=a.EPSILON*Math.max(1,Math.abs(e),Math.abs(t))&&Math.abs(f-u)<=a.EPSILON*Math.max(1,Math.abs(f),Math.abs(u))&&Math.abs(g-v)<=a.EPSILON*Math.max(1,Math.abs(g),Math.abs(v))&&Math.abs(h-w)<=a.EPSILON*Math.max(1,Math.abs(h),Math.abs(w))&&Math.abs(i-x)<=a.EPSILON*Math.max(1,Math.abs(i),Math.abs(x))&&Math.abs(j-y)<=a.EPSILON*Math.max(1,Math.abs(j),Math.abs(y))&&Math.abs(k-z)<=a.EPSILON*Math.max(1,Math.abs(k),Math.abs(z))&&Math.abs(l-A)<=a.EPSILON*Math.max(1,Math.abs(l),Math.abs(A))&&Math.abs(m-B)<=a.EPSILON*Math.max(1,Math.abs(m),Math.abs(B))&&Math.abs(n-C)<=a.EPSILON*Math.max(1,Math.abs(n),Math.abs(C))&&Math.abs(o-D)<=a.EPSILON*Math.max(1,Math.abs(o),Math.abs(D))&&Math.abs(p-E)<=a.EPSILON*Math.max(1,Math.abs(p),Math.abs(E))&&Math.abs(q-F)<=a.EPSILON*Math.max(1,Math.abs(q),Math.abs(F))&&Math.abs(r-G)<=a.EPSILON*Math.max(1,Math.abs(r),Math.abs(G))&&Math.abs(b-c)<=a.EPSILON*Math.max(1,Math.abs(b),Math.abs(c))}c=n;A.mul=c;d=S;A.sub=d}var D=!1,E=function(){D||(D=!0,C());return B.exports},F={},G={exports:F};function H(){Object.defineProperty(F,"__esModule",{value:!0});F.create=c;F.clone=d;F.length=e;F.fromValues=f;F.copy=g;F.set=h;F.add=i;F.subtract=j;F.multiply=l;F.divide=m;F.ceil=n;F.floor=o;F.min=p;F.max=q;F.round=r;F.scale=s;F.scaleAndAdd=t;F.distance=u;F.squaredDistance=v;F.squaredLength=w;F.negate=x;F.inverse=y;F.normalize=z;F.dot=A;F.cross=B;F.lerp=C;F.hermite=D;F.bezier=E;F.random=G;F.transformMat4=H;F.transformMat3=I;F.transformQuat=J;F.rotateX=K;F.rotateY=L;F.rotateZ=M;F.angle=N;F.zero=O;F.str=P;F.exactEquals=Q;F.equals=R;F.forEach=F.sqrLen=F.len=F.sqrDist=F.dist=F.div=F.mul=F.sub=void 0;var a=b(k());function b(a){if(a&&a.__esModule)return a;else{var b={};if(a!=null)for(var c in a)if(Object.prototype.hasOwnProperty.call(a,c)){var d=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(a,c):{};d.get||d.set?Object.defineProperty(b,c,d):b[c]=a[c]}b["default"]=a;return b}}function c(){var b=new a.ARRAY_TYPE(3);a.ARRAY_TYPE!=Float32Array&&(b[0]=0,b[1]=0,b[2]=0);return b}function d(b){var c=new a.ARRAY_TYPE(3);c[0]=b[0];c[1]=b[1];c[2]=b[2];return c}function e(a){var b=a[0],c=a[1];a=a[2];return Math.sqrt(b*b+c*c+a*a)}function f(b,c,d){var e=new a.ARRAY_TYPE(3);e[0]=b;e[1]=c;e[2]=d;return e}function g(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];return a}function h(a,b,c,d){a[0]=b;a[1]=c;a[2]=d;return a}function i(a,b,c){a[0]=b[0]+c[0];a[1]=b[1]+c[1];a[2]=b[2]+c[2];return a}function j(a,b,c){a[0]=b[0]-c[0];a[1]=b[1]-c[1];a[2]=b[2]-c[2];return a}function l(a,b,c){a[0]=b[0]*c[0];a[1]=b[1]*c[1];a[2]=b[2]*c[2];return a}function m(a,b,c){a[0]=b[0]/c[0];a[1]=b[1]/c[1];a[2]=b[2]/c[2];return a}function n(a,b){a[0]=Math.ceil(b[0]);a[1]=Math.ceil(b[1]);a[2]=Math.ceil(b[2]);return a}function o(a,b){a[0]=Math.floor(b[0]);a[1]=Math.floor(b[1]);a[2]=Math.floor(b[2]);return a}function p(a,b,c){a[0]=Math.min(b[0],c[0]);a[1]=Math.min(b[1],c[1]);a[2]=Math.min(b[2],c[2]);return a}function q(a,b,c){a[0]=Math.max(b[0],c[0]);a[1]=Math.max(b[1],c[1]);a[2]=Math.max(b[2],c[2]);return a}function r(a,b){a[0]=Math.round(b[0]);a[1]=Math.round(b[1]);a[2]=Math.round(b[2]);return a}function s(a,b,c){a[0]=b[0]*c;a[1]=b[1]*c;a[2]=b[2]*c;return a}function t(b,c,d,a){b[0]=c[0]+d[0]*a;b[1]=c[1]+d[1]*a;b[2]=c[2]+d[2]*a;return b}function u(a,b){var c=b[0]-a[0],d=b[1]-a[1];b=b[2]-a[2];return Math.sqrt(c*c+d*d+b*b)}function v(a,b){var c=b[0]-a[0],d=b[1]-a[1];b=b[2]-a[2];return c*c+d*d+b*b}function w(a){var b=a[0],c=a[1];a=a[2];return b*b+c*c+a*a}function x(a,b){a[0]=-b[0];a[1]=-b[1];a[2]=-b[2];return a}function y(a,b){a[0]=1/b[0];a[1]=1/b[1];a[2]=1/b[2];return a}function z(a,b){var c=b[0],d=b[1],e=b[2];c=c*c+d*d+e*e;c>0&&(c=1/Math.sqrt(c));a[0]=b[0]*c;a[1]=b[1]*c;a[2]=b[2]*c;return a}function A(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]}function B(a,b,c){var d=b[0],e=b[1];b=b[2];var f=c[0],g=c[1];c=c[2];a[0]=e*c-b*g;a[1]=b*f-d*c;a[2]=d*g-e*f;return a}function C(a,b,c,d){var e=b[0],f=b[1];b=b[2];a[0]=e+d*(c[0]-e);a[1]=f+d*(c[1]-f);a[2]=b+d*(c[2]-b);return a}function D(a,b,c,d,e,f){var g=f*f,h=g*(2*f-3)+1,i=g*(f-2)+f,j=g*(f-1);g=g*(3-2*f);a[0]=b[0]*h+c[0]*i+d[0]*j+e[0]*g;a[1]=b[1]*h+c[1]*i+d[1]*j+e[1]*g;a[2]=b[2]*h+c[2]*i+d[2]*j+e[2]*g;return a}function E(a,b,c,d,e,f){var g=1-f,h=g*g,i=f*f,j=h*g;h=3*f*h;g=3*i*g;i=i*f;a[0]=b[0]*j+c[0]*h+d[0]*g+e[0]*i;a[1]=b[1]*j+c[1]*h+d[1]*g+e[1]*i;a[2]=b[2]*j+c[2]*h+d[2]*g+e[2]*i;return a}function G(c,b){b=b||1;var d=a.RANDOM()*2*Math.PI,e=a.RANDOM()*2-1,f=Math.sqrt(1-e*e)*b;c[0]=Math.cos(d)*f;c[1]=Math.sin(d)*f;c[2]=e*b;return c}function H(a,b,c){var d=b[0],e=b[1];b=b[2];var f=c[3]*d+c[7]*e+c[11]*b+c[15];f=f||1;a[0]=(c[0]*d+c[4]*e+c[8]*b+c[12])/f;a[1]=(c[1]*d+c[5]*e+c[9]*b+c[13])/f;a[2]=(c[2]*d+c[6]*e+c[10]*b+c[14])/f;return a}function I(a,b,c){var d=b[0],e=b[1];b=b[2];a[0]=d*c[0]+e*c[3]+b*c[6];a[1]=d*c[1]+e*c[4]+b*c[7];a[2]=d*c[2]+e*c[5]+b*c[8];return a}function J(a,b,c){var d=c[0],e=c[1],f=c[2];c=c[3];var g=b[0],h=b[1];b=b[2];var i=e*b-f*h,j=f*g-d*b,k=d*h-e*g,l=e*k-f*j;f=f*i-d*k;d=d*j-e*i;e=c*2;i*=e;j*=e;k*=e;l*=2;f*=2;d*=2;a[0]=g+i+l;a[1]=h+j+f;a[2]=b+k+d;return a}function K(a,b,c,d){var e=[],f=[];e[0]=b[0]-c[0];e[1]=b[1]-c[1];e[2]=b[2]-c[2];f[0]=e[0];f[1]=e[1]*Math.cos(d)-e[2]*Math.sin(d);f[2]=e[1]*Math.sin(d)+e[2]*Math.cos(d);a[0]=f[0]+c[0];a[1]=f[1]+c[1];a[2]=f[2]+c[2];return a}function L(a,b,c,d){var e=[],f=[];e[0]=b[0]-c[0];e[1]=b[1]-c[1];e[2]=b[2]-c[2];f[0]=e[2]*Math.sin(d)+e[0]*Math.cos(d);f[1]=e[1];f[2]=e[2]*Math.cos(d)-e[0]*Math.sin(d);a[0]=f[0]+c[0];a[1]=f[1]+c[1];a[2]=f[2]+c[2];return a}function M(a,b,c,d){var e=[],f=[];e[0]=b[0]-c[0];e[1]=b[1]-c[1];e[2]=b[2]-c[2];f[0]=e[0]*Math.cos(d)-e[1]*Math.sin(d);f[1]=e[0]*Math.sin(d)+e[1]*Math.cos(d);f[2]=e[2];a[0]=f[0]+c[0];a[1]=f[1]+c[1];a[2]=f[2]+c[2];return a}function N(a,b){a=f(a[0],a[1],a[2]);b=f(b[0],b[1],b[2]);z(a,a);z(b,b);a=A(a,b);if(a>1)return 0;else if(a<-1)return Math.PI;else return Math.acos(a)}function O(a){a[0]=0;a[1]=0;a[2]=0;return a}function P(a){return"vec3("+a[0]+", "+a[1]+", "+a[2]+")"}function Q(a,b){return a[0]===b[0]&&a[1]===b[1]&&a[2]===b[2]}function R(b,c){var d=b[0],e=b[1];b=b[2];var f=c[0],g=c[1];c=c[2];return Math.abs(d-f)<=a.EPSILON*Math.max(1,Math.abs(d),Math.abs(f))&&Math.abs(e-g)<=a.EPSILON*Math.max(1,Math.abs(e),Math.abs(g))&&Math.abs(b-c)<=a.EPSILON*Math.max(1,Math.abs(b),Math.abs(c))}d=j;F.sub=d;g=l;F.mul=g;h=m;F.div=h;i=u;F.dist=i;n=v;F.sqrDist=n;o=e;F.len=o;p=w;F.sqrLen=p;q=function(){var a=c();return function(b,c,d,e,f,g){c||(c=3);d||(d=0);e?e=Math.min(e*c+d,b.length):e=b.length;for(d=d;d<e;d+=c)a[0]=b[d],a[1]=b[d+1],a[2]=b[d+2],f(a,a,g),b[d]=a[0],b[d+1]=a[1],b[d+2]=a[2];return b}}();F.forEach=q}var I=!1,J=function(){I||(I=!0,H());return G.exports},K={},L={exports:K};function M(){Object.defineProperty(K,"__esModule",{value:!0});K.create=c;K.clone=d;K.fromValues=e;K.copy=f;K.set=g;K.add=h;K.subtract=i;K.multiply=j;K.divide=l;K.ceil=m;K.floor=n;K.min=o;K.max=p;K.round=q;K.scale=r;K.scaleAndAdd=s;K.distance=t;K.squaredDistance=u;K.length=v;K.squaredLength=w;K.negate=x;K.inverse=y;K.normalize=z;K.dot=A;K.cross=B;K.lerp=C;K.random=D;K.transformMat4=E;K.transformQuat=F;K.zero=G;K.str=H;K.exactEquals=I;K.equals=J;K.forEach=K.sqrLen=K.len=K.sqrDist=K.dist=K.div=K.mul=K.sub=void 0;var a=b(k());function b(a){if(a&&a.__esModule)return a;else{var b={};if(a!=null)for(var c in a)if(Object.prototype.hasOwnProperty.call(a,c)){var d=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(a,c):{};d.get||d.set?Object.defineProperty(b,c,d):b[c]=a[c]}b["default"]=a;return b}}function c(){var b=new a.ARRAY_TYPE(4);a.ARRAY_TYPE!=Float32Array&&(b[0]=0,b[1]=0,b[2]=0,b[3]=0);return b}function d(b){var c=new a.ARRAY_TYPE(4);c[0]=b[0];c[1]=b[1];c[2]=b[2];c[3]=b[3];return c}function e(b,c,d,e){var f=new a.ARRAY_TYPE(4);f[0]=b;f[1]=c;f[2]=d;f[3]=e;return f}function f(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];return a}function g(a,b,c,d,e){a[0]=b;a[1]=c;a[2]=d;a[3]=e;return a}function h(a,b,c){a[0]=b[0]+c[0];a[1]=b[1]+c[1];a[2]=b[2]+c[2];a[3]=b[3]+c[3];return a}function i(a,b,c){a[0]=b[0]-c[0];a[1]=b[1]-c[1];a[2]=b[2]-c[2];a[3]=b[3]-c[3];return a}function j(a,b,c){a[0]=b[0]*c[0];a[1]=b[1]*c[1];a[2]=b[2]*c[2];a[3]=b[3]*c[3];return a}function l(a,b,c){a[0]=b[0]/c[0];a[1]=b[1]/c[1];a[2]=b[2]/c[2];a[3]=b[3]/c[3];return a}function m(a,b){a[0]=Math.ceil(b[0]);a[1]=Math.ceil(b[1]);a[2]=Math.ceil(b[2]);a[3]=Math.ceil(b[3]);return a}function n(a,b){a[0]=Math.floor(b[0]);a[1]=Math.floor(b[1]);a[2]=Math.floor(b[2]);a[3]=Math.floor(b[3]);return a}function o(a,b,c){a[0]=Math.min(b[0],c[0]);a[1]=Math.min(b[1],c[1]);a[2]=Math.min(b[2],c[2]);a[3]=Math.min(b[3],c[3]);return a}function p(a,b,c){a[0]=Math.max(b[0],c[0]);a[1]=Math.max(b[1],c[1]);a[2]=Math.max(b[2],c[2]);a[3]=Math.max(b[3],c[3]);return a}function q(a,b){a[0]=Math.round(b[0]);a[1]=Math.round(b[1]);a[2]=Math.round(b[2]);a[3]=Math.round(b[3]);return a}function r(a,b,c){a[0]=b[0]*c;a[1]=b[1]*c;a[2]=b[2]*c;a[3]=b[3]*c;return a}function s(b,c,d,a){b[0]=c[0]+d[0]*a;b[1]=c[1]+d[1]*a;b[2]=c[2]+d[2]*a;b[3]=c[3]+d[3]*a;return b}function t(a,b){var c=b[0]-a[0],d=b[1]-a[1],e=b[2]-a[2];b=b[3]-a[3];return Math.sqrt(c*c+d*d+e*e+b*b)}function u(a,b){var c=b[0]-a[0],d=b[1]-a[1],e=b[2]-a[2];b=b[3]-a[3];return c*c+d*d+e*e+b*b}function v(a){var b=a[0],c=a[1],d=a[2];a=a[3];return Math.sqrt(b*b+c*c+d*d+a*a)}function w(a){var b=a[0],c=a[1],d=a[2];a=a[3];return b*b+c*c+d*d+a*a}function x(a,b){a[0]=-b[0];a[1]=-b[1];a[2]=-b[2];a[3]=-b[3];return a}function y(a,b){a[0]=1/b[0];a[1]=1/b[1];a[2]=1/b[2];a[3]=1/b[3];return a}function z(a,b){var c=b[0],d=b[1],e=b[2];b=b[3];var f=c*c+d*d+e*e+b*b;f>0&&(f=1/Math.sqrt(f));a[0]=c*f;a[1]=d*f;a[2]=e*f;a[3]=b*f;return a}function A(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3]}function B(a,b,c,d){var e=c[0]*d[1]-c[1]*d[0],f=c[0]*d[2]-c[2]*d[0],g=c[0]*d[3]-c[3]*d[0],h=c[1]*d[2]-c[2]*d[1],i=c[1]*d[3]-c[3]*d[1];c=c[2]*d[3]-c[3]*d[2];d=b[0];var j=b[1],k=b[2];b=b[3];a[0]=j*c-k*i+b*h;a[1]=-(d*c)+k*g-b*f;a[2]=d*i-j*g+b*e;a[3]=-(d*h)+j*f-k*e;return a}function C(a,b,c,d){var e=b[0],f=b[1],g=b[2];b=b[3];a[0]=e+d*(c[0]-e);a[1]=f+d*(c[1]-f);a[2]=g+d*(c[2]-g);a[3]=b+d*(c[3]-b);return a}function D(c,b){b=b||1;var d,e,f,g,h,i;do d=a.RANDOM()*2-1,e=a.RANDOM()*2-1,h=d*d+e*e;while(h>=1);do f=a.RANDOM()*2-1,g=a.RANDOM()*2-1,i=f*f+g*g;while(i>=1);h=Math.sqrt((1-h)/i);c[0]=b*d;c[1]=b*e;c[2]=b*f*h;c[3]=b*g*h;return c}function E(a,b,c){var d=b[0],e=b[1],f=b[2];b=b[3];a[0]=c[0]*d+c[4]*e+c[8]*f+c[12]*b;a[1]=c[1]*d+c[5]*e+c[9]*f+c[13]*b;a[2]=c[2]*d+c[6]*e+c[10]*f+c[14]*b;a[3]=c[3]*d+c[7]*e+c[11]*f+c[15]*b;return a}function F(a,b,c){var d=b[0],e=b[1],f=b[2],g=c[0],h=c[1],i=c[2];c=c[3];var j=c*d+h*f-i*e,k=c*e+i*d-g*f,l=c*f+g*e-h*d;d=-g*d-h*e-i*f;a[0]=j*c+d*-g+k*-i-l*-h;a[1]=k*c+d*-h+l*-g-j*-i;a[2]=l*c+d*-i+j*-h-k*-g;a[3]=b[3];return a}function G(a){a[0]=0;a[1]=0;a[2]=0;a[3]=0;return a}function H(a){return"vec4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"}function I(a,b){return a[0]===b[0]&&a[1]===b[1]&&a[2]===b[2]&&a[3]===b[3]}function J(b,c){var d=b[0],e=b[1],f=b[2];b=b[3];var g=c[0],h=c[1],i=c[2];c=c[3];return Math.abs(d-g)<=a.EPSILON*Math.max(1,Math.abs(d),Math.abs(g))&&Math.abs(e-h)<=a.EPSILON*Math.max(1,Math.abs(e),Math.abs(h))&&Math.abs(f-i)<=a.EPSILON*Math.max(1,Math.abs(f),Math.abs(i))&&Math.abs(b-c)<=a.EPSILON*Math.max(1,Math.abs(b),Math.abs(c))}d=i;K.sub=d;e=j;K.mul=e;f=l;K.div=f;g=t;K.dist=g;h=u;K.sqrDist=h;m=v;K.len=m;n=w;K.sqrLen=n;o=function(){var a=c();return function(b,c,d,e,f,g){c||(c=4);d||(d=0);e?e=Math.min(e*c+d,b.length):e=b.length;for(d=d;d<e;d+=c)a[0]=b[d],a[1]=b[d+1],a[2]=b[d+2],a[3]=b[d+3],f(a,a,g),b[d]=a[0],b[d+1]=a[1],b[d+2]=a[2],b[d+3]=a[3];return b}}();K.forEach=o}var N=!1,O=function(){N||(N=!0,M());return L.exports},P={},Q={exports:P};function R(){Object.defineProperty(P,"__esModule",{value:!0});P.create=e;P.identity=f;P.setAxisAngle=g;P.getAxisAngle=h;P.multiply=i;P.rotateX=j;P.rotateY=l;P.rotateZ=m;P.calculateW=n;P.slerp=o;P.random=p;P.invert=q;P.conjugate=r;P.fromMat3=s;P.fromEuler=t;P.str=u;P.setAxes=P.sqlerp=P.rotationTo=P.equals=P.exactEquals=P.normalize=P.sqrLen=P.squaredLength=P.len=P.length=P.lerp=P.dot=P.scale=P.mul=P.add=P.set=P.copy=P.fromValues=P.clone=void 0;var a=d(k()),b=d(z()),c=d(J());f=d(O());function d(a){if(a&&a.__esModule)return a;else{var b={};if(a!=null)for(var c in a)if(Object.prototype.hasOwnProperty.call(a,c)){var d=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(a,c):{};d.get||d.set?Object.defineProperty(b,c,d):b[c]=a[c]}b["default"]=a;return b}}function e(){var b=new a.ARRAY_TYPE(4);a.ARRAY_TYPE!=Float32Array&&(b[0]=0,b[1]=0,b[2]=0);b[3]=1;return b}function f(a){a[0]=0;a[1]=0;a[2]=0;a[3]=1;return a}function g(a,b,c){c=c*.5;var d=Math.sin(c);a[0]=d*b[0];a[1]=d*b[1];a[2]=d*b[2];a[3]=Math.cos(c);return a}function h(b,c){var d=Math.acos(c[3])*2,e=Math.sin(d/2);e>a.EPSILON?(b[0]=c[0]/e,b[1]=c[1]/e,b[2]=c[2]/e):(b[0]=1,b[1]=0,b[2]=0);return d}function i(a,b,c){var d=b[0],e=b[1],f=b[2];b=b[3];var g=c[0],h=c[1],i=c[2];c=c[3];a[0]=d*c+b*g+e*i-f*h;a[1]=e*c+b*h+f*g-d*i;a[2]=f*c+b*i+d*h-e*g;a[3]=b*c-d*g-e*h-f*i;return a}function j(a,b,c){c*=.5;var d=b[0],e=b[1],f=b[2];b=b[3];var g=Math.sin(c);c=Math.cos(c);a[0]=d*c+b*g;a[1]=e*c+f*g;a[2]=f*c-e*g;a[3]=b*c-d*g;return a}function l(a,b,c){c*=.5;var d=b[0],e=b[1],f=b[2];b=b[3];var g=Math.sin(c);c=Math.cos(c);a[0]=d*c-f*g;a[1]=e*c+b*g;a[2]=f*c+d*g;a[3]=b*c-e*g;return a}function m(a,b,c){c*=.5;var d=b[0],e=b[1],f=b[2];b=b[3];var g=Math.sin(c);c=Math.cos(c);a[0]=d*c+e*g;a[1]=e*c-d*g;a[2]=f*c+b*g;a[3]=b*c-f*g;return a}function n(a,b){var c=b[0],d=b[1];b=b[2];a[0]=c;a[1]=d;a[2]=b;a[3]=Math.sqrt(Math.abs(1-c*c-d*d-b*b));return a}function o(b,c,d,e){var f=c[0],g=c[1],h=c[2];c=c[3];var i=d[0],j=d[1],k=d[2];d=d[3];var l,m,n;l=f*i+g*j+h*k+c*d;l<0&&(l=-l,i=-i,j=-j,k=-k,d=-d);1-l>a.EPSILON?(l=Math.acos(l),m=Math.sin(l),n=Math.sin((1-e)*l)/m,l=Math.sin(e*l)/m):(n=1-e,l=e);b[0]=n*f+l*i;b[1]=n*g+l*j;b[2]=n*h+l*k;b[3]=n*c+l*d;return b}function p(b){var c=a.RANDOM(),d=a.RANDOM(),e=a.RANDOM(),f=Math.sqrt(1-c);c=Math.sqrt(c);b[0]=f*Math.sin(2*Math.PI*d);b[1]=f*Math.cos(2*Math.PI*d);b[2]=c*Math.sin(2*Math.PI*e);b[3]=c*Math.cos(2*Math.PI*e);return b}function q(a,b){var c=b[0],d=b[1],e=b[2];b=b[3];var f=c*c+d*d+e*e+b*b;f=f?1/f:0;a[0]=-c*f;a[1]=-d*f;a[2]=-e*f;a[3]=b*f;return a}function r(a,b){a[0]=-b[0];a[1]=-b[1];a[2]=-b[2];a[3]=b[3];return a}function s(a,b){var c=b[0]+b[4]+b[8];if(c>0)c=Math.sqrt(c+1),a[3]=.5*c,c=.5/c,a[0]=(b[5]-b[7])*c,a[1]=(b[6]-b[2])*c,a[2]=(b[1]-b[3])*c;else{var d=0;b[4]>b[0]&&(d=1);b[8]>b[d*3+d]&&(d=2);var e=(d+1)%3,f=(d+2)%3;c=Math.sqrt(b[d*3+d]-b[e*3+e]-b[f*3+f]+1);a[d]=.5*c;c=.5/c;a[3]=(b[e*3+f]-b[f*3+e])*c;a[e]=(b[e*3+d]+b[d*3+e])*c;a[f]=(b[f*3+d]+b[d*3+f])*c}return a}function t(a,b,c,d){var e=.5*Math.PI/180;b*=e;c*=e;d*=e;e=Math.sin(b);b=Math.cos(b);var f=Math.sin(c);c=Math.cos(c);var g=Math.sin(d);d=Math.cos(d);a[0]=e*c*d-b*f*g;a[1]=b*f*d+e*c*g;a[2]=b*c*g-e*f*d;a[3]=b*c*d+e*f*g;return a}function u(a){return"quat("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"}h=f.clone;P.clone=h;j=f.fromValues;P.fromValues=j;l=f.copy;P.copy=l;m=f.set;P.set=m;n=f.add;P.add=n;p=i;P.mul=p;q=f.scale;P.scale=q;r=f.dot;P.dot=r;t=f.lerp;P.lerp=t;u=f.length;P.length=u;d=u;P.len=d;h=f.squaredLength;P.squaredLength=h;j=h;P.sqrLen=j;var v=f.normalize;P.normalize=v;l=f.exactEquals;P.exactEquals=l;m=f.equals;P.equals=m;n=function(){var a=c.create(),b=c.fromValues(1,0,0),d=c.fromValues(0,1,0);return function(e,f,h){var i=c.dot(f,h);if(i<-.999999){c.cross(a,b,f);c.len(a)<1e-6&&c.cross(a,d,f);c.normalize(a,a);g(e,a,Math.PI);return e}else if(i>.999999){e[0]=0;e[1]=0;e[2]=0;e[3]=1;return e}else{c.cross(a,f,h);e[0]=a[0];e[1]=a[1];e[2]=a[2];e[3]=1+i;return v(e,e)}}}();P.rotationTo=n;i=function(){var a=e(),b=e();return function(c,d,e,f,g,h){o(a,d,g,h);o(b,e,f,h);o(c,a,b,2*h*(1-h));return c}}();P.sqlerp=i;p=function(){var a=b.create();return function(b,c,d,e){a[0]=d[0];a[3]=d[1];a[6]=d[2];a[1]=e[0];a[4]=e[1];a[7]=e[2];a[2]=-c[0];a[5]=-c[1];a[8]=-c[2];return v(b,s(b,a))}}();P.setAxes=p}var S=!1,T=function(){S||(S=!0,R());return Q.exports},U={},V={exports:U};function W(){Object.defineProperty(U,"__esModule",{value:!0});U.create=e;U.clone=f;U.fromValues=g;U.fromRotationTranslationValues=h;U.fromRotationTranslation=i;U.fromTranslation=j;U.fromRotation=l;U.fromMat4=m;U.copy=n;U.identity=o;U.set=p;U.getDual=q;U.setDual=r;U.getTranslation=s;U.translate=t;U.rotateX=u;U.rotateY=v;U.rotateZ=w;U.rotateByQuatAppend=x;U.rotateByQuatPrepend=y;U.rotateAroundAxis=z;U.add=A;U.multiply=B;U.scale=C;U.lerp=F;U.invert=G;U.conjugate=H;U.normalize=J;U.str=K;U.exactEquals=L;U.equals=M;U.sqrLen=U.squaredLength=U.len=U.length=U.dot=U.mul=U.setReal=U.getReal=void 0;var a=d(k()),b=d(T()),c=d(E());function d(a){if(a&&a.__esModule)return a;else{var b={};if(a!=null)for(var c in a)if(Object.prototype.hasOwnProperty.call(a,c)){var d=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(a,c):{};d.get||d.set?Object.defineProperty(b,c,d):b[c]=a[c]}b["default"]=a;return b}}function e(){var b=new a.ARRAY_TYPE(8);a.ARRAY_TYPE!=Float32Array&&(b[0]=0,b[1]=0,b[2]=0,b[4]=0,b[5]=0,b[6]=0,b[7]=0);b[3]=1;return b}function f(b){var c=new a.ARRAY_TYPE(8);c[0]=b[0];c[1]=b[1];c[2]=b[2];c[3]=b[3];c[4]=b[4];c[5]=b[5];c[6]=b[6];c[7]=b[7];return c}function g(b,c,d,e,f,g,h,i){var j=new a.ARRAY_TYPE(8);j[0]=b;j[1]=c;j[2]=d;j[3]=e;j[4]=f;j[5]=g;j[6]=h;j[7]=i;return j}function h(b,c,d,e,f,g,h){var i=new a.ARRAY_TYPE(8);i[0]=b;i[1]=c;i[2]=d;i[3]=e;f=f*.5;g=g*.5;h=h*.5;i[4]=f*e+g*d-h*c;i[5]=g*e+h*b-f*d;i[6]=h*e+f*c-g*b;i[7]=-f*b-g*c-h*d;return i}function i(a,b,c){var d=c[0]*.5,e=c[1]*.5;c=c[2]*.5;var f=b[0],g=b[1],h=b[2];b=b[3];a[0]=f;a[1]=g;a[2]=h;a[3]=b;a[4]=d*b+e*h-c*g;a[5]=e*b+c*f-d*h;a[6]=c*b+d*g-e*f;a[7]=-d*f-e*g-c*h;return a}function j(a,b){a[0]=0;a[1]=0;a[2]=0;a[3]=1;a[4]=b[0]*.5;a[5]=b[1]*.5;a[6]=b[2]*.5;a[7]=0;return a}function l(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];a[4]=0;a[5]=0;a[6]=0;a[7]=0;return a}function m(d,e){var f=b.create();c.getRotation(f,e);var g=new a.ARRAY_TYPE(3);c.getTranslation(g,e);i(d,f,g);return d}function n(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];a[4]=b[4];a[5]=b[5];a[6]=b[6];a[7]=b[7];return a}function o(a){a[0]=0;a[1]=0;a[2]=0;a[3]=1;a[4]=0;a[5]=0;a[6]=0;a[7]=0;return a}function p(a,b,c,d,e,f,g,h,i){a[0]=b;a[1]=c;a[2]=d;a[3]=e;a[4]=f;a[5]=g;a[6]=h;a[7]=i;return a}e=b.copy;U.getReal=e;function q(a,b){a[0]=b[4];a[1]=b[5];a[2]=b[6];a[3]=b[7];return a}f=b.copy;U.setReal=f;function r(a,b){a[4]=b[0];a[5]=b[1];a[6]=b[2];a[7]=b[3];return a}function s(a,b){var c=b[4],d=b[5],e=b[6],f=b[7],g=-b[0],h=-b[1],i=-b[2];b=b[3];a[0]=(c*b+f*g+d*i-e*h)*2;a[1]=(d*b+f*h+e*g-c*i)*2;a[2]=(e*b+f*i+c*h-d*g)*2;return a}function t(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3],h=c[0]*.5,i=c[1]*.5;c=c[2]*.5;var j=b[4],k=b[5],l=b[6];b=b[7];a[0]=d;a[1]=e;a[2]=f;a[3]=g;a[4]=g*h+e*c-f*i+j;a[5]=g*i+f*h-d*c+k;a[6]=g*c+d*i-e*h+l;a[7]=-d*h-e*i-f*c+b;return a}function u(a,c,d){var e=-c[0],f=-c[1],g=-c[2],h=c[3],i=c[4],j=c[5],k=c[6],l=c[7],m=i*h+l*e+j*g-k*f,n=j*h+l*f+k*e-i*g,o=k*h+l*g+i*f-j*e;l=l*h-i*e-j*f-k*g;b.rotateX(a,c,d);e=a[0];f=a[1];g=a[2];h=a[3];a[4]=m*h+l*e+n*g-o*f;a[5]=n*h+l*f+o*e-m*g;a[6]=o*h+l*g+m*f-n*e;a[7]=l*h-m*e-n*f-o*g;return a}function v(a,c,d){var e=-c[0],f=-c[1],g=-c[2],h=c[3],i=c[4],j=c[5],k=c[6],l=c[7],m=i*h+l*e+j*g-k*f,n=j*h+l*f+k*e-i*g,o=k*h+l*g+i*f-j*e;l=l*h-i*e-j*f-k*g;b.rotateY(a,c,d);e=a[0];f=a[1];g=a[2];h=a[3];a[4]=m*h+l*e+n*g-o*f;a[5]=n*h+l*f+o*e-m*g;a[6]=o*h+l*g+m*f-n*e;a[7]=l*h-m*e-n*f-o*g;return a}function w(a,c,d){var e=-c[0],f=-c[1],g=-c[2],h=c[3],i=c[4],j=c[5],k=c[6],l=c[7],m=i*h+l*e+j*g-k*f,n=j*h+l*f+k*e-i*g,o=k*h+l*g+i*f-j*e;l=l*h-i*e-j*f-k*g;b.rotateZ(a,c,d);e=a[0];f=a[1];g=a[2];h=a[3];a[4]=m*h+l*e+n*g-o*f;a[5]=n*h+l*f+o*e-m*g;a[6]=o*h+l*g+m*f-n*e;a[7]=l*h-m*e-n*f-o*g;return a}function x(a,b,c){var d=c[0],e=c[1],f=c[2];c=c[3];var g=b[0],h=b[1],i=b[2],j=b[3];a[0]=g*c+j*d+h*f-i*e;a[1]=h*c+j*e+i*d-g*f;a[2]=i*c+j*f+g*e-h*d;a[3]=j*c-g*d-h*e-i*f;g=b[4];h=b[5];i=b[6];j=b[7];a[4]=g*c+j*d+h*f-i*e;a[5]=h*c+j*e+i*d-g*f;a[6]=i*c+j*f+g*e-h*d;a[7]=j*c-g*d-h*e-i*f;return a}function y(a,b,c){var d=b[0],e=b[1],f=b[2];b=b[3];var g=c[0],h=c[1],i=c[2],j=c[3];a[0]=d*j+b*g+e*i-f*h;a[1]=e*j+b*h+f*g-d*i;a[2]=f*j+b*i+d*h-e*g;a[3]=b*j-d*g-e*h-f*i;g=c[4];h=c[5];i=c[6];j=c[7];a[4]=d*j+b*g+e*i-f*h;a[5]=e*j+b*h+f*g-d*i;a[6]=f*j+b*i+d*h-e*g;a[7]=b*j-d*g-e*h-f*i;return a}function z(b,c,d,e){if(Math.abs(e)<a.EPSILON)return n(b,c);var f=Math.sqrt(d[0]*d[0]+d[1]*d[1]+d[2]*d[2]);e=e*.5;var g=Math.sin(e),h=g*d[0]/f,i=g*d[1]/f;g=g*d[2]/f;d=Math.cos(e);f=c[0];e=c[1];var j=c[2],k=c[3];b[0]=f*d+k*h+e*g-j*i;b[1]=e*d+k*i+j*h-f*g;b[2]=j*d+k*g+f*i-e*h;b[3]=k*d-f*h-e*i-j*g;k=c[4];f=c[5];e=c[6];j=c[7];b[4]=k*d+j*h+f*g-e*i;b[5]=f*d+j*i+e*h-k*g;b[6]=e*d+j*g+k*i-f*h;b[7]=j*d-k*h-f*i-e*g;return b}function A(a,b,c){a[0]=b[0]+c[0];a[1]=b[1]+c[1];a[2]=b[2]+c[2];a[3]=b[3]+c[3];a[4]=b[4]+c[4];a[5]=b[5]+c[5];a[6]=b[6]+c[6];a[7]=b[7]+c[7];return a}function B(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3],h=c[4],i=c[5],j=c[6],k=c[7],l=b[4],m=b[5],n=b[6];b=b[7];var o=c[0],p=c[1],q=c[2];c=c[3];a[0]=d*c+g*o+e*q-f*p;a[1]=e*c+g*p+f*o-d*q;a[2]=f*c+g*q+d*p-e*o;a[3]=g*c-d*o-e*p-f*q;a[4]=d*k+g*h+e*j-f*i+l*c+b*o+m*q-n*p;a[5]=e*k+g*i+f*h-d*j+m*c+b*p+n*o-l*q;a[6]=f*k+g*j+d*i-e*h+n*c+b*q+l*p-m*o;a[7]=g*k-d*h-e*i-f*j+b*c-l*o-m*p-n*q;return a}g=B;U.mul=g;function C(a,b,c){a[0]=b[0]*c;a[1]=b[1]*c;a[2]=b[2]*c;a[3]=b[3]*c;a[4]=b[4]*c;a[5]=b[5]*c;a[6]=b[6]*c;a[7]=b[7]*c;return a}var D=b.dot;U.dot=D;function F(a,b,c,d){var e=1-d;D(b,c)<0&&(d=-d);a[0]=b[0]*e+c[0]*d;a[1]=b[1]*e+c[1]*d;a[2]=b[2]*e+c[2]*d;a[3]=b[3]*e+c[3]*d;a[4]=b[4]*e+c[4]*d;a[5]=b[5]*e+c[5]*d;a[6]=b[6]*e+c[6]*d;a[7]=b[7]*e+c[7]*d;return a}function G(a,b){var c=I(b);a[0]=-b[0]/c;a[1]=-b[1]/c;a[2]=-b[2]/c;a[3]=b[3]/c;a[4]=-b[4]/c;a[5]=-b[5]/c;a[6]=-b[6]/c;a[7]=b[7]/c;return a}function H(a,b){a[0]=-b[0];a[1]=-b[1];a[2]=-b[2];a[3]=b[3];a[4]=-b[4];a[5]=-b[5];a[6]=-b[6];a[7]=b[7];return a}h=b.length;U.length=h;j=h;U.len=j;var I=b.squaredLength;U.squaredLength=I;l=I;U.sqrLen=l;function J(a,b){var c=I(b);if(c>0){c=Math.sqrt(c);var d=b[0]/c,e=b[1]/c,f=b[2]/c,g=b[3]/c,h=b[4],i=b[5],j=b[6];b=b[7];var k=d*h+e*i+f*j+g*b;a[0]=d;a[1]=e;a[2]=f;a[3]=g;a[4]=(h-d*k)/c;a[5]=(i-e*k)/c;a[6]=(j-f*k)/c;a[7]=(b-g*k)/c}return a}function K(a){return"quat2("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+")"}function L(a,b){return a[0]===b[0]&&a[1]===b[1]&&a[2]===b[2]&&a[3]===b[3]&&a[4]===b[4]&&a[5]===b[5]&&a[6]===b[6]&&a[7]===b[7]}function M(b,c){var d=b[0],e=b[1],f=b[2],g=b[3],h=b[4],i=b[5],j=b[6];b=b[7];var k=c[0],l=c[1],m=c[2],n=c[3],o=c[4],p=c[5],q=c[6];c=c[7];return Math.abs(d-k)<=a.EPSILON*Math.max(1,Math.abs(d),Math.abs(k))&&Math.abs(e-l)<=a.EPSILON*Math.max(1,Math.abs(e),Math.abs(l))&&Math.abs(f-m)<=a.EPSILON*Math.max(1,Math.abs(f),Math.abs(m))&&Math.abs(g-n)<=a.EPSILON*Math.max(1,Math.abs(g),Math.abs(n))&&Math.abs(h-o)<=a.EPSILON*Math.max(1,Math.abs(h),Math.abs(o))&&Math.abs(i-p)<=a.EPSILON*Math.max(1,Math.abs(i),Math.abs(p))&&Math.abs(j-q)<=a.EPSILON*Math.max(1,Math.abs(j),Math.abs(q))&&Math.abs(b-c)<=a.EPSILON*Math.max(1,Math.abs(b),Math.abs(c))}}var X=!1,aa=function(){X||(X=!0,W());return V.exports},Y={},ba={exports:Y};function ca(){Object.defineProperty(Y,"__esModule",{value:!0});Y.create=c;Y.clone=d;Y.fromValues=e;Y.copy=f;Y.set=g;Y.add=h;Y.subtract=i;Y.multiply=j;Y.divide=l;Y.ceil=m;Y.floor=n;Y.min=o;Y.max=p;Y.round=q;Y.scale=r;Y.scaleAndAdd=s;Y.distance=t;Y.squaredDistance=u;Y.length=v;Y.squaredLength=w;Y.negate=x;Y.inverse=y;Y.normalize=z;Y.dot=A;Y.cross=B;Y.lerp=C;Y.random=D;Y.transformMat2=E;Y.transformMat2d=F;Y.transformMat3=G;Y.transformMat4=H;Y.rotate=I;Y.angle=J;Y.zero=K;Y.str=L;Y.exactEquals=M;Y.equals=N;Y.forEach=Y.sqrLen=Y.sqrDist=Y.dist=Y.div=Y.mul=Y.sub=Y.len=void 0;var a=b(k());function b(a){if(a&&a.__esModule)return a;else{var b={};if(a!=null)for(var c in a)if(Object.prototype.hasOwnProperty.call(a,c)){var d=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(a,c):{};d.get||d.set?Object.defineProperty(b,c,d):b[c]=a[c]}b["default"]=a;return b}}function c(){var b=new a.ARRAY_TYPE(2);a.ARRAY_TYPE!=Float32Array&&(b[0]=0,b[1]=0);return b}function d(b){var c=new a.ARRAY_TYPE(2);c[0]=b[0];c[1]=b[1];return c}function e(b,c){var d=new a.ARRAY_TYPE(2);d[0]=b;d[1]=c;return d}function f(a,b){a[0]=b[0];a[1]=b[1];return a}function g(a,b,c){a[0]=b;a[1]=c;return a}function h(a,b,c){a[0]=b[0]+c[0];a[1]=b[1]+c[1];return a}function i(a,b,c){a[0]=b[0]-c[0];a[1]=b[1]-c[1];return a}function j(a,b,c){a[0]=b[0]*c[0];a[1]=b[1]*c[1];return a}function l(a,b,c){a[0]=b[0]/c[0];a[1]=b[1]/c[1];return a}function m(a,b){a[0]=Math.ceil(b[0]);a[1]=Math.ceil(b[1]);return a}function n(a,b){a[0]=Math.floor(b[0]);a[1]=Math.floor(b[1]);return a}function o(a,b,c){a[0]=Math.min(b[0],c[0]);a[1]=Math.min(b[1],c[1]);return a}function p(a,b,c){a[0]=Math.max(b[0],c[0]);a[1]=Math.max(b[1],c[1]);return a}function q(a,b){a[0]=Math.round(b[0]);a[1]=Math.round(b[1]);return a}function r(a,b,c){a[0]=b[0]*c;a[1]=b[1]*c;return a}function s(b,c,d,a){b[0]=c[0]+d[0]*a;b[1]=c[1]+d[1]*a;return b}function t(a,b){var c=b[0]-a[0];b=b[1]-a[1];return Math.sqrt(c*c+b*b)}function u(a,b){var c=b[0]-a[0];b=b[1]-a[1];return c*c+b*b}function v(a){var b=a[0];a=a[1];return Math.sqrt(b*b+a*a)}function w(a){var b=a[0];a=a[1];return b*b+a*a}function x(a,b){a[0]=-b[0];a[1]=-b[1];return a}function y(a,b){a[0]=1/b[0];a[1]=1/b[1];return a}function z(a,b){var c=b[0],d=b[1];c=c*c+d*d;c>0&&(c=1/Math.sqrt(c));a[0]=b[0]*c;a[1]=b[1]*c;return a}function A(a,b){return a[0]*b[0]+a[1]*b[1]}function B(a,b,c){b=b[0]*c[1]-b[1]*c[0];a[0]=a[1]=0;a[2]=b;return a}function C(a,b,c,d){var e=b[0];b=b[1];a[0]=e+d*(c[0]-e);a[1]=b+d*(c[1]-b);return a}function D(c,b){b=b||1;var d=a.RANDOM()*2*Math.PI;c[0]=Math.cos(d)*b;c[1]=Math.sin(d)*b;return c}function E(a,b,c){var d=b[0];b=b[1];a[0]=c[0]*d+c[2]*b;a[1]=c[1]*d+c[3]*b;return a}function F(a,b,c){var d=b[0];b=b[1];a[0]=c[0]*d+c[2]*b+c[4];a[1]=c[1]*d+c[3]*b+c[5];return a}function G(a,b,c){var d=b[0];b=b[1];a[0]=c[0]*d+c[3]*b+c[6];a[1]=c[1]*d+c[4]*b+c[7];return a}function H(a,b,c){var d=b[0];b=b[1];a[0]=c[0]*d+c[4]*b+c[12];a[1]=c[1]*d+c[5]*b+c[13];return a}function I(a,b,c,d){var e=b[0]-c[0];b=b[1]-c[1];var f=Math.sin(d);d=Math.cos(d);a[0]=e*d-b*f+c[0];a[1]=e*f+b*d+c[1];return a}function J(a,b){var c=a[0];a=a[1];var d=b[0];b=b[1];var e=c*c+a*a;e>0&&(e=1/Math.sqrt(e));var f=d*d+b*b;f>0&&(f=1/Math.sqrt(f));c=(c*d+a*b)*e*f;if(c>1)return 0;else if(c<-1)return Math.PI;else return Math.acos(c)}function K(a){a[0]=0;a[1]=0;return a}function L(a){return"vec2("+a[0]+", "+a[1]+")"}function M(a,b){return a[0]===b[0]&&a[1]===b[1]}function N(b,c){var d=b[0];b=b[1];var e=c[0];c=c[1];return Math.abs(d-e)<=a.EPSILON*Math.max(1,Math.abs(d),Math.abs(e))&&Math.abs(b-c)<=a.EPSILON*Math.max(1,Math.abs(b),Math.abs(c))}d=v;Y.len=d;e=i;Y.sub=e;f=j;Y.mul=f;g=l;Y.div=g;h=t;Y.dist=h;m=u;Y.sqrDist=m;n=w;Y.sqrLen=n;o=function(){var a=c();return function(b,c,d,e,f,g){c||(c=2);d||(d=0);e?e=Math.min(e*c+d,b.length):e=b.length;for(d=d;d<e;d+=c)a[0]=b[d],a[1]=b[d+1],f(a,a,g),b[d]=a[0],b[d+1]=a[1];return b}}();Y.forEach=o}var Z=!1,da=function(){Z||(Z=!0,ca());return ba.exports},$={},ea={exports:$};function fa(){Object.defineProperty($,"__esModule",{value:!0});$.vec4=$.vec3=$.vec2=$.quat2=$.quat=$.mat4=$.mat3=$.mat2d=$.mat2=$.glMatrix=void 0;var a=b(k());$.glMatrix=a;a=b(p());$.mat2=a;a=b(u());$.mat2d=a;a=b(z());$.mat3=a;a=b(E());$.mat4=a;a=b(T());$.quat=a;a=b(aa());$.quat2=a;a=b(da());$.vec2=a;a=b(J());$.vec3=a;a=b(O());$.vec4=a;function b(a){if(a&&a.__esModule)return a;else{var b={};if(a!=null)for(var c in a)if(Object.prototype.hasOwnProperty.call(a,c)){var d=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(a,c):{};d.get||d.set?Object.defineProperty(b,c,d):b[c]=a[c]}b["default"]=a;return b}}}var ga=!1,ha=function(){ga||(ga=!0,fa());return ea.exports};a=function(a){switch(a){case void 0:return ha();case"/mat3":return z();case"/mat4":return E();case"/quat":return T();case"/vec2":return da();case"/vec3":return J();case"/vec4":return O()}};e.exports=a}),null);
__d("gl-matrix",["gl-matrix-3.0.0"],(function(a,b,c,d,e,f){e.exports=b("gl-matrix-3.0.0")()}),null);
__d("degToRad",[],(function(a,b,c,d,e,f){"use strict";function a(a){return a*Math.PI/180}e.exports=a}),null);
__d("radToDeg",[],(function(a,b,c,d,e,f){"use strict";function a(a){return a*180/Math.PI}e.exports=a}),null);
__d("SphericalPhotoProjectionUtils",["degToRad","gl-matrix","radToDeg"],(function(a,b,c,d,e,f){"use strict";b("gl-matrix").glMatrix;var g=b("gl-matrix").mat4,h=b("gl-matrix").vec3;a={getMaxMinVfov:function(a,c){var d=b("degToRad")(a.partialRightDegrees||180),e=b("degToRad")(a.partialLeftDegrees||180),f=b("degToRad")(a.partialTopDegrees||90);a=b("degToRad")(a.partialBottomDegrees||90);d=(d+e)/2;e=(f+a)/2;f=2*Math.atan(d/c);a=this.getMinFullVfov(e,e);return{maxVfov:b("radToDeg")(Math.max(f,a)),minVfov:b("radToDeg")(Math.min(a,f/2))}},getMaxVfov:function(a,b){return this.getMaxMinVfov(a,b).maxVfov},getMinFullVfov:function(a,b){a=(a+b)/2;return 2*Math.atan(a)},getMinFullHfov:function(a,b){a=(a+b)/2;return 2*Math.atan(a)},getZoomProgressFromFov:function(a,b,c){return Math.max(0,Math.min(1,(a-c)/(b-c)))},getZoomProgress:function(a,b,c){b=this.getMaxMinVfov(b,c);c=b.maxVfov;b=b.minVfov;return this.getZoomProgressFromFov(a,c,b)},getHfov:function(a,b){a=2*Math.atan(Math.tan(a/2)*b);return a},normalizeLimits:function(a){var b=a.partialLeftDegrees||0,c=a.partialRightDegrees||0,d=a.partialTopDegrees||0;a=a.partialBottomDegrees||0;if(b<0&&c<0){var e=Math.max(b,c);b-=e;c-=e}if(d<0&&a<0){e=Math.max(d,a);d-=e;a-=e}return{partialLeftDegrees:b,partialRightDegrees:c,partialTopDegrees:d,partialBottomDegrees:a}},getPartialLimits:function(a,c,d){var e=this.getMaxMinVfov(d,c),f=e.maxVfov;e=e.minVfov;var g=b("degToRad")(a);c=this.getHfov(g,c);e=this.getZoomProgressFromFov(a,f,e);c=Math.tan(c/2);g=Math.tan(g/2);var h=Math.sin(c)*e+c*(1-e);c=Math.cos(c)*e+1*(1-e);var i=Math.sin(g)*e+g*(1-e);g=Math.cos(g)*e+1*(1-e);e=function(c,d,e){var g=Math.sin(c);c=Math.cos(c);return a>f?0:b("radToDeg")(Math.atan2(g*e-c*d,g*d+c*e))};var j=b("degToRad")(d.partialLeftDegrees||180),k=b("degToRad")(d.partialRightDegrees||180),l=b("degToRad")(d.partialTopDegrees||90);d=b("degToRad")(d.partialBottomDegrees||90);return this.normalizeLimits({partialLeftDegrees:e(j,h,c),partialRightDegrees:e(k,h,c),partialTopDegrees:e(l,i,g),partialBottomDegrees:e(d,i,g)})},projectVertex:function(a,b,c,d){var e=a[0];a=a[1];var f=c?Math.sin(e):Math.sin(e)*Math.cos(a),g=c?a:Math.sin(a);c=c?Math.cos(e):Math.cos(e)*Math.cos(a);f=d*f+(1-d)*e;g=d*g+(1-d)*a;c=d*c+(1-d)*1;e=h.fromValues(f,g,c);h.transformMat4(e,e,b);return e},getSphericalFromVertex:function(a){var b=a[0],c=a[1];a=a[2];var d=Math.atan2(b,a);c=Math.atan2(c,Math.sqrt(b*b+a*a));return{yaw:d,pitch:c}},getRelativeHfov:function(a,c,d){a=this.getPartialLimits(a,c,d);c=d.partialLeftDegrees||180;d=d.partialRightDegrees||180;var e=a.partialLeftDegrees||0;a=a.partialRightDegrees||0;return b("degToRad")(d-a+c-e)},getRelativeVfov:function(a,c,d){a=this.getPartialLimits(a,c,d);c=d.partialTopDegrees||90;d=d.partialBottomDegrees||90;var e=a.partialTopDegrees||0;a=a.partialBottomDegrees||0;return b("degToRad")(c-e+d-a)},convert2dTo3d:function(a,c,d,e,f,i){var j=e/f,k=e/2,l=f/2;a=(a-k)*(2/e);k=(c-l)*(2/f);e=b("degToRad")(d.fov);c=this.getHfov(e,j);l=this.getMinFullHfov(b("degToRad")(i.partialLeftDegrees||180),b("degToRad")(i.partialRightDegrees||180));f=Math.tan(e/2);e=Math.tan(c/2);c=Math.tan(Math.min(c,l)/2);l=a*e;a=-k*f;if(l>c||l<-c)return null;e=this.getZoomProgress(d.fov,i,j);k=g.create();g.rotateY(k,k,b("degToRad")(d.yaw));g.rotateX(k,k,-b("degToRad")(d.pitch));f=this.projectVertex(h.fromValues(l,a,-1),k,!1,e);c=this.getSphericalFromVertex(f);i=b("radToDeg")(c.yaw);return{yaw:i<0?360+i:i,pitch:b("radToDeg")(c.pitch)}},convert3dTo2d:function(a,c,d,e,f,i){var j;a=(j=b("degToRad"))(a);c=j(c);var k=j(d.fov),l=e/f,m=this.getHfov(k,l);j=this.getMinFullHfov(j(i.partialLeftDegrees||180),b("degToRad")(i.partialRightDegrees||180));var n=Math.tan(m/2);m=Math.tan(Math.min(m,j)/2);j=m/n;m=this.getMinFullVfov(b("degToRad")(i.partialTopDegrees||90),b("degToRad")(i.partialBottomDegrees||90));n=Math.tan(k/2);k=Math.tan(Math.min(k,m)/2);m=k/n;k=this.getRelativeHfov(d.fov,l,i);n=this.getRelativeVfov(d.fov,l,i);l=g.create();g.rotateY(l,l,b("degToRad")(d.yaw));g.rotateX(l,l,-b("degToRad")(d.pitch));g.invert(l,l);i=a+Math.PI;d=c+Math.PI/2;a=-Math.sin(d)*Math.sin(i);c=-Math.cos(d);d=-Math.sin(d)*Math.cos(i);i=h.fromValues(a,c,d);h.transformMat4(i,i,l);a=Math.atan2(i[0],i[2]);c=Math.atan2(i[1],Math.sqrt(i[0]*i[0]+i[2]*i[2]));d=.5+a*j/k;l=.5-c*m/n;return{x:d*e,y:l*f}}};e.exports=a}),null);
__d("calculateHFOVFromVFOV",["degToRad","radToDeg"],(function(a,b,c,d,e,f){"use strict";a=function(a,c){a=b("radToDeg")(Math.atan(Math.tan(b("degToRad")(a/2))*c)*2);return(a%360+360)%360};e.exports=a}),null);
__d("calculateVFOVFromHFOV",["degToRad","radToDeg"],(function(a,b,c,d,e,f){"use strict";a=function(a,c){a=b("radToDeg")(Math.atan(Math.tan(b("degToRad")(a)/2)/c))*2;return(a%360+360)%360};e.exports=a}),null);
__d("SphericalViewportControl",["csx","cx","invariant","Bootloader","CSS","DOMEventListener","DOMQuery","Event","EventEmitter","Keys","Parent","SphericalPhotoProjectionUtils","SubscriptionsHandler","UserAgent","VelocityTracker","calculateHFOVFromVFOV","calculateVFOVFromHFOV","debounce","degToRad","getElementRect","performanceNow","queryThenMutateDOM","radToDeg","requestAnimationFrame","throttle","uniqueID"],(function(a,b,c,d,e,f,g,h,i){var j,k=b("DOMQuery").scry(window.document.body,"_li")[0]||window.document.body,l=navigator===void 0||navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i),m=.6,n=2.5,o=20,p=110,q=179,r=.01,s=1e3,t=.5,u=["W","A","S","D"].reduce(function(a,b){a[b]=b.charCodeAt(0);return a},{}),v={Up:"__tu",Down:"__tz",Left:"_2a6u",Right:"_2a6v",UpLeft:"__t-",UpRight:"__u0",DownLeft:"__u1",DownRight:"__u3"};a=function(a){"use strict";babelHelpers.inheritsLoose(c,a);function c(c,d,e,f,g){var h;e===void 0&&(e={});f===void 0&&(f=!1);g===void 0&&(g=k);h=a.call(this)||this;h.$SphericalViewportControl18=!1;h.$SphericalViewportControl19=!1;h.$SphericalViewportControl20=!1;h.$SphericalViewportControl45=!1;h.$SphericalViewportControl62=!1;h.$SphericalViewportControl64={x:1,y:1};h.$SphericalViewportControl65=!1;h.$SphericalViewportControl66=null;h.$SphericalViewportControl69=!1;h.$SphericalViewportControl70=!0;h.$SphericalViewportControl90=function(a){a.deliberateSync=!0;if(h.$SphericalViewportControl67){if(a.shiftKey){var c=h.$SphericalViewportControl114(a),d=b("getElementRect")(h.$SphericalViewportControl32);if(c.x>d.left&&c.x<d.right&&c.y>d.top&&c.y<d.bottom){var e=(a.deltaX||0)+(a.deltaY||0)+(a.deltaZ||0),f=.5*(d.left+d.right),g=.5*(d.top+d.bottom);f={x:(c.x-f)/(d.right-d.left),y:(c.y-g)/(d.bottom-d.top)};h.emit("wheelScrollWithShiftKey",e,f)}a.preventDefault()}return}h.$SphericalViewportControl38&&a.preventDefault();h.$SphericalViewportControl124(a);h.$SphericalViewportControl46&&b("Event").kill(a)};h.$SphericalViewportControl127=function(a){h.emit("panningWithRightMouse",h.$SphericalViewportControl111());if(h.$SphericalViewportControl69){h.$SphericalViewportControl66=b("requestAnimationFrame")(h.$SphericalViewportControl127);return}h.emit("updateViewportEnd",h.$SphericalViewportControl26.x,h.$SphericalViewportControl26.y);h.$SphericalViewportControl15=!1;h.$SphericalViewportControl66=null};h.$SphericalViewportControl128=function(a){var c=(a-h.$SphericalViewportControl59)/1e3;h.$SphericalViewportControl59=a;h.$SphericalViewportControl129();h.$SphericalViewportControl60||b("queryThenMutateDOM")(h.$SphericalViewportControl91.bind(babelHelpers.assertThisInitialized(h)),function(){return null});a=h.$SphericalViewportControl111();var d=!1;if(h.$SphericalViewportControl42&&h.$SphericalViewportControl54&&h.$SphericalViewportControl47&&!h.$SphericalViewportControl19&&!h.$SphericalViewportControl20){var e=h.$SphericalViewportControl130()*c;a.x+=e;var f=h.$SphericalViewportControl131()*c;a.y+=f;(e||f)&&(d=!0)}a.x+=h.$SphericalViewportControl8.getVelocityX()*c;a.y+=h.$SphericalViewportControl8.getVelocityY()*c;a.x+=h.$SphericalViewportControl9.getVelocityX()*c;a.y+=h.$SphericalViewportControl9.getVelocityY()*c;a.x*=h.$SphericalViewportControl64.x;a.y*=h.$SphericalViewportControl64.y;h.$SphericalViewportControl132(a.x,a.y);e=h.$SphericalViewportControl8.getSpeed()>0||h.$SphericalViewportControl9.getSpeed()>0;if(h.$SphericalViewportControl19||h.$SphericalViewportControl18||h.$SphericalViewportControl20||h.$SphericalViewportControl57||h.$SphericalViewportControl45||e||d)h.$SphericalViewportControl66=b("requestAnimationFrame")(h.$SphericalViewportControl128);else{h.$SphericalViewportControl15=!1;h.$SphericalViewportControl66=null;f={yaw:h.$SphericalViewportControl26.x,pitch:h.$SphericalViewportControl26.y};c=h.getCurrentViewport();h.$SphericalViewportControl4.pitch+=f.pitch-c.pitch;h.$SphericalViewportControl4.yaw-=f.yaw-c.yaw;h.emit("updateViewportEnd",h.$SphericalViewportControl26.x,h.$SphericalViewportControl26.y)}};h.$SphericalViewportControl124=b("throttle")(function(a){h.emit("wheelScroll",a);if(!h.$SphericalViewportControl46)return;a=(a.deltaX||0)+(a.deltaY||0)+(a.deltaZ||0);a=a/120*45/10;h.$SphericalViewportControl99(a)},30);h.$SphericalViewportControl70=e.listenOnlyOneElement==null?!0:e.listenOnlyOneElement;h.$SphericalViewportControl4={pitch:0,yaw:0};h.$SphericalViewportControl5=d.dragVelocityFactor||m;h.$SphericalViewportControl3=!1;h.$SphericalViewportControl8=new(b("VelocityTracker"))(300);h.$SphericalViewportControl9=new(b("VelocityTracker"))(300);h.$SphericalViewportControl13=new(b("SubscriptionsHandler"))();h.$SphericalViewportControl32=c;h.$SphericalViewportControl10=g;h.$SphericalViewportControl51=o;h.$SphericalViewportControl52=p;h.$SphericalViewportControl53=q;h.$SphericalViewportControl63=f;h.$SphericalViewportControl71(d);h.$SphericalViewportControl21={x:0,y:0};h.$SphericalViewportControl59=0;h.$SphericalViewportControl17={left:0,right:0,up:0,down:0};h.$SphericalViewportControl23={x:0,y:0};h.$SphericalViewportControl24={x:0,y:0};h.$SphericalViewportControl25=new(b("VelocityTracker"))();h.$SphericalViewportControl30=new Map();h.$SphericalViewportControl38=!1;h.$SphericalViewportControl22=!1;h.$SphericalViewportControl27=!1;h.$SphericalViewportControl72(e);h.$SphericalViewportControl57=!1;h.$SphericalViewportControl58=0;h.$SphericalViewportControl56=b("debounce")(function(){return h.emit("zoomStart")},s);h.$SphericalViewportControl37=h.$SphericalViewportControl73();h.$SphericalViewportControl61=[];h.$SphericalViewportControl31=h.addNewLayer(h.$SphericalViewportControl32);l&&b("Bootloader").loadModules(["FullTilt"],function(a){a.getDeviceOrientation({type:"game"}).then(function(a){return h.$SphericalViewportControl74(a,d)})["catch"](function(a){return h.$SphericalViewportControl75(a)})},"SphericalViewportControl");return h}var d=c.prototype;d.$SphericalViewportControl74=function(a,c){var d=this;if(c.partialLimits){var e=c.partialLimits,f=this.getVerticalFieldOfView(),g=this.getHorizontalFieldOfView();this.$SphericalViewportControl6={top:(e.partialTopDegrees||Infinity)-f/2,bottom:-(e.partialBottomDegrees||Infinity)+f/2,left:-(e.partialLeftDegrees||Infinity)+g/2,right:(e.partialRightDegrees||Infinity)-g/2}}b("Bootloader").loadModules(["MSphericalViewportControlEuler"],function(b){d.$SphericalViewportControl2=new b(a,c,d.$SphericalViewportControl6),d.$SphericalViewportControl2.setActive(!0),d.$SphericalViewportControl1=a,d.$SphericalViewportControl1.start(function(){return d.$SphericalViewportControl76()}),d.$SphericalViewportControl3=!0},"SphericalViewportControl")};d.$SphericalViewportControl76=function(){var a={yaw:b("degToRad")(this.$SphericalViewportControl4.yaw-this.$SphericalViewportControl28.x),pitch:b("degToRad")(this.$SphericalViewportControl4.pitch+this.$SphericalViewportControl28.y)};this.$SphericalViewportControl2.onSensorUpdate();this.$SphericalViewportControl2.getRotationMatrix(a);a=this.getCurrentViewport();this.$SphericalViewportControl15||this.emit("viewportChange",a.yaw,a.pitch,this.$SphericalViewportControl11)};d.getCurrentViewport=function(){var a={yaw:b("degToRad")(this.$SphericalViewportControl4.yaw-this.$SphericalViewportControl28.x),pitch:b("degToRad")(this.$SphericalViewportControl4.pitch+this.$SphericalViewportControl28.y)};return!this.$SphericalViewportControl3?{pitch:b("radToDeg")(a.pitch),yaw:b("radToDeg")(a.yaw)}:this.$SphericalViewportControl2.getCurrentViewport(a)||{pitch:b("radToDeg")(a.pitch),yaw:b("radToDeg")(a.yaw)}};d.$SphericalViewportControl75=function(a){this.emit("sensorSetupError",{error:"SPHERICAL_GYROSCOPE_SETUP_FAILED",message:a})};d.isListening=function(a){return!this.$SphericalViewportControl70||Boolean(this.getSubscriptionKeyFromElement(a))};d.getSubscriptionKeyFromElement=function(a){for(var b=this.$SphericalViewportControl30,c=Array.isArray(b),d=0,b=c?b:b[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var e;if(c){if(d>=b.length)break;e=b[d++]}else{d=b.next();if(d.done)break;e=d.value}e=e;var f=e[0];e=e[1];if(e.element===a)return f}return null};d.addNewLayer=function(a){var c=this.getSubscriptionKeyFromElement(a);if(!c){c=b("uniqueID")();var d=new(b("SubscriptionsHandler"))();this.$SphericalViewportControl77(d,a);this.$SphericalViewportControl30.set(c,{handler:d,element:a})}return c};d.removeLayer=function(a){var b=this.$SphericalViewportControl30.get(a);b&&(b.handler.release(),this.$SphericalViewportControl30["delete"](a))};d.destroy=function(){this.removeAllListeners(),this.getSubscriptions().remove()};d.$SphericalViewportControl77=function(a,c){var d=this;a.addSubscriptions((a=b("Event")).listen(c,"mousedown",function(a){return d.$SphericalViewportControl78(a)}),a.listen(c,"mouseenter",function(a){return d.$SphericalViewportControl79(a,c)}),a.listen(c,"mouseleave",function(a){return d.$SphericalViewportControl80(a,c)}),a.listen(c,"mousemove",function(a){return d.$SphericalViewportControl81(a)}),a.listen(c,"mouseup",function(a){return d.$SphericalViewportControl82(a)}),a.listen(c,"click",function(a){return d.$SphericalViewportControl83(a)}),a.listen(c,"keydown",function(a){return d.$SphericalViewportControl84(a)}),a.listen(c,"keyup",function(a){return d.$SphericalViewportControl85(a)}),a.listen(c,"blur",function(a){return d.$SphericalViewportControl86(a)}),a.listen(c,"touchstart",function(a){return d.$SphericalViewportControl87(a)}),a.listen(c,"touchmove",function(a){return d.$SphericalViewportControl88(a)}),a.listen(c,"touchend",function(a){return d.$SphericalViewportControl89(a)}),a.listen(c,"touchcancel",function(a){return d.$SphericalViewportControl89(a)}),{remove:function(){b("DOMEventListener").remove(c,"wheel",function(a){return d.$SphericalViewportControl90(a)},{passive:!1})}})};d.$SphericalViewportControl71=function(a){this.$SphericalViewportControl91();this.$SphericalViewportControl7=this.$SphericalViewportControl34/this.$SphericalViewportControl35;var b=a.fieldOfView;this.$SphericalViewportControl46=Boolean(a.enableZoom);this.$SphericalViewportControl29=(a.panningVelocityFactor||0)/15*80||80;this.$SphericalViewportControl16=(a.keyboardVelocityFactor||0)*1e3||80;a.partialLimits?(this.$SphericalViewportControl39=a.partialLimits,this.$SphericalViewportControl42=!0):(this.$SphericalViewportControl42=!1,this.$SphericalViewportControl39={partialLeftDegrees:null,partialRightDegrees:null,partialTopDegrees:null,partialBottomDegrees:null});this.$SphericalViewportControl40=this.$SphericalViewportControl39;this.$SphericalViewportControl41=1;this.$SphericalViewportControl63&&(this.$SphericalViewportControl42=!0);this.$SphericalViewportControl28={x:a.initialHeading,y:a.initialPitch};a=this.$SphericalViewportControl39;var c=a.partialTopDegrees;a=a.partialBottomDegrees;if(!this.$SphericalViewportControl63&&(c||c===0)&&(a||a===0)){c=c;a=a;var d=c+a;b>d&&(b=d,this.$SphericalViewportControl28.y=(c-a)/2)}this.$SphericalViewportControl11=this.$SphericalViewportControl92(b);this.$SphericalViewportControl12=this.$SphericalViewportControl11;this.$SphericalViewportControl93();this.$SphericalViewportControl26={x:this.$SphericalViewportControl28.x,y:this.$SphericalViewportControl28.y}};d.$SphericalViewportControl72=function(a){a===void 0&&(a={}),this.$SphericalViewportControl43=a.enableGyro||!1,this.$SphericalViewportControl44=a.slipFactor||0,this.$SphericalViewportControl47=a.springFactor||0,this.$SphericalViewportControl48=a.maxSpringDegrees||15,this.$SphericalViewportControl49=a.maxStretchXDegrees||20,this.$SphericalViewportControl50=a.maxStretchYDegrees||20,this.$SphericalViewportControl55=a.rubberBandConstant||0,this.$SphericalViewportControl54=a.enableRubberBanding||!1,this.$SphericalViewportControl67=a.enableZoomWithShiftKey||!1,this.$SphericalViewportControl68=a.enablePanningWithRightMouse||!1,this.$SphericalViewportControl60=a.disableAutoClientSizeUpdate||!1};d.reconfigure=function(a){this.$SphericalViewportControl71(a)};d.reconfigureControlConfig=function(a){a===void 0&&(a={}),this.$SphericalViewportControl72(a)};d.setEnableGyro=function(a){this.$SphericalViewportControl43=a};d.$SphericalViewportControl78=function(a){this.$SphericalViewportControl65&&this.$SphericalViewportControl94(),this.isListening(a.target)&&(this.$SphericalViewportControl19=!0,this.$SphericalViewportControl95(a))};d.$SphericalViewportControl87=function(a){this.$SphericalViewportControl62=!1,this.$SphericalViewportControl65&&this.$SphericalViewportControl94(),this.$SphericalViewportControl20?(this.$SphericalViewportControl96(a),this.$SphericalViewportControl20=!1):this.$SphericalViewportControl20=!0,this.$SphericalViewportControl95(a)};d.$SphericalViewportControl96=function(a){a.touches.length===2&&this.$SphericalViewportControl46&&(this.$SphericalViewportControl57=!0,this.$SphericalViewportControl58=this.$SphericalViewportControl97(a))};d.$SphericalViewportControl88=function(a){this.$SphericalViewportControl62=!0,this.$SphericalViewportControl57&&(this.$SphericalViewportControl98(a),this.$SphericalViewportControl46&&b("Event").kill(a))};d.$SphericalViewportControl98=function(a){a=this.$SphericalViewportControl97(a);var b=this.$SphericalViewportControl11*(this.$SphericalViewportControl58/a);b=b-this.$SphericalViewportControl11;this.$SphericalViewportControl99(b);this.$SphericalViewportControl58=a};d.$SphericalViewportControl97=function(a){var b=a.touches[0].pageX-a.touches[1].pageX;a=a.touches[0].pageY-a.touches[1].pageY;return Math.sqrt(Math.pow(b,2)+Math.pow(a,2))};d.$SphericalViewportControl89=function(a){this.$SphericalViewportControl62||(a.target.focus(a),this.$SphericalViewportControl83(a)),this.$SphericalViewportControl57?this.$SphericalViewportControl57=!1:this.$SphericalViewportControl20&&this.$SphericalViewportControl100(a)};d.$SphericalViewportControl95=function(a){this.emit("onMovementStart"),this.$SphericalViewportControl101(),this.$SphericalViewportControl102(a),this.$SphericalViewportControl103(a),this.$SphericalViewportControl68&&(a.which===3||a.button===2)&&(this.$SphericalViewportControl69=!0,this.$SphericalViewportControl15=!1),this.$SphericalViewportControl104(),a.preventDefault()};d.$SphericalViewportControl100=function(a){this.$SphericalViewportControl45&&!this.$SphericalViewportControl19&&(this.$SphericalViewportControl105(),this.$SphericalViewportControl45=!1)};d.$SphericalViewportControl106=function(a){this.$SphericalViewportControl65&&this.$SphericalViewportControl94()};d.$SphericalViewportControl107=function(a){this.$SphericalViewportControl103(a),this.$SphericalViewportControl14=!0,this.emit("updateViewportMove")};d.$SphericalViewportControl108=function(a){this.$SphericalViewportControl45&&(this.$SphericalViewportControl109(a),this.emit("updateViewportMove"))};d.$SphericalViewportControl101=function(){this.$SphericalViewportControl15=!1,this.$SphericalViewportControl45=!1,this.$SphericalViewportControl43=!1};d.$SphericalViewportControl110=function(a){this.$SphericalViewportControl103(a),this.$SphericalViewportControl111(),this.$SphericalViewportControl94(),this.$SphericalViewportControl105(),a.preventDefault()};d.$SphericalViewportControl94=function(a){var c=this;this.$SphericalViewportControl65=!1;b("queryThenMutateDOM")(function(){},function(){return c.$SphericalViewportControl32.style.cursor=""});this.$SphericalViewportControl20=!1;this.$SphericalViewportControl19=!1;this.$SphericalViewportControl69=!1;this.$SphericalViewportControl13.release();this.$SphericalViewportControl36&&(b("CSS").removeClass(this.$SphericalViewportControl10,this.$SphericalViewportControl36),this.$SphericalViewportControl36="")};d.$SphericalViewportControl112=function(a){if(this.$SphericalViewportControl20&&a.changedTouches)return a.changedTouches[0];else if(this.$SphericalViewportControl19)return a;else if(this.$SphericalViewportControl45)return a;return null};d.setMovementPosition=function(a){this.$SphericalViewportControl23=this.$SphericalViewportControl113(a)};d.$SphericalViewportControl113=function(a){a=this.$SphericalViewportControl112(a);return!a?this.$SphericalViewportControl23:{x:a.screenX,y:a.screenY}};d.$SphericalViewportControl114=function(a){a=this.$SphericalViewportControl112(a);return!a?this.$SphericalViewportControl24:{x:a.clientX,y:a.clientY}};d.$SphericalViewportControl102=function(a){var c=this;this.$SphericalViewportControl65=!0;this.$SphericalViewportControl23=this.$SphericalViewportControl113(a);this.$SphericalViewportControl21={x:0,y:0};this.$SphericalViewportControl25=new(b("VelocityTracker"))();this.$SphericalViewportControl9=new(b("VelocityTracker"))(300);b("queryThenMutateDOM")(function(){},function(){return c.$SphericalViewportControl32.style.cursor=c.$SphericalViewportControl37});this.$SphericalViewportControl13.engage();a=this.$SphericalViewportControl10;this.$SphericalViewportControl20?this.$SphericalViewportControl13.addSubscriptions(b("Event").listen(a,"touchmove",function(a){return c.$SphericalViewportControl107(a)}),b("Event").listen(a,"touchend",function(a){return c.$SphericalViewportControl110(a)}),b("Event").listen(a,"touchcancel",function(a){return c.$SphericalViewportControl106(a)})):this.$SphericalViewportControl13.addSubscriptions(b("Event").listen(a,"mousemove",function(a){return c.$SphericalViewportControl107(a)}),b("Event").listen(a,"mouseup",function(a){return c.$SphericalViewportControl110(a)}),b("Event").listen(a,"mouseleave",function(a){return c.$SphericalViewportControl106(a)}))};d.$SphericalViewportControl109=function(a){this.$SphericalViewportControl115(a,this.$SphericalViewportControl44)};d.$SphericalViewportControl103=function(a){this.$SphericalViewportControl115(a,1)};d.reEnableGyro=function(){this.$SphericalViewportControl21={x:0,y:0},this.$SphericalViewportControl43=!0,this.$SphericalViewportControl45=!0,this.$SphericalViewportControl94()};d.$SphericalViewportControl115=function(a,b){var c=this.$SphericalViewportControl113(a),d=c.x-this.$SphericalViewportControl23.x,e=c.y-this.$SphericalViewportControl23.y,f=this.$SphericalViewportControl22?{x:0,y:0}:this.$SphericalViewportControl21;this.$SphericalViewportControl21={x:b*(c.x-this.$SphericalViewportControl23.x)+f.x,y:b*(c.y-this.$SphericalViewportControl23.y)+f.y};this.$SphericalViewportControl4.yaw+=d*this.$SphericalViewportControl5;this.$SphericalViewportControl4.pitch+=e*this.$SphericalViewportControl5;this.$SphericalViewportControl22=!1;this.$SphericalViewportControl23=c;this.$SphericalViewportControl25.update(c.x,c.y);this.$SphericalViewportControl24=this.$SphericalViewportControl114(a)};d.$SphericalViewportControl116=function(){var a=this.$SphericalViewportControl117(),b=-this.$SphericalViewportControl25.getVelocityX()*a;a=this.$SphericalViewportControl25.getVelocityY()*a;var c=this.$SphericalViewportControl45?this.$SphericalViewportControl44:1;this.$SphericalViewportControl118()&&(b=-b);return{x:b*c,y:a*c}};d.$SphericalViewportControl119=function(a,c){return b("radToDeg")(Math.atan(a/c))};d.$SphericalViewportControl120=function(a,b,c){return{x:this.$SphericalViewportControl119(a.x-this.$SphericalViewportControl34/2,c),y:-this.$SphericalViewportControl119(a.y-this.$SphericalViewportControl35/2,b)}};d.$SphericalViewportControl121=function(a,c){var d={x:a.x-c.x,y:a.y-c.y},e=this.$SphericalViewportControl35/(2*Math.tan(b("degToRad")(this.getVerticalFieldOfView()/2))),f=e*Math.cos(b("degToRad")(this.$SphericalViewportControl26.y));f=f-(this.$SphericalViewportControl35/2-a.y)*Math.sin(b("degToRad")(this.$SphericalViewportControl26.y));if(this.$SphericalViewportControl26.y==-90&&c.y<0||this.$SphericalViewportControl26.y==90&&c.y>0){c=this.$SphericalViewportControl119(d.y-this.$SphericalViewportControl35/2,d.x-this.$SphericalViewportControl34/2);var g=this.$SphericalViewportControl119(a.y-this.$SphericalViewportControl35/2,a.x-this.$SphericalViewportControl34/2);g=g-c;g>90?g=180-g:g<-90&&(g=180+g);return{x:g*Math.sign(this.$SphericalViewportControl26.y),y:0}}else{c=this.$SphericalViewportControl120(d,e,f);g=this.$SphericalViewportControl120(a,e,f);return{x:c.x-g.x,y:c.y-g.y}}};d.$SphericalViewportControl118=function(){var a=this.$SphericalViewportControl33?this.$SphericalViewportControl33.top:b("getElementRect")(this.$SphericalViewportControl32).top;a=this.$SphericalViewportControl24.y-a;var c=this.$SphericalViewportControl35/(2*Math.tan(b("degToRad")(this.getVerticalFieldOfView()/2)));c=-c/Math.tan(b("degToRad")(this.$SphericalViewportControl26.y))+this.$SphericalViewportControl35/2;a=a>c&&this.$SphericalViewportControl26.y<0||a<c&&this.$SphericalViewportControl26.y>0;return a};d.$SphericalViewportControl111=function(){if(this.$SphericalViewportControl69){var a={x:0,y:0};this.$SphericalViewportControl22||(this.$SphericalViewportControl22=!0,a.x=this.$SphericalViewportControl21.x/this.$SphericalViewportControl34,a.y=this.$SphericalViewportControl21.y/this.$SphericalViewportControl35);return a}a={x:0,y:0};if(!this.$SphericalViewportControl22){this.$SphericalViewportControl22=!0;var b=this.$SphericalViewportControl33,c=this.$SphericalViewportControl24.x<b.left,d=this.$SphericalViewportControl24.x>b.right,e=this.$SphericalViewportControl24.y<b.top,f=this.$SphericalViewportControl24.y>b.bottom;this.$SphericalViewportControl122(c,d,e,f);b={x:this.$SphericalViewportControl24.x-b.left,y:this.$SphericalViewportControl24.y-b.top};!c&&!d?a.x=this.$SphericalViewportControl121(b,this.$SphericalViewportControl21).x:a.x=-this.$SphericalViewportControl21.x*this.$SphericalViewportControl117()*t;!e&&!f?a.y=this.$SphericalViewportControl121(b,this.$SphericalViewportControl21).y:a.y=this.$SphericalViewportControl21.y*this.$SphericalViewportControl117()*t}this.$SphericalViewportControl9.updateVelocity(0,0);return this.$SphericalViewportControl123(a)};d.$SphericalViewportControl123=function(a){if(!this.$SphericalViewportControl54||!this.$SphericalViewportControl42)return a;var b=this.$SphericalViewportControl26,c=b.x;b=b.y;var d=this.$SphericalViewportControl40,e=d.partialLeftDegrees,f=d.partialRightDegrees,g=d.partialTopDegrees;d=d.partialBottomDegrees;var h=a.x;a=a.y;var i=c+h;b=b+a;var j=!0,k=!0;if(this.$SphericalViewportControl63){var l=this.$SphericalViewportControl39.partialLeftDegrees,m=this.$SphericalViewportControl39.partialRightDegrees,n=this.$SphericalViewportControl41===0;(i<180&&h<0||i>180&&h>0)&&(i=c-h);(l!=null||!n)&&e!=null&&(j=e<0?(i<180?i+360:i)>360-e:i>360-e);(m!=null||!n)&&f!=null&&(k=f<0?(i<180?i+360:i)<360+f:(i>180?360-i:i)<f);c=g!=null?b<g:!0;l=d!=null?b>-d:!0}else{m=this.getVerticalFieldOfView();n=this.getHorizontalFieldOfView();var o=i<180?i+360:i;i=i>180?i-360:i;j=e!=null?o>360-e+n/2:!0;k=f!=null?i<f-n/2:!0;c=g!=null?b<g-m/2:!0;l=d!=null?b>-d+m/2:!0}!j&&!k&&(h*=this.$SphericalViewportControl55);(!c||!l)&&(a*=this.$SphericalViewportControl55);return{x:h,y:a}};d.$SphericalViewportControl79=function(a,c){b("DOMEventListener").add(c,"wheel",this.$SphericalViewportControl90,{passive:!1}),this.emit("mouseEnter"),this.$SphericalViewportControl19?this.$SphericalViewportControl9=new(b("VelocityTracker"))(300):this.$SphericalViewportControl43&&this.$SphericalViewportControl44&&(this.$SphericalViewportControl9=new(b("VelocityTracker"))(300),this.$SphericalViewportControl45=!0,this.$SphericalViewportControl23=this.$SphericalViewportControl113(a),this.$SphericalViewportControl21={x:0,y:0},this.$SphericalViewportControl104())};d.$SphericalViewportControl80=function(a,c){b("DOMEventListener").remove(c,"wheel",this.$SphericalViewportControl90,{passive:!1}),this.emit("mouseLeave",a),this.$SphericalViewportControl100(a)};d.$SphericalViewportControl81=function(a){this.emit("mouseMove",a),this.$SphericalViewportControl43&&this.$SphericalViewportControl108(a)};d.$SphericalViewportControl82=function(a){this.emit("mouseUp",a)};d.$SphericalViewportControl83=function(a){if(this.isListening(a.target)){a.target.focus();var c=b("Parent").bySelector(a.target,"._24cp");if(!this.$SphericalViewportControl14){this.emit("DOM/click",a);if(c)return!0}this.$SphericalViewportControl14=!1}return!1};d.$SphericalViewportControl99=function(a){a=this.setFieldOfView(this.$SphericalViewportControl11+a);a&&this.$SphericalViewportControl56()};d.disableKeyboard=function(){this.$SphericalViewportControl27=!0};d.enableKeyboard=function(){this.$SphericalViewportControl27=!1};d.$SphericalViewportControl84=function(a){a=this.$SphericalViewportControl125(a);if(a&&!this.$SphericalViewportControl27){this.$SphericalViewportControl17[a]=1;this.$SphericalViewportControl18||(this.$SphericalViewportControl18=!0,this.$SphericalViewportControl101(),this.$SphericalViewportControl104(),this.emit("updateViewportMove"));return!1}return!0};d.$SphericalViewportControl85=function(a){a=this.$SphericalViewportControl125(a);if(a&&!this.$SphericalViewportControl27){this.$SphericalViewportControl17[a]=0;a=!1;for(var b in this.$SphericalViewportControl17)if(Object.prototype.hasOwnProperty.call(this.$SphericalViewportControl17,b)&&this.$SphericalViewportControl17[b]>0){a=!0;break}this.$SphericalViewportControl18=a;return!1}return!0};d.$SphericalViewportControl105=function(){var a=this.$SphericalViewportControl116();this.$SphericalViewportControl9=new(b("VelocityTracker"))(300,a)};d.$SphericalViewportControl104=function(){var a=this;if(!this.$SphericalViewportControl15){this.$SphericalViewportControl60&&this.$SphericalViewportControl126();this.$SphericalViewportControl15=!0;this.$SphericalViewportControl8.updateVelocity(0,0);this.emit("updateViewportBegin",this.$SphericalViewportControl26.x,this.$SphericalViewportControl26.y);var c=this.once("updateViewportMove",function(){return a.emit("updateViewportMoveStart",a.$SphericalViewportControl45)});this.once("updateViewportEnd",function(){return c.remove()});this.$SphericalViewportControl59=(j||(j=b("performanceNow")))();if(this.$SphericalViewportControl69){this.$SphericalViewportControl66&&cancelAnimationFrame(this.$SphericalViewportControl66);this.$SphericalViewportControl66=b("requestAnimationFrame")(this.$SphericalViewportControl127);return}this.$SphericalViewportControl66||(this.$SphericalViewportControl66=b("requestAnimationFrame")(this.$SphericalViewportControl128))}};d.$SphericalViewportControl126=function(){this.$SphericalViewportControl33=b("getElementRect")(this.$SphericalViewportControl32)};d.updateViewportClientSize=function(a){this.$SphericalViewportControl34=a.width,this.$SphericalViewportControl35=a.height};d.updateMinVFOV=function(a){this.$SphericalViewportControl51=Math.max(n,Math.min(o,a))};d.updateMaxVFOV=function(a){this.$SphericalViewportControl52=a};d.updateMaxHFOV=function(a){this.$SphericalViewportControl53=a};d.$SphericalViewportControl91=function(){this.$SphericalViewportControl33=b("getElementRect")(this.$SphericalViewportControl32),this.$SphericalViewportControl34=this.$SphericalViewportControl32.clientWidth||1,this.$SphericalViewportControl35=this.$SphericalViewportControl32.clientHeight||1};d.setAngularVelocityScaleFactor=function(a){this.$SphericalViewportControl64=a};d.$SphericalViewportControl130=function(){var a=180,b=0,c=this.$SphericalViewportControl40,d=c.partialLeftDegrees;c=c.partialRightDegrees;d!=null&&c!=null&&(a=(c-d)/2+180);if(this.$SphericalViewportControl63){var e=this.$SphericalViewportControl39.partialLeftDegrees,f=this.$SphericalViewportControl39.partialRightDegrees,g=this.$SphericalViewportControl41===0;if((e!=null||!g)&&d!=null){e=d<0&&this.$SphericalViewportControl26.x<180?this.$SphericalViewportControl26.x+360:this.$SphericalViewportControl26.x;if(e>a){e=360-d-e;e>0&&(b=Math.min(e,this.$SphericalViewportControl48)*this.$SphericalViewportControl47)}}if((f!=null||!g)&&c!=null){e=c<0&&this.$SphericalViewportControl26.x>180?this.$SphericalViewportControl26.x-360:this.$SphericalViewportControl26.x;if(e<a){f=c-e;f<0&&(b=Math.max(f,-this.$SphericalViewportControl48)*this.$SphericalViewportControl47)}}}else{g=this.getHorizontalFieldOfView();e=this.$SphericalViewportControl26.x<180?this.$SphericalViewportControl26.x+360:this.$SphericalViewportControl26.x;f=this.$SphericalViewportControl26.x>180?this.$SphericalViewportControl26.x-360:this.$SphericalViewportControl26.x;if(d!=null&&c!=null&&d+c<g){var h=(c-d)/2-f;h>0?b=Math.min(h,this.$SphericalViewportControl48)*this.$SphericalViewportControl47:h<0&&(b=Math.max(h,-this.$SphericalViewportControl48)*this.$SphericalViewportControl47);return Math.abs(b)<r?0:b}if(d!=null&&e>=a){h=360-d+g/2-e;h>0&&(b=Math.min(h,this.$SphericalViewportControl48)*this.$SphericalViewportControl47)}if(c!=null&&f<=a){d=c-g/2-f;d<0&&(b=Math.max(d,-this.$SphericalViewportControl48)*this.$SphericalViewportControl47)}}return Math.abs(b)<r?0:b};d.$SphericalViewportControl131=function(){var a=0,b=0,c=this.$SphericalViewportControl40,d=c.partialTopDegrees;c=c.partialBottomDegrees;if(this.$SphericalViewportControl63){if(c!=null&&d!=null){if(c<0&&d<-c||d<0&&-d>c)return 0;b=(d-c)/2}if(d!=null&&this.$SphericalViewportControl26.y>b){var e=d-this.$SphericalViewportControl26.y;e<0&&(a=Math.max(e,-this.$SphericalViewportControl48)*this.$SphericalViewportControl47)}if(c!=null&&this.$SphericalViewportControl26.y<b){e=-c-this.$SphericalViewportControl26.y;e>0&&(a=Math.min(e,this.$SphericalViewportControl48)*this.$SphericalViewportControl47)}}else{b=this.getVerticalFieldOfView();if(c!=null&&d!=null&&c+d<b){e=(d-c)/2-this.$SphericalViewportControl26.y;e>0?a=Math.min(e,this.$SphericalViewportControl48)*this.$SphericalViewportControl47:e<0&&(a=Math.max(e,-this.$SphericalViewportControl48)*this.$SphericalViewportControl47);return Math.abs(a)<r?0:a}if(d!=null){e=d-b/2-this.$SphericalViewportControl26.y;e<0&&(a=Math.max(e,-this.$SphericalViewportControl48)*this.$SphericalViewportControl47)}if(c!=null){d=-c+b/2-this.$SphericalViewportControl26.y;d>0&&(a=Math.min(d,this.$SphericalViewportControl48)*this.$SphericalViewportControl47)}}return Math.abs(a)<r?0:a};d.$SphericalViewportControl122=function(a,c,d,e){var f="";if(a||c||d||e){a=a?"Left":c?"Right":"";c=d?"Up":e?"Down":"";f=v[c+a]}this.$SphericalViewportControl36!=f&&(this.$SphericalViewportControl36&&(b("CSS").removeClass(this.$SphericalViewportControl10,this.$SphericalViewportControl36),this.$SphericalViewportControl36=""),f&&(this.$SphericalViewportControl36=f,b("CSS").addClass(this.$SphericalViewportControl10,f)))};d.getSubscriptions=function(){var a=this;return{remove:function(){a.$SphericalViewportControl30.forEach(function(a){a=a.handler;return a.release()}),a.$SphericalViewportControl30.clear(),a.$SphericalViewportControl13.release()}}};d.$SphericalViewportControl86=function(a){for(var b in this.$SphericalViewportControl17)this.$SphericalViewportControl17[b]=0;this.$SphericalViewportControl18=!1};d.getOrientation=function(){return this.$SphericalViewportControl26};d.$SphericalViewportControl93=function(a){if(this.$SphericalViewportControl63){a=a!=null?a:this.getVerticalFieldOfView();var c=this.getAspectRatio();this.$SphericalViewportControl40=b("SphericalPhotoProjectionUtils").getPartialLimits(a,c,this.$SphericalViewportControl39);this.$SphericalViewportControl41=b("SphericalPhotoProjectionUtils").getZoomProgress(a,this.$SphericalViewportControl39,c)}};d.$SphericalViewportControl133=function(a,b){a=(a+360)%360;b=Math.max(-90,Math.min(90,b));if(!this.$SphericalViewportControl42)return{x:a,y:b};var c=this.$SphericalViewportControl39.partialLeftDegrees,d=this.$SphericalViewportControl39.partialRightDegrees,e=this.$SphericalViewportControl41===0,f=this.$SphericalViewportControl40.partialLeftDegrees,g=this.$SphericalViewportControl40.partialRightDegrees,h=this.$SphericalViewportControl40.partialTopDegrees,i=this.$SphericalViewportControl40.partialBottomDegrees,j=this.getVerticalFieldOfView(),k=this.getHorizontalFieldOfView(),l=0,m=0;if(this.$SphericalViewportControl63)this.$SphericalViewportControl54&&(f!=null&&g!=null&&(l=Math.min(Math.abs((f+g)/2),this.$SphericalViewportControl49)),h!=null&&i!=null&&h>=-i&&(m=Math.min(Math.abs((h+i)/2),this.$SphericalViewportControl50))),(c!=null||!e)&&f!=null&&(f<0?a=Math.max(a>180?a:a+360,360-f-l)%360:a>180&&(a=Math.max(a,360-f-l))),(d!=null||!e)&&g!=null&&(g<0?a=Math.min(a<180?a+360:a,360+g+l)%360:a<180&&(a=Math.min(a,g+l))),h!=null&&(i!=null&&h<0&&-h>i?b=Math.min(b,-i):b=Math.min(b,h+m)),i!=null&&(h!=null&&i<0&&h<-i?b=Math.max(b,h):b=Math.max(b,-i-m));else{this.$SphericalViewportControl54&&(l=this.$SphericalViewportControl49,m=this.$SphericalViewportControl50);if(f!=null&&g!=null&&f+g<k){c=(g-f)/2;d=a>180?a-360:a;d<c?a=Math.max(d,c-l):a=Math.min(d,c+l)}else f!=null&&(a=a<=180?a:Math.max(a,360-f+k/2-l)),g!=null&&(a=a>=180?a:Math.min(a,g-k/2+l));if(h!=null&&i!=null&&h+i<j){e=(h-i)/2;b<e?b=Math.max(b,e-m):b=Math.min(b,e+m)}else h!=null&&(b=Math.min(b,h-j/2+m)),i!=null&&(b=Math.max(b,-i+j/2-m))}return{x:a,y:b}};d.setInitialOrientation=function(){var a=this.$SphericalViewportControl133(0,0),b=a.x;a=a.y;var c=!Number.isNaN(b+a)&&(b!==this.$SphericalViewportControl26.x||a!==this.$SphericalViewportControl26.y);c&&(this.$SphericalViewportControl26={x:b,y:a},this.emit("initialViewportChange",b,a),this.emit("viewportChange",b,a,this.$SphericalViewportControl11))};d.setSphericalOrientation=function(a,b){a===null&&(a=this.$SphericalViewportControl26.x);b===null&&(b=this.$SphericalViewportControl26.y);typeof a==="number"&&typeof b==="number"||i(0,4346);a=this.$SphericalViewportControl133(a,b);b=a.x;a=a.y;var c=!Number.isNaN(b+a)&&(b!==this.$SphericalViewportControl26.x||a!==this.$SphericalViewportControl26.y);c&&(this.$SphericalViewportControl26={x:b,y:a},this.emit("viewportChange",b,a,this.$SphericalViewportControl11))};d.setRelativeSphericalOrientation=function(a,b){this.setSphericalOrientation(a+this.$SphericalViewportControl28.x,b+this.$SphericalViewportControl28.y)};d.$SphericalViewportControl132=function(a,b){this.setSphericalOrientation(this.$SphericalViewportControl26.x+a,this.$SphericalViewportControl26.y+b)};d.$SphericalViewportControl92=function(a){if(this.$SphericalViewportControl63){var c=b("SphericalPhotoProjectionUtils").getMaxVfov(this.$SphericalViewportControl39,this.getAspectRatio());return Math.min(c,Math.max(this.$SphericalViewportControl51,a))}else{c=Math.min(b("calculateVFOVFromHFOV")(this.$SphericalViewportControl53,this.getAspectRatio()),this.$SphericalViewportControl52);if(this.$SphericalViewportControl42&&this.$SphericalViewportControl39){var d=this.$SphericalViewportControl39.partialTopDegrees||this.$SphericalViewportControl39.partialTopDegrees===0,e=this.$SphericalViewportControl39.partialBottomDegrees||this.$SphericalViewportControl39.partialBottomDegrees===0;if(d&&e){d=this.$SphericalViewportControl39.partialTopDegrees||0;e=this.$SphericalViewportControl39.partialBottomDegrees||0;c=Math.min(c,d+e)}}return Math.min(c,Math.max(this.$SphericalViewportControl51,a))}};d.setFieldOfView=function(a){var c=this.$SphericalViewportControl11;a=this.$SphericalViewportControl92(a);this.$SphericalViewportControl93(a);var d=this.$SphericalViewportControl40,e=d.partialTopDegrees,f=d.partialBottomDegrees,g=d.partialLeftDegrees;d=d.partialRightDegrees;var h=e||e===0,i=f||f===0,j=g||g===0,k=d||d===0,l=g||d;e=e||0;f=f||0;g=g||0;d=d||0;var m=!1,n=this.$SphericalViewportControl26.x,o=this.$SphericalViewportControl26.y;if(this.$SphericalViewportControl63){e=h?e:90;f=i?f:90;g=j?g:180;d=k?d:180;-o>f&&(f<0&&e<-f?o=e:o=-f,m=!0);o>e&&(e<0&&e<-f?o=-f:o=e,m=!0);j=((d-g)/2+180)%360;n>j&&360-n>g&&(n=360-g,m=!0);n<j&&n>d&&(n=d,m=!0)}else{k=b("calculateHFOVFromVFOV")(a,this.getAspectRatio());i&&a/2-o>f&&(o=a/2-f,m=!0);h&&o+a/2>e&&(o=e-a/2,m=!0);h&&i&&e+f<a&&(o=(e-f)/2,m=!0);if(l){j=((d-g)/2+180)%360;n>j&&k/2+360-n>g&&(n=360+k/2-g,m=!0);n<j&&n+k/2>d&&(n=d-k/2,m=!0);g+d<k&&(n=(d-g)/2%360,m=!0)}}!this.$SphericalViewportControl19&&!this.$SphericalViewportControl20&&m&&!Number.isNaN(n+o)&&(this.$SphericalViewportControl54?this.$SphericalViewportControl66||(this.$SphericalViewportControl66=b("requestAnimationFrame")(this.$SphericalViewportControl128)):this.$SphericalViewportControl26={x:n,y:o});if(!Number.isNaN(a)&&c!==a||m){this.$SphericalViewportControl11=a;this.emit("viewportChange",this.$SphericalViewportControl26.x,this.$SphericalViewportControl26.y,a);return!0}return!1};d.getVerticalFieldOfView=function(){return this.$SphericalViewportControl11};d.getAspectRatio=function(){return this.$SphericalViewportControl32&&this.$SphericalViewportControl34&&this.$SphericalViewportControl35?this.$SphericalViewportControl34/this.$SphericalViewportControl35:this.$SphericalViewportControl7};d.getHorizontalFieldOfView=function(){return b("calculateHFOVFromVFOV")(this.$SphericalViewportControl11,this.getAspectRatio())};d.setPreventScrollDefaultAction=function(a){this.$SphericalViewportControl38=a};d.setEnableZoom=function(a){this.$SphericalViewportControl46=a,a||this.setFieldOfView(this.$SphericalViewportControl12)};d.updateViewport=function(a,b,c){this.$SphericalViewportControl26={x:a,y:b},this.$SphericalViewportControl11=this.$SphericalViewportControl92(c),this.$SphericalViewportControl93()};d.isUpdating=function(){return this.$SphericalViewportControl15};d.$SphericalViewportControl129=function(){var a=this.$SphericalViewportControl16*(this.$SphericalViewportControl17.right-this.$SphericalViewportControl17.left),b=this.$SphericalViewportControl16*(this.$SphericalViewportControl17.up-this.$SphericalViewportControl17.down);this.$SphericalViewportControl8.updateVelocity(a,b)};d.$SphericalViewportControl125=function(a){a=b("Event").getKeyCode(a);var c=null;switch(a){case b("Keys").LEFT:case u.A:c="left";break;case b("Keys").UP:case u.W:c="up";break;case b("Keys").RIGHT:case u.D:c="right";break;case b("Keys").DOWN:case u.S:c="down";break}return c};d.$SphericalViewportControl117=function(){return this.$SphericalViewportControl11/this.$SphericalViewportControl35};d.$SphericalViewportControl73=function(){var a="grabbing";b("UserAgent").isEngine("WebKit")?a="-webkit-"+a:b("UserAgent").isEngine("Gecko")&&(a="-moz-"+a);return a};return c}(b("EventEmitter"));e.exports=a}),null);
__d("VideoComposerDialogBasicUtils",["Promise","ActorURI","AsyncRequest","EditorState","MentionsInputUtility","ReactComposerTaggerActions","ReactComposerTaggerStore","ReactComposerTaggerType","SearchableEntry","VideoComposerBasicActions","VideoComposerSphericalDirectorActions","VideoComposerTaggingUtils","XPagesVideoListsController","XVideoComposerBootloadDefaultTabController","XVideoComposerCrosspostBootloadDefaultController","XVideoComposerEditDefaultTabController","getMentionsInputDecorator","isEmpty"],(function(a,b,c,d,e,f){"use strict";var g;a=function(a,c){var d=b("XVideoComposerBootloadDefaultTabController").getURIBuilder().setFBID("target_id",c).setString("video_composer_id",a).getURI();d=b("ActorURI").create(d,c);d=[new(b("AsyncRequest"))(d).exec(),b("VideoComposerTaggingUtils").getSuggestedContentTags(c).then(function(c){b("VideoComposerBasicActions").updateHistoryTags(a,c.history),b("VideoComposerBasicActions").updateSuggestedTags(a,c.suggested)}),b("VideoComposerTaggingUtils").getBrowseTags(a).then(function(c){b("VideoComposerBasicActions").updateBrowseTags(a,c)}),i(c,a)];return b("Promise").all(d)};c=function(a,c){var d=b("XVideoComposerEditDefaultTabController").getURIBuilder().setFBID("video_id",c.videoID).setString("video_composer_id",a).getURI();d=b("ActorURI").create(d,c.common.actorID);d=[new(b("AsyncRequest"))(d).exec(),b("VideoComposerTaggingUtils").getSuggestedContentTags(c.common.actorID).then(function(c){b("VideoComposerBasicActions").updateHistoryTags(a,c.history),b("VideoComposerBasicActions").updateSuggestedTags(a,c.suggested)}),b("VideoComposerTaggingUtils").getBrowseTags(a).then(function(c){b("VideoComposerBasicActions").updateBrowseTags(a,c)})];return b("Promise").all(d)};d=function(a,c,d,e){d=b("XVideoComposerCrosspostBootloadDefaultController").getURIBuilder().setFBID("video_asset_id",d).setFBID("source_video_id",e).setString("video_composer_id",a).getURI();e=b("ActorURI").create(d,c);d=[new(b("AsyncRequest"))(e).exec(),b("VideoComposerTaggingUtils").getSuggestedContentTags(c).then(function(c){b("VideoComposerBasicActions").updateHistoryTags(a,c.history),b("VideoComposerBasicActions").updateSuggestedTags(a,c.suggested)}),b("VideoComposerTaggingUtils").getBrowseTags(a).then(function(c){b("VideoComposerBasicActions").updateBrowseTags(a,c)})];return b("Promise").all(d)};f=function(a,c){b("VideoComposerBasicActions").changeGame(a,c)};var h=function(a,c){return c&&!(g||(g=b("isEmpty")))(c)?a.concat(c.map(function(a){return new(b("SearchableEntry"))({uniqueID:a,title:a,auxiliaryData:{isFreeForm:!0}})})):a},i=function(a,c){var d=b("XPagesVideoListsController").getURIBuilder().setFBID("page_id",a).getURI();return new(b("Promise"))(function(a,e){new(b("AsyncRequest"))(d).setHandler(function(d){var e=d.payload.seasonOptions||{},f=d.payload.playlistOptions||{};b("VideoComposerBasicActions").updateVideoListOptions(c,f,e);a(d)}).setErrorHandler(function(a){e(a)}).send()})},j=function(a){return a.length<=0?[]:a.filter(function(a){return!a.getAuxiliaryData().isFreeForm}).map(function(a){return a.getUniqueID()})},k=function(a){var c={},d=b("ReactComposerTaggerStore").getTaggerData(a,b("ReactComposerTaggerType").PEOPLE)||[];d=d.map(function(a){return a.getUniqueID()});Object.assign(c,{tags:d});d=b("ReactComposerTaggerStore").getTaggerData(a,b("ReactComposerTaggerType").LOCATION)||{};d=d?d.place:{};var e=d?d.getUniqueID():null;d=d&&!d.getUniqueID()?d.getTitle():null;e?Object.assign(c,{place_id:e}):d?Object.assign(c,{place_name:d}):Object.assign(c,{place_id:0});e=b("ReactComposerTaggerStore").getTaggerData(a,b("ReactComposerTaggerType").BACKDATE);e.year&&Object.assign(c,{backtime_year:e.year});e.month&&Object.assign(c,{backtime_month:e.month});e.day&&Object.assign(c,{backtime_day:e.day});e.hour&&Object.assign(c,{backtime_hour:e.hour});e.minute&&Object.assign(c,{backtime_minute:e.minute});d=b("ReactComposerTaggerStore").getTaggerData(a,b("ReactComposerTaggerType").SPONSOR)||{};var f={directShareStatus:d.directShareStatus,sponsorRelationship:d.sponsorRelationship,sponsors:[]};(d.sponsors||[]).map(function(a){f.sponsors.push(a.getUniqueID())});f&&f.sponsors&&Object.assign(c,{sponsor_tags:f.sponsors,direct_share_status:f.directShareStatus,sponsor_relationship:f.sponsorRelationship});e=b("ReactComposerTaggerStore").getTaggerData(a,b("ReactComposerTaggerType").PRODUCT)||[];d=e.map(function(a){return a.getUniqueID()});d&&Object.assign(c,{product_tags:d});e=b("ReactComposerTaggerStore").getTaggerData(a,b("ReactComposerTaggerType").SUPPORT_NOW);e&&Object.assign(c,{has_support_now_cta:e.hasSupportNowCTA,fan_funding_promotion_payload:e.fanFundingPromotionPayload});Object.assign(c,{external_movie_data:b("ReactComposerTaggerStore").getTaggerData(a,b("ReactComposerTaggerType").GET_SHOWTIMES)});return c},l=function(a){a=b("MentionsInputUtility").createFromTextWithMentions(a,b("getMentionsInputDecorator")());b("EditorState").moveFocusToEnd(a);return a},m=function(a){return a.length<=0?[]:a.filter(function(a){return a.getAuxiliaryData().isFreeForm}).map(function(a){return a.getUniqueID()})},n=function(a,c,d,e,f,g,h,i){b("ReactComposerTaggerActions").setTaggerDataWithoutLogging(a,b("ReactComposerTaggerType").PEOPLE,c),d=d?new(b("SearchableEntry"))(d):null,d=d?{place:d,implicitLocation:{}}:null,d&&b("ReactComposerTaggerActions").setTaggerDataWithoutLogging(a,b("ReactComposerTaggerType").LOCATION,d),e&&b("ReactComposerTaggerActions").setTaggerDataWithoutLogging(a,b("ReactComposerTaggerType").BACKDATE,e),f&&b("ReactComposerTaggerActions").setTaggerDataWithoutLogging(a,b("ReactComposerTaggerType").SPONSOR,f),g&&b("ReactComposerTaggerActions").setTaggerDataWithoutLogging(a,b("ReactComposerTaggerType").PRODUCT,g),i&&b("ReactComposerTaggerActions").setTaggerDataWithoutLogging(a,b("ReactComposerTaggerType").SUPPORT_NOW,{hasSupportNowCTA:i})},o=function(a,c,d){for(var d=d,e=Array.isArray(d),f=0,d=e?d:d[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var g;if(e){if(f>=d.length)break;g=d[f++]}else{f=d.next();if(f.done)break;g=f.value}g=g;b("ReactComposerTaggerActions").setTaggerDataWithoutLogging(c,g,b("ReactComposerTaggerStore").getTaggerData(a,g))}};e.exports={beginBootloadingDefaultTab:a,beginBootloadingCrosspostDefaultTab:d,bootloadDefaultTab:function(a){b("VideoComposerBasicActions").bootloadDefaultTabParameters(a.videoComposerID,a),b("VideoComposerSphericalDirectorActions").bootloadSphericalContextConfig(a.videoComposerID,a.composerConfig.contextConfig)},bootloadCrosspostDefaultTab:function(a){b("VideoComposerBasicActions").bootloadCrosspostDefaultTabParameters(a.videoComposerID,a)},bootloadDefaultEditParams:function(a){b("VideoComposerBasicActions").bootloadDefaultEditParameters(a.videoComposerID,a)},changeGame:f,convertVideoTagsToEntryArray:h,beginBootloadingEditDefaultTab:c,fetchVideoListOptions:function(a,b){i(a,b)},getComposerTaggerData:k,getContentTagEntryIDs:j,getEditorStateForText:l,getFreeFormContentTags:m,setComposerTaggerData:n,setComposerTaggerDataFromOriginalComposer:o}}),null);
__d("VideoComposerDialogBasicVideoController",["SubscriptionsHandler","VideoComposerBasicActions"],(function(a,b,c,d,e,f){"use strict";a=function(){function a(){this.$1=new(b("SubscriptionsHandler"))()}var c=a.prototype;c.updateVPC=function(a,c){if(this.$2===c)return;this.$1.release();if(!c)return;this.$2=c;this.$1=new(b("SubscriptionsHandler"))();this.$1.addSubscriptions(c.addListener("playRequested",function(c){c==="user_initiated"&&b("VideoComposerBasicActions").userPlayedVideoPreview(a)}))};c.unmount=function(){this.$1.release(),this.$2=null};return a}();e.exports=new a()}),null);
__d("VideoComposerThumbnailTypes",["keyMirror"],(function(a,b,c,d,e,f){"use strict";a=b("keyMirror")({GENERATED:"",CUSTOM:"",VIDEO_FRAME:""});e.exports={ThumbnailSection:a}}),null);
__d("VideoComposerTrimmingTypes",["keyMirror"],(function(a,b,c,d,e,f){"use strict";a=b("keyMirror")({END_TIME:"",START_TIME:""});c=b("keyMirror")({ADBREAKS:"",CAPTION:"",POLLS:"",SOUND_OVERLAY:"",SPHERICAL_DIRECTOR:"",PREMIERE:""});e.exports={TimestampTypes:a,TrimmingDisableReasons:c}}),null);
__d("VideoComposerClippingTypes",["ImmutableRecordWithV4Types"],(function(a,b,c,d,e,f){"use strict";a=b("ImmutableRecordWithV4Types").Record;c=a({title:"",startTime:null,endTime:null});e.exports=c}),null);
__d("VideoComposerClippingStoreClass",["Promise","ImmutableRecordWithV4Types","VideoComposerActionTypes","VideoComposerClippingTypes","VideoComposerStoreBase","flattenPHPQueryData","immutable"],(function(a,b,c,d,e,f){"use strict";a=b("ImmutableRecordWithV4Types").Record;var g=a({videoComposerID:"",clipTimes:b("immutable").List(),selectedStartTime:null,selectedEndTime:null,isPlaying:!1,vpc:null});c=function(a){babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.getInitialState=function(){return g()};d.reduceImpl=function(a,c){switch(c.type){case b("VideoComposerActionTypes").RESET_COMPOSER:return this.getInitialState();case b("VideoComposerActionTypes").CLIPPING_SET_END_TIME:this.$VideoComposerClippingStoreClass1(a.vpc,c.endTime);return a.set("selectedEndTime",c.endTime);case b("VideoComposerActionTypes").CLIPPING_SET_PLAYER_STATE:return a.set("isPlaying",c.isPlaying);case b("VideoComposerActionTypes").CLIPPING_SET_START_TIME:this.$VideoComposerClippingStoreClass1(a.vpc,c.startTime);return a.set("selectedStartTime",c.startTime);case b("VideoComposerActionTypes").CLIPPING_SET_VPC:return a.set("vpc",c.vpc);case b("VideoComposerActionTypes").CLIPPING_PREVIEW_BY_START_END:return this.$VideoComposerClippingStoreClass2(c);case b("VideoComposerActionTypes").CLIPPING_ADD_CLIP:return this.$VideoComposerClippingStoreClass3();case b("VideoComposerActionTypes").CLIPPING_EDIT_CLIP:return this.$VideoComposerClippingStoreClass4(c.index,c.title);case b("VideoComposerActionTypes").CLIPPING_DELETE_CLIP:return this.$VideoComposerClippingStoreClass5(c.index);default:return a}};d.$VideoComposerClippingStoreClass1=function(a,b){a&&a.seek(b)};d.$VideoComposerClippingStoreClass3=function(){var a=b("VideoComposerClippingTypes")(),c=this.getState();a=a.set("startTime",c.get("selectedStartTime")||0).set("endTime",c.get("selectedEndTime")||0);c=c.set("clipTimes",c.get("clipTimes").push(a));return c};d.$VideoComposerClippingStoreClass4=function(a,c){var d=this.getState(),e=d.get("clipTimes"),f=e.get(a),g=b("VideoComposerClippingTypes")();g=g.set("startTime",f.startTime||0).set("endTime",f.endTime||0).set("title",c);e=e.set(a,g);d=d.set("clipTimes",e);return d};d.$VideoComposerClippingStoreClass5=function(a){var b=this.getState(),c=b.get("clipTimes");c=c["delete"](a);b=b.set("clipTimes",c);return b};d.$VideoComposerClippingStoreClass2=function(a){a=this.getState();var b=a.get("vpc");if(b){b.emit("previewByStartEndTime",{endTime:(b=a.get("selectedEndTime"))!=null?b:0,startTime:(b=a.get("selectedStartTime"))!=null?b:0})}a=a.set("isPlaying",!0);return a};d.getPostDataForEdit=function(){var a=this.getState();a=a.clipTimes;var c=[],d={};a.forEach(function(a){a={start_time:a.startTime,end_time:a.endTime,title:a.title};c.push(a)});d.clip_times=c;return b("Promise").resolve(b("flattenPHPQueryData")(d))};return c}(b("VideoComposerStoreBase"));e.exports=c}),null);
__d("VideoComposerSphericalDirectorStoreClass",["Promise","ImmutableRecordWithV4Types","SphericalDirectorAction","SphericalDirectorMetadataUtils","SphericalDirectorStore","VideoComposerActions","VideoComposerActionTypes","VideoComposerStoreBase","VideoSphericalMetadataReaderController","flattenPHPQueryData","promiseDone"],(function(a,b,c,d,e,f){"use strict";a=b("ImmutableRecordWithV4Types").Record;c={videoComposerID:"",bootloadedParams:null,contextConfig:null,metadata:null,omnistabEnabled:!1,showOmnistabSection:!1,spherical:!1};var g=a(c);d=function(a){babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.getInitialState=function(){return g()};d.reduceImpl=function(a,c){switch(c.type){case b("VideoComposerActionTypes").RESET_COMPOSER:a=this.$VideoComposerSphericalDirectorStoreClass1(a);return a;case b("VideoComposerActionTypes").BOOTLOAD_SPHERICAL_DIRECTOR_CROSSPOST_PARAMETERS:a=this.$VideoComposerSphericalDirectorStoreClass2(a,c.data);return a;case b("VideoComposerActionTypes").BOOTLOAD_SPHERICAL_DIRECTOR_EDIT_PARAMETERS:var d=c.data,e=d.showOmnistabSection,f=d.hasOmnistabEncoding,g=d.omnistabEnabled;d=babelHelpers.objectWithoutPropertiesLoose(d,["showOmnistabSection","hasOmnistabEncoding","omnistabEnabled"]);a=a.set("omnistabEnabled",g);a=a.set("showOmnistabSection",e&&f);a=this.$VideoComposerSphericalDirectorStoreClass2(a,d);return a;case b("VideoComposerActionTypes").BOOTLOAD_SPHERICAL_DIRECTOR_UPLOAD_PARAMETERS:a=a.set("showOmnistabSection",c.data.showOmnistabSection);return a;case b("VideoComposerActionTypes").BOOTLOAD_CROSSPOST_DEFAULT_TAB:a=this.$VideoComposerSphericalDirectorStoreClass3(a,c.data.composerConfig.contextConfig);return a;case b("VideoComposerActionTypes").BOOTLOAD_DEFAULT_EDIT_PARAMS:a=this.$VideoComposerSphericalDirectorStoreClass3(a,c.data.composerConfig.contextConfig);return a;case b("VideoComposerActionTypes").BOOTLOAD_SPHERICAL_CONTEXT_CONFIG:a=this.$VideoComposerSphericalDirectorStoreClass4(a,c.data);return a;case b("VideoComposerActionTypes").METADATA_LOADED_FROM_VIDEO_UPLOADER:a=this.$VideoComposerSphericalDirectorStoreClass5(a,c.data);return a;case b("VideoComposerActionTypes").TOGGLE_SPHERICAL:a=a.set("spherical",c.data);return a;default:return a}};d.$VideoComposerSphericalDirectorStoreClass3=function(a,b){a=a.set("contextConfig",b);var c=this.getState().get("bootloadedParams");c&&(a=this.$VideoComposerSphericalDirectorStoreClass6(a,b.composerID,c));return a};d.$VideoComposerSphericalDirectorStoreClass4=function(a,b){a=a.set("contextConfig",b);var c=this.getState().get("metadata");c&&(a=this.$VideoComposerSphericalDirectorStoreClass7(a,b.composerID,c));return a};d.$VideoComposerSphericalDirectorStoreClass2=function(a,b){a=a.set("bootloadedParams",b);var c=this.getState().get("contextConfig");c&&(a=this.$VideoComposerSphericalDirectorStoreClass6(a,c.composerID,b));return a};d.$VideoComposerSphericalDirectorStoreClass5=function(a,b){a=a.set("metadata",b);var c=this.getState().get("contextConfig");c&&(a=this.$VideoComposerSphericalDirectorStoreClass7(a,c.composerID,b));return a};d.$VideoComposerSphericalDirectorStoreClass1=function(a){var c=this.getState().get("contextConfig");c&&b("SphericalDirectorAction").clearSphericalDirector();a=this.getInitialState();return a};d.$VideoComposerSphericalDirectorStoreClass6=function(a,c,d){c=this.getState().get("omnistabEnabled");b("SphericalDirectorMetadataUtils").initWithParams(d.initialHeading,d.initialPitch,d.fov,d.guideEnabled,d.guideKeyframes,d.projection,d.stereoMode,d.hasSpatialAudio,c);return a};d.$VideoComposerSphericalDirectorStoreClass7=function(a,c,d){if(d&&d.format){c=d.format.isSpherical;a=a.set("spherical",c);if(c){c=b("VideoSphericalMetadataReaderController").objectToRawSphericalMetadata(d);b("promiseDone")(new(b("VideoSphericalMetadataReaderController"))({sourceType:"metadata",metadata:c}).getFileMetadata().then(function(c){b("SphericalDirectorMetadataUtils").initWithOriginalSphericalMetadata(c),b("VideoComposerActions").sphericalMetadataParsed(a.videoComposerID,c)}))}}return a};d.getEditAndCrosspostRequestData=function(a){var c=this.getState().get("contextConfig"),d=this.getState().get("spherical");if(!c||!d)return b("Promise").resolve({});c=b("SphericalDirectorStore").getPostData();var e={};e.spherical=d;e.initial_heading=c.initialHeading;e.initial_pitch=c.initialPitch;e.fov=c.fov;e.guide_enabled=!!c.guide_enabled;e.enable_omnistab=!!c.enable_omnistab;var f;a?f=b("flattenPHPQueryData")({guide_keyframes:c.guide_keyframes}):f=b("flattenPHPQueryData")({guide:c.guide_keyframes});Object.keys(f).forEach(function(a){e[a]=f[a]});return b("Promise").resolve(e)};d.getPostRequestDataToSend=function(){var a=this.getState().get("contextConfig");if(!a)return b("Promise").resolve({});a=["enable_omnistab","guide_enabled","guide_keyframes","fov","initialHeading","initialPitch","projection","spherical","stereoMode"];var c=Object.assign({},b("SphericalDirectorStore").getPostData());c.spherical=this.getState().get("spherical");a=a.reduce(function(a,b){b in c&&(a[b]=c[b]);return a},{});return b("Promise").resolve(a)};d.getSpherical=function(){return this.getState().spherical};return c}(b("VideoComposerStoreBase"));e.exports=d}),null);
__d("VideoCaptionDeletionCache",["immutable"],(function(a,b,c,d,e,f){a=function(){"use strict";function a(){this.cache=b("immutable").Map()}var c=a.prototype;c.add=function(a){this.cache=this.cache.set(a.id,a)};c.remove=function(a){this.cache=this.cache["delete"](a)};c.has=function(a){return this.cache.get(a)!==void 0};return a}();e.exports=a}),null);
__d("VideoComposerCaptionEditorActionTypes",["keyMirror"],(function(a,b,c,d,e,f){"use strict";a=b("keyMirror")({ADD_CAPTION_ENTRY:"",REMOVE_CAPTION_ENTRY:"",EDIT_CAPTION_ENTRY:"",SET_PREVIEW_ENTRY:"",SET_EDITOR_LANGUAGE:"",SET_EDITOR_LOCALE:"",SET_CAPTIONS:"",SET_NEXT_ENTRY:"",PLAY_PREVIEW_ENTRY:"",CONFIRM_CLOSE_DIALOG:"",CANCEL_CLOSE_DIALOG:"",SHOW_EXIT_DIALOG:"",START_SAVE_CAPTION_CHANGESET:"",FINISH_SAVE_CAPTION_CHANGESET:"",INITIALIZE_EDITOR_LANGUAGE:"",RESET_CAPTION_EDITOR:""});e.exports=a}),null);
__d("VideoComposerCaptionsTabActionTypes",["immutable","keyMirror"],(function(a,b,c,d,e,f){"use strict";a=b("keyMirror")({SHOW_CAPTION_EDITOR:"",HIDE_CAPTION_EDITOR:"",INITIALIZE_CAPTION_LANDING_SCREEN:"",GENERATE:"",CANCEL_GENERATE:"",CREATE:"",EDIT_CAPTIONS_DRAFT:"",DELETE_CAPTIONS_DRAFT:"",START_SRT_UPLOAD:"",FINISH_SRT_UPLOAD:"",GENERATE_COMPLETE:"",CREATE_COMPLETE:"",SELECT_SPOKEN_LANGUAGE:"",SELECT_SPOKEN_LOCALE:"",FINISHED_FETCH_DRAFTS:"",GENERATE_PROGRESS_UPDATE:"",UPDATE_CAPTION_FILES:"",UPDATE_ERROR_STATE:"",SET_AUTO_GENERATED_CAPTIONS:"",RESET_CAPTIONS_LANDING_TAB:"",RETRY_AUTO_GENERATION:"",RESUME_AUTO_GENERATION:"",RESET_AUTO_GENERATING_LOCALE:"",TRY_RESUME_AUTO_GENERATION:"",INITIALIZE_ALL_CAPTION_FILES:"",BOOTLOAD_PARAMETERS_CAPTIONS_TAB:"",CHANGE_PUBLISHED_STATE:"",PENDING_TO_PUBLISHED:"",CAPTION_LANDING_SCREEN_OPEN_EVENT:"",OLD_COMPOSER_CAPTION_TAB_OPEN_EVENT:"",RESET_OPEN_LANDING_SCREEN_STATE:""});e.exports=a}),null);
__d("VideoComposerCaptionsStoreClass",["fbt","Promise","ActorURI","AsyncRequest","ComposerVideoUploadActions","EntVideoCaptionsErrorTypes","ImmutableRecordWithV4Types","InsightsLocaleNamesStatic","SkywalkerManager","VideoCaptionDeletionCache","VideoCaptionsPublishTypedLogger","VideoComposerActionTypes","VideoComposerCaptionEditorActionTypes","VideoComposerCaptionsTabActions","VideoComposerCaptionsTabActionTypes","VideoComposerDialogCaptionEditorConstants","VideoComposerDialogCaptionEditorPublishStateEnum","VideoComposerDialogCaptionEditorUtils","VideoComposerDispatchers","VideoComposerStoreBase","VideoComposerStores","XVideoCaptionGenerateAsyncController","XVideoCaptionSpeechDetectionAsyncController","XVideoCaptionUploadAsyncController","clearInterval","immutable","nullthrows","promiseDone","setInterval","setTimeout","videoComposerDialogUploadCreateVideoData"],(function(a,b,c,d,e,f,g){"use strict";a=b("ImmutableRecordWithV4Types").Record;var h=b("InsightsLocaleNamesStatic"),i=a({videoComposerID:"",accessToken:null,autoGenerateCanceling:!1,autoGenerateCanceled:!1,drafts:(c=b("immutable")).List(),draftsFetched:!1,isSpokenLanguageSelected:!1,publishedStateChangeset:c.Map(),deletionCache:new(b("VideoCaptionDeletionCache"))(),selectedCaption:null,show_caption_editor:!1,videoFile:null,video_id:null,videoData:null,isAutoGenerating:!1,shouldAutopublishCaptions:!1,showAutopublishCaptionsFeature:!1,isCreating:!1,subtitleForDeletion:null,spokenLanguage:(d=b("VideoComposerDialogCaptionEditorConstants")).NO_LANGUAGE_SELECTED,autoGeneratingLocale:null,autoGeneratingLanguage:null,spokenLocale:d.INITIAL_SPOKEN_LOCALE,progress:0,autoGenProcessRate:d.DEFAULT_PROCESSING_SPEED,generateStarted:0,composerID:"",pageID:"",serverCaptionLocales:c.Seq(),captionFiles:c.Map(),captionURLs:c.List(),composerMode:null,isOldComposer:!1,isSRTUploading:!1,videoDurationInSec:0,errors:c.List(),partialUploadError:!1,numAutoGenerationRetries:0,wasOldComposerCaptionTabClicked:!1,timeFirstInitialized:null,captionsFeaturesMode:"advanced_features_with_subtitles",isDefaultLangugeSectionEnabled:!0,isNewCaptionsTabTextAndLayoutEnabled:!1,shouldShowNuxPill:!1,enableAddCaptionWhenUploading:!1,autogeneratableHeadLocales:d.AUTO_GENERATABLE_HEAD_LOCALES,enableNullStateForCaptionsAdded:!1,showEditAndReviewButton:!1,fakeAutogenerateProgressRate:0,hideLanguageSelectorForAutocaption:!1,autoGenV1Subtitle:null,localCaptionFiles:c.List(),captionURLsForEdit:c.List(),hasAutoGenV1:!1,captionLocalesWithoutSubtitles:c.List(),localesWithoutSubtitlesToDelete:c.List(),shouldTrimCaptions:!1,enableAutogenerateRetry:!1}),j=5*1e3,k=50,l=1e3,m=15*1e3;f=function(a){babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.getInitialState=function(){return i()};d.getIsEditMode=function(){return this.getState().get("composerMode")==="video_edit"};d.getIsCrosspostMode=function(){return this.getState().get("composerMode")==="video_crosspost"};d.shouldEnableOldDataModel=function(){return this.getState().get("captionsFeaturesMode")==="old_data_model"};d.getIsDefaultLangugeSectionEnabled=function(){return this.getState().get("isDefaultLangugeSectionEnabled")};d.getIsNewCaptionsTabTextAndLayoutEnabled=function(){return this.getState().get("isNewCaptionsTabTextAndLayoutEnabled")};d.getShouldShowNuxPill=function(){return this.getState().get("shouldShowNuxPill")};d.getEnableAddCaptionWhenUploading=function(){return this.getState().get("enableAddCaptionWhenUploading")};d.getHideLanguageSelectorForAutocaption=function(){return this.getState().get("hideLanguageSelectorForAutocaption")};d.getAutogeneratableHeadLocales=function(){return this.getState().get("autogeneratableHeadLocales")};d.getAllCaptions=function(){var a=this.getState().get("drafts"),b=this.getState().get("captionURLs"),c=this.getState().get("localCaptionFiles");return a.concat(b).concat(c)};d.getCaptionLocalesWithoutSubtitles=function(){return this.getState().get("captionLocalesWithoutSubtitles")};d.getSpokenLanguage=function(){return this.getState().get("spokenLanguage")};d.getSpokenLocale=function(){return this.getState().get("spokenLocale")};d.getAutoGeneratingLocale=function(){return this.getState().get("autoGeneratingLocale")};d.isSpokenLanguageSelected=function(){return this.getState().get("isSpokenLanguageSelected")};d.getShowAutopublishCaptionsFeature=function(){return this.getState().get("showAutopublishCaptionsFeature")};d.getShouldAutopublishCaptions=function(){return this.getState().get("shouldAutopublishCaptions")};d.getLogger=function(){var a=this.getState(),c=this.getIsEditMode()===!0?"post-publish":"pre-publish";return new(b("VideoCaptionsPublishTypedLogger"))().setVideoID(a.get("video_id")).setVideoLanguage(a.get("spokenLanguage")).setVideoLocale(a.get("spokenLocale")).setPublishPhase(c)};d.getEnableAdvancedCaptionsFeatures=function(){return this.getState().get("captionsFeaturesMode")==="advanced_features_with_subtitles"};d.getpublishedStateChangeset=function(){return this.getState().get("publishedStateChangeset")};d.wasTabOpenedInOldComposer=function(){var a=this.getState();return a.get("isOldComposer")&&a.get("wasOldComposerCaptionTabClicked")};d.logComposerSaveEvent=function(){var a=this.getState();if(a.get("timeFirstInitialized")===null||a.get("video_id")===null||a.get("video_id")==="")return;var c=a.get("drafts");a=b("VideoComposerDialogCaptionEditorUtils").getPublishedCaptionFiles(a.get("captionFiles"),c||b("immutable").List());this.$VideoComposerCaptionsStoreClass1(a)};d.$VideoComposerCaptionsStoreClass1=function(a){var c=this.getState(),d=c.get("drafts");this.$VideoComposerCaptionsStoreClass2("composer_save",{session_id:c.get("timeFirstInitialized"),num_captions:String(d.size),num_published_captions:String(a.size)});b("setTimeout")(function(){return b("VideoComposerCaptionsTabActions").resetOpenLandingScreenState(c.videoComposerID)},0)};d.$VideoComposerCaptionsStoreClass3=function(a,c){var d=!0;switch(a.type){case b("VideoComposerCaptionsTabActionTypes").SHOW_CAPTION_EDITOR:case b("VideoComposerCaptionsTabActionTypes").CREATE:case b("VideoComposerCaptionsTabActionTypes").EDIT_CAPTIONS_DRAFT:case b("VideoComposerCaptionsTabActionTypes").SELECT_SPOKEN_LANGUAGE:case b("VideoComposerCaptionsTabActionTypes").SELECT_SPOKEN_LOCALE:case b("VideoComposerCaptionsTabActionTypes").DELETE_CAPTIONS_DRAFT:return!0;case b("VideoComposerCaptionsTabActionTypes").START_SRT_UPLOAD:case b("VideoComposerActionTypes").UPLOAD_LOCAL_CAPTIONS:return!a.partialUploadError;case b("VideoComposerCaptionsTabActionTypes").FINISH_SRT_UPLOAD:return!this.getState().get("partialUploadError");case b("VideoComposerCaptionsTabActionTypes").GENERATE:d=!0;if(c.size>0){var e=b("VideoComposerDialogCaptionEditorUtils").getCaptionErrorMessage("auto_generate_fail_retry");c.forEach(function(a){if(a.toString().localeCompare(e.toString())===0){d=!1;return}})}return d;case b("VideoComposerCaptionsTabActionTypes").GENERATE_COMPLETE:d=!1;if(c.size>0){var f=b("VideoComposerDialogCaptionEditorUtils").getCaptionErrorMessage("auto_generate_fail_retry");c.forEach(function(a){if(a.toString().localeCompare(f.toString())===0){d=!0;return}})}return d}return!1};d.reduceImpl=function(a,c){var d=this,e=null,f=null,g=null;this.$VideoComposerCaptionsStoreClass3(c,a.get("errors"))&&a.get("errors").size>0&&(a=a.set("errors",b("immutable").List()));switch(c.type){case b("VideoComposerActionTypes").RESET_COMPOSER:a=this.getInitialState();return a;case b("VideoComposerCaptionsTabActionTypes").RESET_CAPTIONS_LANDING_TAB:a=this.getInitialState().set("videoComposerID",a.get("videoComposerID")).set("captionsFeaturesMode",a.get("captionsFeaturesMode")).set("captionURLs",a.get("captionURLs")).set("captionURLsForEdit",a.get("captionURLsForEdit")).set("localCaptionFiles",a.get("localCaptionFiles")).set("hasAutoGenV1",a.get("hasAutoGenV1")).set("isDefaultLangugeSectionEnabled",a.get("isDefaultLangugeSectionEnabled")).set("isNewCaptionsTabTextAndLayoutEnabled",a.get("isNewCaptionsTabTextAndLayoutEnabled")).set("shouldShowNuxPill",a.get("shouldShowNuxPill")).set("enableAddCaptionWhenUploading",a.get("enableAddCaptionWhenUploading")).set("autogeneratableHeadLocales",a.get("autogeneratableHeadLocales")).set("enableNullStateForCaptionsAdded",a.get("enableNullStateForCaptionsAdded")).set("showEditAndReviewButton",a.get("showEditAndReviewButton")).set("fakeAutogenerateProgressRate",a.get("fakeAutogenerateProgressRate")).set("hideLanguageSelectorForAutocaption",a.get("hideLanguageSelectorForAutocaption")).set("shouldAutopublishCaptions",a.get("shouldAutopublishCaptions")).set("showAutopublishCaptionsFeature",a.get("showAutopublishCaptionsFeature"));return a;case b("VideoComposerCaptionsTabActionTypes").SHOW_CAPTION_EDITOR:a=a.set("show_caption_editor",!0);return a;case b("VideoComposerCaptionEditorActionTypes").CONFIRM_CLOSE_DIALOG:a=a.set("show_caption_editor",!1);a=this.$VideoComposerCaptionsStoreClass4(a);return a;case b("VideoComposerCaptionEditorActionTypes").FINISH_SAVE_CAPTION_CHANGESET:return this.$VideoComposerCaptionsStoreClass5(a);case b("VideoComposerCaptionsTabActionTypes").OLD_COMPOSER_CAPTION_TAB_OPEN_EVENT:return a.set("wasOldComposerCaptionTabClicked",!0);case b("VideoComposerCaptionsTabActionTypes").CAPTION_LANDING_SCREEN_OPEN_EVENT:var i=a.get("video_id");i=a.get("timeFirstInitialized")===null&&i!==null&&i!=="";if(!i)return a;i=String(Date.now());this.$VideoComposerCaptionsStoreClass2("caption_tab_opened",{session_id:i});return a.set("timeFirstInitialized",i);case b("VideoComposerCaptionsTabActionTypes").RESET_OPEN_LANDING_SCREEN_STATE:return a.set("isOldComposer",!1).set("wasOldComposerCaptionTabClicked",!1).set("timeFirstInitialized",null);case b("VideoComposerCaptionsTabActionTypes").INITIALIZE_CAPTION_LANDING_SCREEN:i=c.isOldComposer?c.isOldComposer:!1;var j=c.dialogMode?c.dialogMode:"video_upload";return this.initialize(a,c.videoFile,c.video_id,c.accessToken,c.composerID,c.pageID,c.videoDurationInSec,j,i);case b("VideoComposerCaptionsTabActionTypes").TRY_RESUME_AUTO_GENERATION:j=a.get("autoGeneratingLocale");i=j!==null?b("VideoComposerDialogCaptionEditorUtils").getHeadLocale(b("nullthrows")(j)):null;j=a.get("video_id");j&&this.$VideoComposerCaptionsStoreClass6(j,i);return a;case b("VideoComposerCaptionsTabActionTypes").FINISHED_FETCH_DRAFTS:g=b("VideoComposerDialogCaptionEditorUtils").updateToChangesetValues(c.drafts,a.get("publishedStateChangeset"));g=b("VideoComposerDialogCaptionEditorUtils").filterOutDeletions(g,a.get("deletionCache"));if(a.autoGenerateCanceling){g=b("VideoComposerDialogCaptionEditorUtils").filterOutAutoGeneratedCaptions(c.drafts);j=b("immutable").Set(c.drafts).subtract(g);j.size>0&&(a=a.set("autoGenerateCanceling",!1));j.forEach(function(c){b("VideoComposerDialogCaptionEditorUtils").silentlyDeleteSubtitle(a.get("video_id"),c,a.get("pageID"))})}return a.set("drafts",g).set("draftsFetched",!0).set("captionLocalesWithoutSubtitles",c.captionLocalesWithoutSubtitles);case b("VideoComposerCaptionsTabActionTypes").RESET_AUTO_GENERATING_LOCALE:return a.set("autoGeneratingLocale",null).set("autoGeneratingLanguage",null);case b("VideoComposerCaptionsTabActionTypes").GENERATE:i=a.get("video_id");if(i){a=a.set("autoGenerateCanceling",!1).set("isAutoGenerating",!0).set("progress",0).set("generateStarted",Date.now()).set("autoGeneratingLocale",a.get("spokenLocale")).set("autoGeneratingLanguage",a.get("spokenLanguage"));j=this.$VideoComposerCaptionsStoreClass7(i,a.get("spokenLanguage"),a.get("spokenLocale"));j!==null&&j!==void 0&&(a=a.set("errors",b("immutable").List([b("VideoComposerDialogCaptionEditorUtils").getCaptionErrorMessage(j,a.get("spokenLanguage"))])).set("isAutoGenerating",!1).set("autoGeneratingLocale",null).set("autoGeneratingLanguage",null))}return a;case b("VideoComposerActionTypes").CAPTION_HAS_TRIMMED:return a.set("shouldTrimCaptions",!1);case b("VideoComposerCaptionsTabActionTypes").CREATE:i=a.get("video_id");i&&(a=a.set("isCreating",!0),a=a.set("shouldTrimCaptions",b("VideoComposerStores").getTrimmingEditorStore(a.videoComposerID).isVideoTrimmed()),a=a.set("selectedCaption",null).set("show_caption_editor",!0),this.$VideoComposerCaptionsStoreClass8(i));return a;case b("VideoComposerCaptionsTabActionTypes").GENERATE_COMPLETE:j=a.get("spokenLanguage");f=b("VideoComposerDialogCaptionEditorUtils").makeNewCaptionFile(c.captions,c.locale,j,!0);i=f!==null&&j!==""&&c.subtitlesID!==null;i&&(a=this.$VideoComposerCaptionsStoreClass9(a,String(c.subtitlesID)),a=this.$VideoComposerCaptionsStoreClass10(a,b("nullthrows")(f),c.locale),a=a.set("numAutoGenerationRetries",0));a=a.set("isAutoGenerating",!1).set("autoGenProcessRate",b("VideoComposerDialogCaptionEditorConstants").DEFAULT_PROCESSING_SPEED).set("progress",0).set("autoGeneratingLocale",null).set("autoGeneratingLanguage",null);return a;case b("VideoComposerCaptionsTabActionTypes").CREATE_COMPLETE:a=a.set("isCreating",!1);return a;case b("VideoComposerCaptionsTabActionTypes").GENERATE_PROGRESS_UPDATE:a=this.$VideoComposerCaptionsStoreClass11(a,c.progress);return a;case b("VideoComposerCaptionsTabActionTypes").EDIT_CAPTIONS_DRAFT:a=a.set("show_caption_editor",!0);j=a.get("drafts").get(c.id);a=a.set("selectedCaption",j);this.$VideoComposerCaptionsStoreClass2("caption_draft_edited",{},null,j.id);return a;case b("VideoComposerCaptionsTabActionTypes").DELETE_CAPTIONS_DRAFT:g=a.get("drafts");e=g.get(c.id);i=a.get("video_id");i&&b("VideoComposerDialogCaptionEditorUtils").deleteSubtitles(a.videoComposerID,i,e,a.get("pageID"),a.get("deletionCache"),this.$VideoComposerCaptionsStoreClass12.bind(this));e.language!==b("VideoComposerDialogCaptionEditorConstants").EMPTY_LOCALE&&(a=a.set("subtitleForDeletion",e));return a;case b("VideoComposerActionTypes").DELETE_SUBTITLES_FAILURE:return a.set("subtitleForDeletion",null);case b("VideoComposerActionTypes").DELETE_SUBTITLES_SUCCESS:var k=a.get("subtitleForDeletion");if(!k)return a;j=a.get("drafts");a.get("deletionCache").add(k);j=b("VideoComposerDialogCaptionEditorUtils").filterOutDeletions(j.filter(function(a){return!k||a.id!==k.id}),a.get("deletionCache"));i=a.get("captionFiles");var l=b("VideoComposerDialogCaptionEditorUtils").getHeadLocale(k.locale);i=i["delete"](l!==""?l:k.locale);l=a.get("composerID");if(l){var m=b("VideoComposerDialogCaptionEditorUtils").getPublishedCaptionFiles(i,j);b("ComposerVideoUploadActions").updateCaptions(l,Array.from(m.values()))}this.$VideoComposerCaptionsStoreClass2("caption_draft_deleted",{},null,k.id);return a.set("drafts",j).set("subtitleForDeletion",null).set("captionFiles",i).set("publishedStateChangeset",a.get("publishedStateChangeset")["delete"](k.id));case b("VideoComposerCaptionsTabActionTypes").SELECT_SPOKEN_LANGUAGE:this.$VideoComposerCaptionsStoreClass2("video_language_selected");a=a.set("spokenLanguage",c.language).set("isSpokenLanguageSelected",!0);return a;case b("VideoComposerCaptionsTabActionTypes").SELECT_SPOKEN_LOCALE:a=a.set("spokenLocale",c.locale);return a;case b("VideoComposerCaptionsTabActionTypes").CANCEL_GENERATE:var n=a.autoGeneratingLanguage,o=a.video_id;if(!n||!o)return a;b("setTimeout")(function(){return b("VideoComposerDialogCaptionEditorUtils").fetchCaptions(o,function(a){d.$VideoComposerCaptionsStoreClass13(a,o,n)})},b("VideoComposerDialogCaptionEditorConstants").AUTO_GENERATION_CANCEL_FETCH);a=a.set("autoGenerateCanceling",!0);a=a.set("autoGenerateCanceled",!0);a=a.set("isAutoGenerating",!1);this.$VideoComposerCaptionsStoreClass2("caption_generate_cancel");return a;case b("VideoComposerCaptionsTabActionTypes").START_SRT_UPLOAD:a=a.set("isSRTUploading",!0);a=a.set("partialUploadError",c.partialUploadError);l=a.get("video_id");m=a.get("accessToken");l&&m&&this.$VideoComposerCaptionsStoreClass14(l,c.captions,m);return a;case b("VideoComposerActionTypes").FETCHED_AUTO_GEN_V1_SUBTITLE:a=a.set("autoGenV1Subtitle",c.autoGenV1Subtitle);return a;case b("VideoComposerActionTypes").UPLOAD_LOCAL_CAPTIONS:a=a.set("localCaptionFiles",a.get("localCaptionFiles").concat(c.captions));a=a.set("partialUploadError",c.partialUploadError);return a;case b("VideoComposerActionTypes").UPDATE_ALL_LOCAL_CAPTIONS:a=a.set("localCaptionFiles",b("immutable").List(c.captions));return a;case b("VideoComposerCaptionsTabActionTypes").FINISH_SRT_UPLOAD:a=a.set("isSRTUploading",!1);this.$VideoComposerCaptionsStoreClass2("caption_upload_complete",{},c.error?c.error.toString():"");(!c.success||c.error)&&(a=a.set("errors",a.errors.push(c.error||"")));j=c.uploadedVideoSubtitles.size>0;if(!j)return a;c.uploadedVideoSubtitles.forEach(function(c,e){a=d.$VideoComposerCaptionsStoreClass9(a,c.subtitlesID),f=b("VideoComposerDialogCaptionEditorUtils").makeNewCaptionFile(b("immutable").List(c.captions),e,h[e],!1),f&&(a=d.$VideoComposerCaptionsStoreClass10(a,f,e))});return a;case b("VideoComposerCaptionsTabActionTypes").UPDATE_CAPTION_FILES:f=b("VideoComposerStores").getCaptionEditorStore(a.videoComposerID).getState().get("captionFile");i=b("VideoComposerStores").getCaptionEditorStore(a.videoComposerID).getState().get("locale");l=i!==b("VideoComposerDialogCaptionEditorConstants").EMPTY_LOCALE&&i!==b("VideoComposerDialogCaptionEditorConstants").INITIAL_SPOKEN_LOCALE;l&&(a=this.$VideoComposerCaptionsStoreClass9(a,b("VideoComposerStores").getCaptionEditorStore(a.videoComposerID).getState().get("captionID")));m=f!==null;if(m&&l)return this.$VideoComposerCaptionsStoreClass10(a,f,i);return l?this.$VideoComposerCaptionsStoreClass15(a,i):a;case b("VideoComposerCaptionsTabActionTypes").UPDATE_ERROR_STATE:a=a.set("errors",c.errors).set("show_caption_editor",!1);return a;case b("VideoComposerCaptionsTabActionTypes").RETRY_AUTO_GENERATION:j=b("VideoComposerDialogCaptionEditorUtils").getCaptionErrorMessage("auto_generate_fail_retry");a=a.set("isAutoGenerating",!1).set("autoGenProcessRate",b("VideoComposerDialogCaptionEditorConstants").DEFAULT_PROCESSING_SPEED).set("progress",0).set("numAutoGenerationRetries",a.get("numAutoGenerationRetries")+1).set("errors",b("immutable").List([j]));this.$VideoComposerCaptionsStoreClass2("caption_generate_retry",{},j.toString());b("setTimeout")(function(){return b("VideoComposerCaptionsTabActions").generate(a.videoComposerID)},b("VideoComposerDialogCaptionEditorConstants").POLL_FAKE_FREQUENCY_GENERATE_MS);return a;case b("VideoComposerCaptionsTabActionTypes").RESUME_AUTO_GENERATION:m=a.get("video_id");l=a.get("autoGeneratingLanguage");m&&l&&(this.$VideoComposerCaptionsStoreClass16(m),this.$VideoComposerCaptionsStoreClass17(m,l),this.$VideoComposerCaptionsStoreClass18());return a;case b("VideoComposerCaptionsTabActionTypes").INITIALIZE_ALL_CAPTION_FILES:a=a.set("serverCaptionLocales",c.subtitles.keySeq());c.subtitles.forEach(function(c,e){if(c.locale===b("VideoComposerDialogCaptionEditorConstants").EMPTY_LOCALE)return;f=b("VideoComposerDialogCaptionEditorUtils").makeNewCaptionFile(b("immutable").List(c.captions),e,h[e],c.creationMethod===b("VideoComposerDialogCaptionEditorConstants").AUTO_GENERATED);f&&(a=d.$VideoComposerCaptionsStoreClass10(a,f,e))});return a;case b("VideoComposerCaptionsTabActionTypes").BOOTLOAD_PARAMETERS_CAPTIONS_TAB:a=a.set("captionsFeaturesMode",c.data.captionsFeaturesMode).set("isDefaultLangugeSectionEnabled",c.data.enableCaptionsDefaultLanguageSection!=null?c.data.enableCaptionsDefaultLanguageSection:!0).set("isNewCaptionsTabTextAndLayoutEnabled",c.data.enableNewCaptionsTabTextAndLayout===!0).set("shouldShowNuxPill",c.data.shouldShowNuxPill===!0).set("enableAddCaptionWhenUploading",c.data.enableAddCaptionWhenUploading===!0).set("autogeneratableHeadLocales",c.data.autogeneratableHeadLocales!=null?b("immutable").Set(c.data.autogeneratableHeadLocales):b("VideoComposerDialogCaptionEditorConstants").AUTO_GENERATABLE_HEAD_LOCALES).set("showAutopublishCaptionsFeature",c.data.showAutopublishCaptionsFeature===!0).set("shouldAutopublishCaptions",c.data.shouldAutopublishCaptions===!0).set("enableNullStateForCaptionsAdded",c.data.enableNullStateForCaptionsAdded===!0).set("showEditAndReviewButton",c.data.showEditAndReviewButton===!0).set("fakeAutogenerateProgressRate",c.data.fakeAutogenerateProgressRate!=null?c.data.fakeAutogenerateProgressRate:0).set("hideLanguageSelectorForAutocaption",c.data.hideLanguageSelectorForAutocaption===!0).set("enableAutogenerateRetry",c.data.enableAutogenerateRetry);return a;case b("VideoComposerCaptionsTabActionTypes").CHANGE_PUBLISHED_STATE:g=a.get("drafts");e=g.get(c.id);i=e.publishedState;j=b("VideoComposerDialogCaptionEditorUtils").getUpdatedPublishState(e.publishedState);e.publishedState=j;g=b("VideoComposerDialogCaptionEditorUtils").filterOutDeletions(g.splice(c.id,1,e),a.get("deletionCache"));m=a.get("publishedStateChangeset").set(e.id,e.publishedState);if(a.get("composerID")){l=b("VideoComposerDialogCaptionEditorUtils").getPublishedCaptionFiles(a.get("captionFiles"),a.get("drafts")||b("immutable").List());b("ComposerVideoUploadActions").updateCaptions(a.get("composerID"),Array.from(l.values()))}this.$VideoComposerCaptionsStoreClass2("change_published_state",{previous_state:i,new_state:e.publishedState},null,e.id);return a.set("drafts",g).set("publishedStateChangeset",m);case b("VideoComposerCaptionsTabActionTypes").PENDING_TO_PUBLISHED:return a.set("drafts",b("VideoComposerDialogCaptionEditorUtils").changeAllPendingToPublished(a.get("drafts"))).set("publishedStateChangeset",b("immutable").Map());case b("VideoComposerActionTypes").SET_DEFAULT_CAPTION_LOCALE:var p=c.locale;return a.set("captionFiles",a.get("captionFiles").map(function(a){a.setIsDefault(p==a.getLocale());return a})).set("localCaptionFiles",a.get("localCaptionFiles").map(function(a){a.setIsDefault(p==a.getLocale());return a}));case b("VideoComposerActionTypes").SET_DISMISS_CAPTIONS_NUX:return a.set("shouldShowNuxPill",!1);case b("VideoComposerActionTypes").FETCH_CAPTION_EDITOR_CROSSPOST_PARAMS:j=b("VideoComposerDialogCaptionEditorUtils").getConvertedCaptionURLs(c.captions);l=this.getInitialState();c.spokenLocale!==""&&c.spokenLanguage!==""&&(l=l.set("spokenLocale",c.spokenLocale).set("spokenLanguage",c.spokenLanguage));return l.set("captionsFeaturesMode",c.captionsFeaturesMode).set("composerMode","video_crosspost").set("captionURLs",j);case b("VideoComposerActionTypes").CAPTIONS_EDIT_PARAMS_FETCHED:i=b("VideoComposerDialogCaptionEditorUtils").getConvertedCaptionURLs(c.data.localCaptionURLs);return a.set("captionsFeaturesMode",c.data.captionsFeaturesMode).set("hasAutoGenV1",c.data.hasAutoGenV1).set("composerMode","video_edit").set("captionURLsForEdit",i).set("localCaptionFiles",a.get("localCaptionFiles").concat(i));case b("VideoComposerActionTypes").DELETE_CAPTIONS_URL:return a.set("captionURLs",a.get("captionURLs").splice(c.id,1));case b("VideoComposerActionTypes").DELETE_LOCAL_CAPTION_FILE:return a.set("localCaptionFiles",a.get("localCaptionFiles").splice(c.id,1));case b("VideoComposerActionTypes").DELETE_LOCALE_WITHOUT_SUBTITLE:return a.set("localesWithoutSubtitlesToDelete",a.get("localesWithoutSubtitlesToDelete").push(c.locale));case b("VideoComposerActionTypes").CHANGE_PUBLISHED_STATE_URL:e=a.get("captionURLs").get(c.id);e.setPublishState(b("VideoComposerDialogCaptionEditorUtils").getUpdatedPublishState(e.getPublishState()));return a.set("captionURLs",a.get("captionURLs").splice(c.id,1,e));case b("VideoComposerActionTypes").UPDATE_SHOULD_AUTOPUBLISH_CAPTIONS:return a.set("shouldAutopublishCaptions",c.value);default:return a}};d.getCrosspostPostData=function(){this.logComposerSaveEvent();return b("Promise").resolve({})};d.getPostRequestDataToSend=function(){var a=this.getState();if(this.shouldEnableOldDataModel())return b("Promise").resolve({captions:Array.from(a.get("localCaptionFiles"))});var c=a.get("video_id");c&&b("VideoComposerDialogCaptionEditorUtils").updatePublishedStatesOnServer(a.videoComposerID,c,a.get("pageID"),this.getpublishedStateChangeset());c=a.get("drafts");a=b("VideoComposerDialogCaptionEditorUtils").getPublishedCaptionFiles(a.get("captionFiles"),c||b("immutable").List());this.logComposerSaveEvent();if(this.getSpokenLocale()===b("VideoComposerDialogCaptionEditorConstants").INITIAL_SPOKEN_LOCALE)return b("Promise").resolve({captions:Array.from(a.values()),autopublish_captions:this.getShouldAutopublishCaptions()});else return b("Promise").resolve({captions:Array.from(a.values()),spoken_locale:this.getSpokenLocale(),autopublish_captions:this.getShouldAutopublishCaptions()})};d.getPostDataForEdit=function(){var a=this.getState();if(this.shouldEnableOldDataModel())return b("Promise").resolve(b("VideoComposerDialogCaptionEditorUtils").getOldCaptionsDataModelForEdit(a.localCaptionFiles,a.captionURLsForEdit));var c=a.get("video_id");c&&b("VideoComposerDialogCaptionEditorUtils").updatePublishedStatesOnServer(a.videoComposerID,c,a.get("pageID"),this.getpublishedStateChangeset());c=a.get("drafts");c=b("VideoComposerDialogCaptionEditorUtils").getPublishedCaptionFilesForEdit(a.get("captionFiles"),c||b("immutable").List());var d={};a.get("serverCaptionLocales").concat(a.get("localesWithoutSubtitlesToDelete")).forEach(function(a,b){d["remove_caption["+b+"]"]=a});this.getSpokenLocale()!==b("VideoComposerDialogCaptionEditorConstants").INITIAL_SPOKEN_LOCALE&&(d.spoken_locale=this.getSpokenLocale());d.autopublish_captions=this.getShouldAutopublishCaptions();return b("Promise").resolve(c.merge(d).toObject())};d.initialize=function(a,b,c,d,e,f,g,h,i){a=this.$VideoComposerCaptionsStoreClass19(a,b,c,d,e,f,g,h,i);this.$VideoComposerCaptionsStoreClass20(c);this.$VideoComposerCaptionsStoreClass21(c,!0);return a};d.$VideoComposerCaptionsStoreClass19=function(a,c,d,e,f,g,h,i,j){a=a.set("videoFile",c);c&&(a=a.set("videoData",b("videoComposerDialogUploadCreateVideoData")(c)));this.$VideoComposerCaptionsStoreClass22(d);return a.set("video_id",d).set("accessToken",e).set("composerID",f||"").set("pageID",g).set("videoDurationInSec",h?h:0).set("composerMode",i).set("isOldComposer",j)};d.$VideoComposerCaptionsStoreClass5=function(a){var c=b("VideoComposerStores").getCaptionEditorStore(a.videoComposerID).getState().get("locale"),d=b("VideoComposerStores").getCaptionEditorStore(a.videoComposerID).getState().get("language"),e=b("VideoComposerStores").getCaptionEditorStore(a.videoComposerID).getState().get("captionID"),f=a.get("drafts"),g=f.toArray();for(var h=0;h<f.size;h++){var i=f.get(h);if(i.id===e){i.locale=c;i.language=d;g[h]=i;break}}i=b("VideoComposerDialogCaptionEditorUtils").filterOutDeletions(b("immutable").List(g),a.get("deletionCache"));return a.set("drafts",i)};d.$VideoComposerCaptionsStoreClass4=function(a){var c=a.get("drafts"),d=b("immutable").List();for(var e=0;e<c.size;e++){var f=c.get(e);f.locale===b("VideoComposerDialogCaptionEditorConstants").EMPTY_LOCALE?b("VideoComposerDialogCaptionEditorUtils").silentlyDeleteSubtitle(a.get("video_id"),f,a.get("pageID")):d=d.push(f)}return a.set("drafts",d)};d.$VideoComposerCaptionsStoreClass9=function(a,c){c=b("VideoComposerDialogCaptionEditorUtils").addLocaleAsPublishPending(a.get("publishedStateChangeset"),c);var d=b("VideoComposerDialogCaptionEditorUtils").updateToChangesetValues(a.get("drafts"),c);return a.set("publishedStateChangeset",c).set("drafts",d)};d.$VideoComposerCaptionsStoreClass2=function(a,b,c,d){a=this.getLogger().setEvent(a).setError(c).setSubtitleID(d);if(b!==null)for(var e in b){if(e===null||b[e]===null)return;a.addToExtraData(e,b[e])}a.log()};d.$VideoComposerCaptionsStoreClass11=function(a,b){var c=a.get("videoDurationInSec");if(c===0)return a;c=100*b/c;c=Math.min(c,99);c>a.get("progress")&&(a=a.set("progress",c));if(a.fakeAutogenerateProgressRate!==0)return a.set("autoGenProcessRate",a.fakeAutogenerateProgressRate);else{c=(Date.now()-a.get("generateStarted"))/1e3;return a.set("autoGenProcessRate",b/c)}};d.$VideoComposerCaptionsStoreClass10=function(a,c,d){d=b("VideoComposerDialogCaptionEditorUtils").getHeadLocale(d);d=a.get("captionFiles").set(d,c);c=a.get("composerID");if(c){var e=a.get("drafts");e=b("VideoComposerDialogCaptionEditorUtils").getPublishedCaptionFiles(d,e||b("immutable").List());b("ComposerVideoUploadActions").updateCaptions(c,Array.from(e.values()))}return a.set("captionFiles",d)};d.$VideoComposerCaptionsStoreClass15=function(a,c){c=b("VideoComposerDialogCaptionEditorUtils").getHeadLocale(c);c=a.get("captionFiles")["delete"](c);var d=a.get("composerID");if(d){var e=a.get("drafts");e=b("VideoComposerDialogCaptionEditorUtils").getPublishedCaptionFiles(c,e||b("immutable").List());b("ComposerVideoUploadActions").updateCaptions(d,Array.from(e.values()))}return a.set("captionFiles",c)};d.$VideoComposerCaptionsStoreClass20=function(a){var c=this;b("VideoComposerDialogCaptionEditorUtils").fetchCaptions(a,function(d){d&&d.video&&d.video.spoken_language&&(b("VideoComposerCaptionsTabActions").selectSpokenLanguage(c.getState().videoComposerID,d.video.spoken_language),b("VideoComposerCaptionsTabActions").selectSpokenLocale(c.getState().videoComposerID,d.video.spoken_locale+"_XX")),b("VideoComposerDialogCaptionEditorUtils").convertFetchToObject(c.getState().videoComposerID,a,!1,d,function(a){a=b("VideoComposerDialogCaptionEditorUtils").makeAllSRTCaptionPromises(a);b("promiseDone")(b("Promise").all(a).then(function(a){var d=b("immutable").Map(),e="";a.forEach(function(a){if(!a)return;d=d.set(a.locale,{captions:a.captions,locale:a.locale,publishedState:a.publishedState,subtitlesID:a.subtitlesID,isDefault:a.isDefault,creationMethod:a.creationMethod});a.isDefault&&(e=a.locale)});b("VideoComposerCaptionsTabActions").initializeAllCaptionFiles(c.getState().videoComposerID,d);e!==""&&b("VideoComposerCaptionsTabActions").setDefaultLocale(c.getState().videoComposerID,e)}))})})};d.$VideoComposerCaptionsStoreClass12=function(a){a=a.payload;a=a&&a.success;if(!a){a=b("VideoComposerDialogCaptionEditorUtils").getCaptionErrorMessage("caption_error_delete_fail");this.$VideoComposerCaptionsStoreClass23(a);b("VideoComposerCaptionsTabActions").deleteSubtitlesFailure(this.getState().videoComposerID)}};d.$VideoComposerCaptionsStoreClass24=function(a,c,d){a=b("XVideoCaptionGenerateAsyncController").getURIBuilder().setInt("video_id",a).setBool("regenerate",!0);c!==b("VideoComposerDialogCaptionEditorConstants").INITIAL_SPOKEN_LOCALE&&(a=a.setString("locale",c));c=a.getURI();a=b("ActorURI").create(c,this.getState().get("pageID"));new(b("AsyncRequest"))(a).setMethod("POST").setHandler(d).send()};d.$VideoComposerCaptionsStoreClass7=function(a,c,d){var e=this;if(!b("VideoComposerDialogCaptionEditorUtils").isAutoGenerateable(this.getState().videoComposerID,d))return"caption_error_generate_fail";this.$VideoComposerCaptionsStoreClass2("caption_generate_button_clicked");var f=!1,g=b("VideoComposerDialogCaptionEditorUtils").getHeadLocale(d);this.getState().get("drafts").forEach(function(a){a=b("VideoComposerDialogCaptionEditorUtils").getHeadLocale(a.locale);a===g&&(f=!0)});if(f)return"caption_error_duplicate_locale";this.$VideoComposerCaptionsStoreClass16(a);this.$VideoComposerCaptionsStoreClass24(a,d,function(b){b=b.payload;b=b&&b.status!==0;b?(e.$VideoComposerCaptionsStoreClass17(a,c),e.$VideoComposerCaptionsStoreClass18()):e.$VideoComposerCaptionsStoreClass25(c)});return null};d.$VideoComposerCaptionsStoreClass13=function(a,b,c){a=this.$VideoComposerCaptionsStoreClass26(a,b,c);if(a){this.$VideoComposerCaptionsStoreClass21(b,!1);this.$VideoComposerCaptionsStoreClass27(a.id,a.locale);return}};d.$VideoComposerCaptionsStoreClass26=function(a,c,d){d=(c=a)!=null?(c=c.video)!=null?c.video_subtitles:c:c;if(!d)return null;a=d.map(function(a,b){return{id:a.id,language:a.display_language,locale:a.locale,creationMethod:a.subtitle_creation_method}});return b("VideoComposerDialogCaptionEditorUtils").findAutoGeneratedCaption(a)};d.$VideoComposerCaptionsStoreClass16=function(a){a&&b("SkywalkerManager").subscribe("shortwave/captions/"+a,this.$VideoComposerCaptionsStoreClass28.bind(this))};d.$VideoComposerCaptionsStoreClass28=function(a){var c=a&&a.payload;if(!c)return;c=JSON.parse(a.payload);if(!c.progress_ms)return;b("VideoComposerCaptionsTabActions").updateGenerateProgress(this.getState().videoComposerID,c.progress_ms/1e3)};d.$VideoComposerCaptionsStoreClass29=function(){if(!this.getState().get("enableAutogenerateRetry"))return!1;var a=(new Date()-this.getState().get("generateStarted"))/1e3;return b("VideoComposerDialogCaptionEditorUtils").shouldRetryAutoGeneration(this.getState().get("videoDurationInSec"),a)};d.$VideoComposerCaptionsStoreClass30=function(){return this.getState().get("numAutoGenerationRetries")>0};d.$VideoComposerCaptionsStoreClass31=function(a){if(this.$VideoComposerCaptionsStoreClass30()){this.$VideoComposerCaptionsStoreClass25(a);b("VideoComposerCaptionsTabActions").generateComplete(this.getState().videoComposerID,b("immutable").List(),this.getState().get("spokenLocale"),null);return}b("VideoComposerCaptionsTabActions").retryAutoGeneration(this.getState().videoComposerID)};d.$VideoComposerCaptionsStoreClass17=function(a,c){var d=this,e=!1,f=0,g=b("setInterval")(function(){f++;if(e)return;if(!d.getState().get("isAutoGenerating")&&!d.getState().get("autoGenerateCanceling")){b("clearInterval")(g);return}e=!0;b("VideoComposerDialogCaptionEditorUtils").fetchCaptionsErrors(a,function(a){a=a&&a.video&&a.video.captions_errors;if(a.includes(b("EntVideoCaptionsErrorTypes").AUTOGENERATION_FAILED)||a.includes(b("EntVideoCaptionsErrorTypes").INVALID_LOCALE)){d.$VideoComposerCaptionsStoreClass25();b("VideoComposerCaptionsTabActions").generateComplete(d.getState().videoComposerID,b("immutable").List(),d.getState().get("spokenLocale"),null);return}});if(d.$VideoComposerCaptionsStoreClass29()){b("clearInterval")(g);d.$VideoComposerCaptionsStoreClass31(c);return}b("VideoComposerDialogCaptionEditorUtils").fetchCaptions(a,function(h){var i=h&&h.video&&h.video.video_subtitles;if(i){i=d.$VideoComposerCaptionsStoreClass26(h,a,c);if(i){b("clearInterval")(g);d.$VideoComposerCaptionsStoreClass21(a,!1);d.$VideoComposerCaptionsStoreClass27(i.id,i.locale);return}if(f===l){d.$VideoComposerCaptionsStoreClass25(c);b("VideoComposerCaptionsTabActions").generateComplete(d.getState().videoComposerID,b("immutable").List(),d.getState().get("spokenLocale"),null);b("clearInterval")(g);return}e=!1}})},m)};d.$VideoComposerCaptionsStoreClass18=function(){var a=this,c=0,d=this.getState().get("videoDurationInSec"),e=b("setInterval")(function(){c++;var f=!a.getState().get("isAutoGenerating")||c>=b("VideoComposerDialogCaptionEditorConstants").MAX_FAKE_POLL_ITERATIONS;if(f){b("clearInterval")(e);return}f=a.getState().get("progress");f=f*d/100;var g=a.getState().get("autoGenProcessRate");f=f+g*b("VideoComposerDialogCaptionEditorConstants").POLL_FAKE_FREQUENCY_GENERATE_MS*b("VideoComposerDialogCaptionEditorConstants").AUTO_GEN_PROGRESS_RATE_FACTOR/1e3;b("VideoComposerCaptionsTabActions").updateGenerateProgress(a.getState().videoComposerID,f)},b("VideoComposerDialogCaptionEditorConstants").POLL_FAKE_FREQUENCY_GENERATE_MS)};d.$VideoComposerCaptionsStoreClass8=function(a){var c=this;this.$VideoComposerCaptionsStoreClass24(a,b("VideoComposerDialogCaptionEditorConstants").INITIAL_SPOKEN_LOCALE,function(b){b=b.payload;var d=b&&b.status!==0;if(d)c.$VideoComposerCaptionsStoreClass32(a);else{d="Speech non speech request error";b.error&&(d=d+": "+b.error);c.$VideoComposerCaptionsStoreClass33(d)}})};d.$VideoComposerCaptionsStoreClass32=function(a){var c=this,d=!1,e=0,f=b("setInterval")(function(){e++;if(d)return;var g=b("XVideoCaptionSpeechDetectionAsyncController").getURIBuilder().setInt("video_id",a);d=!0;g=g.getURI();g=b("ActorURI").create(g,c.getState().get("pageID"));new(b("AsyncRequest"))(g).setMethod("POST").setHandler(function(g){g=g.payload;var h=g&&g.status===2;if(h){b("clearInterval")(f);g.error==="speech_non_speech_fallback"?c.$VideoComposerCaptionsStoreClass2("caption_create_complete",{},"Speech non speech fallback path."):c.$VideoComposerCaptionsStoreClass2("caption_create_complete");b("VideoComposerDialogCaptionEditorUtils").fetchCaptionedLocales(c.getState().videoComposerID,b("nullthrows")(a),!1,function(a,d){b("VideoComposerDialogCaptionEditorUtils").finishCaptionsFetch(c.getState().videoComposerID,a,d);b("VideoComposerCaptionsTabActions").createComplete(c.getState().videoComposerID);if(c.getState().show_caption_editor){d=a.findIndex(function(a){return a.language===b("VideoComposerDialogCaptionEditorConstants").EMPTY_LOCALE});b("VideoComposerCaptionsTabActions").editCaptionsDraft(c.getState().videoComposerID,d)}else a.forEach(function(a,d){a.language===b("VideoComposerDialogCaptionEditorConstants").EMPTY_LOCALE&&b("VideoComposerCaptionsTabActions").deleteCaptionsDraft(c.getState().videoComposerID,d)})});return}h=g===null||g&&g.status===0;if(h){c.$VideoComposerCaptionsStoreClass34();b("clearInterval")(f);return}if(e===k){c.$VideoComposerCaptionsStoreClass33("Speech non speech timeout.");b("clearInterval")(f);return}d=!1}).send()},j)};d.$VideoComposerCaptionsStoreClass21=function(a,c){var d=this;b("VideoComposerDialogCaptionEditorUtils").fetchCaptionedLocales(this.getState().videoComposerID,a,c,function(a,c){return b("VideoComposerDialogCaptionEditorUtils").finishCaptionsFetch(d.getState().videoComposerID,a,c)})};d.$VideoComposerCaptionsStoreClass6=function(a,c){var d=this;b("VideoComposerDialogCaptionEditorUtils").fetchCaptionedLocales(this.getState().videoComposerID,a,!1,function(a,e){var f=c!==null;f&&d.$VideoComposerCaptionsStoreClass35(a,c);b("VideoComposerDialogCaptionEditorUtils").finishCaptionsFetch(d.getState().videoComposerID,a,e)})};d.$VideoComposerCaptionsStoreClass22=function(a){var c=this;b("VideoComposerDialogCaptionEditorUtils").fetchCaptionsErrors(a,function(a){a=a&&a.video&&a.video.captions_errors;a!=null&&(a.includes(b("EntVideoCaptionsErrorTypes").AUTOGENERATION_FAILED)||a.includes(b("EntVideoCaptionsErrorTypes").INVALID_LOCALE))&&c.$VideoComposerCaptionsStoreClass23(b("VideoComposerDialogCaptionEditorUtils").getCaptionErrorMessage("caption_error_generate_fail"))})};d.$VideoComposerCaptionsStoreClass35=function(a,c){a=a.some(function(a){a.locale===c});a?b("VideoComposerCaptionsTabActions").resetAutoGeneratingLocale(this.getState().videoComposerID):b("VideoComposerCaptionsTabActions").resumeAutoGeneration(this.getState().videoComposerID)};d.uploadCaptionsForSRT=function(a,b,c){this.$VideoComposerCaptionsStoreClass14(a,b,c)};d.$VideoComposerCaptionsStoreClass14=function(a,c,d){var e=this;d=b("XVideoCaptionUploadAsyncController").getURIBuilder().setInt("video_id",a);d=d.getURI();var f=b("ActorURI").create(d,this.getState().get("pageID")),h=c.length,i=[],j=function(b,d){var f=b.payload,j=f&&f.success==="true"&&f.error==="";if(j)i.push(d),c.length===0?e.$VideoComposerCaptionsStoreClass36(a,h,i,null):k();else{j=i.length;b.getError()!==0?d=b.getErrorDescriptionString():d=f?f.error:g._("We are unable to upload your SRT file at this time. Please try again later.");h===1?b=d:b=g._("Uploaded {uploadedCaptions} of {captionsToUpload}. Reason: {reason}",[g._param("uploadedCaptions",j),g._param("captionsToUpload",h),g._param("reason",d)]);e.$VideoComposerCaptionsStoreClass36(a,h,i,b)}},k=function(){var a=c.pop(),d=new FormData(),e=a.getIsDefault()?"captions_default":"captions_file0";d.append(e,a.getFile());new(b("AsyncRequest"))(f).setMethod("POST").setHandler(function(b){j(b,a)}).setErrorHandler(function(b){j(b,a)}).setRawData(d).send()};k()};d.$VideoComposerCaptionsStoreClass36=function(a,c,d,e){var f=this,g=d.length===c;if(!g&&d.length===0){b("VideoComposerCaptionsTabActions").finishSRTUpload(this.getState().videoComposerID,!1,e,b("immutable").Map());return}b("VideoComposerDialogCaptionEditorUtils").fetchCaptions(a,function(c){b("VideoComposerDialogCaptionEditorUtils").convertFetchToObject(f.getState().videoComposerID,a,!1,c,function(a,c){b("VideoComposerDialogCaptionEditorUtils").finishCaptionsFetch(f.getState().videoComposerID,a,c);c=b("VideoComposerDialogCaptionEditorUtils").makeSRTCaptionPromises(d,a);b("promiseDone")(b("Promise").all(c).then(function(a){var c=b("immutable").Map();a.forEach(function(a){if(!a)return;c=c.set(a.locale,{subtitlesID:a.subtitlesID,captions:a.captions})});b("VideoComposerCaptionsTabActions").finishSRTUpload(f.getState().videoComposerID,g,e,c)}))})})};d.$VideoComposerCaptionsStoreClass25=function(a){a=b("VideoComposerDialogCaptionEditorUtils").getCaptionErrorMessage("caption_error_generate_fail",a);this.$VideoComposerCaptionsStoreClass2("caption_generate_complete",{},a.toString());this.$VideoComposerCaptionsStoreClass23(a)};d.$VideoComposerCaptionsStoreClass34=function(){var a=b("VideoComposerDialogCaptionEditorUtils").getCaptionErrorMessage("caption_error_create_fail");this.$VideoComposerCaptionsStoreClass33(a.toString())};d.$VideoComposerCaptionsStoreClass33=function(a){var c=b("VideoComposerDialogCaptionEditorUtils").getCaptionErrorMessage("caption_error_create_fail");this.$VideoComposerCaptionsStoreClass2("caption_create_complete",{},a);this.$VideoComposerCaptionsStoreClass23(c)};d.$VideoComposerCaptionsStoreClass23=function(a){a=b("immutable").List([a]);a={type:b("VideoComposerCaptionsTabActionTypes").UPDATE_ERROR_STATE,errors:a};b("VideoComposerDispatchers").get(this.getState().videoComposerID).dispatch(a)};d.$VideoComposerCaptionsStoreClass27=function(a,c){var d=this;this.$VideoComposerCaptionsStoreClass2("caption_generate_complete");b("VideoComposerDialogCaptionEditorUtils").fetchCaptionByID(a,function(e){var f=e&&e.video_subtitle&&e.video_subtitle.captions&&e.video_subtitle.captions.edges;if(f){f=e.video_subtitle.captions.edges;b("VideoComposerCaptionsTabActions").generateComplete(d.getState().videoComposerID,b("immutable").List(f),c,a)}})};d.isCaptionsEnabled=function(){var a=this.getState();a=a.drafts;var c=!1;a.forEach(function(a){a.publishedState!==b("VideoComposerDialogCaptionEditorPublishStateEnum").DRAFT&&(c=!0)});return c};return c}(b("VideoComposerStoreBase"));e.exports=f}),null);
__d("VideoComposerPollsStoreClass",["invariant","Promise","ImmutableRecordWithV4Types","VideoComposerActionTypes","VideoComposerPollsConstants","VideoComposerPollsTypes","VideoComposerPollsUtils","VideoComposerStoreBase","VideoComposerStores","flattenPHPQueryData","gkx","immutable","uuid"],(function(a,b,c,d,e,f,g){"use strict";a=b("ImmutableRecordWithV4Types").Record;var h=(c=b("VideoComposerPollsTypes")).EditorState,i=c.PollDataRecordFactory,j=c.PollOptionDataRecordFactory,k=c.SliderDataRecordFactory,l=3600,m="START",n="END",o=a({videoComposerID:"",isAdBreaksPollCreationEnabled:!1,isImageAttachmentEnabled:!1,savedStateLoaded:!1,draftPoll:i(),editAttemptPollID:"",deleteAttemptPollID:null,editorState:h.CLOSED,persistedPolls:[],polls:b("immutable").List(),showEditor:!1,showCancelConfirmDialog:!1,showCloseEditorConfirmDialog:!1,showEditAttemptDialog:!1,isLiveVideo:!1,enableWasLiveVoting:!1,showWasLiveVotingToggle:!1,canSeeSlidersSection:!1,showOpenPollsFormSectionConfirmationDialog:!1,showOpenSlidersFormSectionConfirmationDialog:!1,draftSlider:k(),sliders:b("immutable").List(),editAttemptSliderID:"",deleteAttemptSliderID:null});d=function(a){babelHelpers.inheritsLoose(c,a);function c(){var b,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(b=c=a.call.apply(a,[this].concat(e))||this,c.mapPollRecordToNewPollRequestData=function(a,b){var d=[],e=[];a.options.forEach(function(a,c){c=a.imageFile!==null?this.constructImageFileKey(b,c):null;e.push({text:a.text,imageFileKey:c});d.push(a.stickerID)},babelHelpers.assertThisInitialized(c));return{question_text:a.questionText,display_results_after_voting:a.showResults,display_results_timestamp:a.displayResultsTimestamp,voting_closed_timestamp:a.votingClosedTimestamp,options:[],sticker_options:a.optionType==="STICKER"?d:[],options_with_images:a.optionType==="TEXT"?e:[],start_time:c.$VideoComposerPollsStoreClass29(a.startTime),end_time:c.$VideoComposerPollsStoreClass29(a.endTime),is_ad_break_poll:a.isAdBreakPoll,poll_type:a.pollType}},b)||babelHelpers.assertThisInitialized(c)}var d=c.prototype;d.getInitialState=function(){return o()};d.reduceImpl=function(a,c){switch(c.type){case b("VideoComposerActionTypes").INITIALIZE_UPLOAD_COMPOSER:a=a.set("isImageAttachmentEnabled",c.serverParams.isImageAttachmentEnabled);a=a.set("canSeeSlidersSection",this.$VideoComposerPollsStoreClass1(a));return a.set("isAdBreaksPollCreationEnabled",c.serverParams.isAdBreaksPollCreationEnabled);case b("VideoComposerActionTypes").POLLS_BOOTLOAD_EDIT:a=a.set("isImageAttachmentEnabled",c.data.isImageAttachmentEnabled);a=a.set("isAdBreaksPollCreationEnabled",c.data.isAdBreaksPollCreationEnabled);a=a.set("persistedPolls",c.data.polls);a=a.set("isLiveVideo",c.data.isLiveVideo);a=a.set("showWasLiveVotingToggle",c.data.showWasLiveVotingToggle);a=a.set("enableWasLiveVoting",c.data.enableWasLiveVoting);a=a.set("polls",b("immutable").List(c.data.polls.map(b("VideoComposerPollsUtils").mapPersistedPollToLocalPoll)));a=a.set("canSeeSlidersSection",this.$VideoComposerPollsStoreClass1(a));return a;case b("VideoComposerActionTypes").POLLS_ADD_NEW:var d=this.$VideoComposerPollsStoreClass2(a,c.isAdBreakPoll);return a.set("showEditor",!0).set("editorState",h.ADDING_NEW_POLL).set("draftPoll",d);case b("VideoComposerActionTypes").POLLS_CLOSE_EDITOR_ATTEMPT:if(this.$VideoComposerPollsStoreClass3(a))return a.set("showCloseEditorConfirmDialog",!0);else return this.$VideoComposerPollsStoreClass4(a,!0);case b("VideoComposerActionTypes").POLLS_CLOSE_EDITOR_ABANDON:return a.set("showCloseEditorConfirmDialog",!1);case b("VideoComposerActionTypes").POLLS_CLOSE_EDITOR_CONFIRM:return this.$VideoComposerPollsStoreClass4(a,!0);case b("VideoComposerActionTypes").POLLS_CANCEL_CHANGES_ATTEMPT:if(this.$VideoComposerPollsStoreClass3(a))return a.set("showCancelConfirmDialog",!0);else return this.$VideoComposerPollsStoreClass4(a,a.polls.size===0);case b("VideoComposerActionTypes").POLLS_CANCEL_CHANGES_ABANDON:return a.set("showCancelConfirmDialog",!1);case b("VideoComposerActionTypes").POLLS_CANCEL_CHANGES_CONFIRM:return this.$VideoComposerPollsStoreClass4(a,a.polls.size===0);case b("VideoComposerActionTypes").POLLS_DELETE_ATTEMPT:return a.set("deleteAttemptPollID",c.pollID);case b("VideoComposerActionTypes").POLLS_DELETE_INTERACTION_CANCEL:return this.$VideoComposerPollsStoreClass5(a);case b("VideoComposerActionTypes").POLLS_DELETE_CONFIRM:d=a.polls.findIndex(function(b){return b.id===a.deleteAttemptPollID});return a.set("polls",a.polls["delete"](d)).set("deleteAttemptPollID",null);case b("VideoComposerActionTypes").POLLS_DRAFT_ADD_OPTION:return a.set("draftPoll",a.draftPoll.set("options",a.draftPoll.options.push(j())));case b("VideoComposerActionTypes").POLLS_DRAFT_DELETE_OPTION:return a.set("draftPoll",a.draftPoll.set("options",a.draftPoll.options.deleteIn([c.optionIndex])));case b("VideoComposerActionTypes").POLLS_DRAFT_SET_RESULTS_VISIBLE:return a.set("draftPoll",a.draftPoll.set("showResults",c.showResultsAfterVote));case b("VideoComposerActionTypes").POLLS_DRAFT_SET_DISPLAY_RESULTS_TIMESTAMP:return a.set("draftPoll",a.draftPoll.set("displayResultsTimestamp",c.time));case b("VideoComposerActionTypes").POLLS_DRAFT_SET_VOTING_CLOSED_TIMESTAMP:return a.set("draftPoll",a.draftPoll.set("votingClosedTimestamp",c.time));case b("VideoComposerActionTypes").POLLS_DRAFT_TOGGLE_AD_BREAK_POLL:d=!a.draftPoll.isAdBreakPoll;var e=a.draftPoll;e=e.set("isAdBreakPoll",d);e=e.set("pollType",d?"ad_break_poll":"scheduled");return a.set("draftPoll",e);case b("VideoComposerActionTypes").POLLS_DRAFT_UPDATE_START_TIME:return this.$VideoComposerPollsStoreClass6(a,"startTime",c.time);case b("VideoComposerActionTypes").POLLS_DRAFT_UPDATE_END_TIME:return this.$VideoComposerPollsStoreClass6(a,"endTime",c.time);case b("VideoComposerActionTypes").POLLS_DRAFT_UPDATE_OPTION_TEXT:d=a.draftPoll.options;d=d.setIn([c.optionIndex],d.get(c.optionIndex).set("text",c.text));return a.set("draftPoll",a.draftPoll.set("options",d));case b("VideoComposerActionTypes").POLLS_DRAFT_STICKER_SELECT:d=a.draftPoll.options;d=d.setIn([c.optionIndex],d.get(c.optionIndex).set("stickerID",c.stickerID));e=d.filter(function(a){return a.stickerID!==""}).size;a=a.set("draftPoll",a.draftPoll.set("options",d));a=a.set("draftPoll",a.draftPoll.set("optionType",e===0?"TEXT":"STICKER"));return a;case b("VideoComposerActionTypes").POLLS_DRAFT_UPDATE_IMAGE_ATTACHMENT:d=a.draftPoll.options;d=d.setIn([c.optionIndex],d.get(c.optionIndex).set("imageURL",c.imageURL));d=d.setIn([c.optionIndex],d.get(c.optionIndex).set("imageFile",c.imageFile));return a.set("draftPoll",a.draftPoll.set("options",d));case b("VideoComposerActionTypes").POLLS_DRAFT_UPDATE_QUESTION:return a.set("draftPoll",a.draftPoll.set("questionText",c.text));case b("VideoComposerActionTypes").POLLS_EDIT_ATTEMPT:if(this.$VideoComposerPollsStoreClass3(a))return this.$VideoComposerPollsStoreClass7(a,c.pollID);else return this.$VideoComposerPollsStoreClass8(a,c.pollID);case b("VideoComposerActionTypes").POLLS_EDIT_ATTEMPT_DISCARD_PREVIOUS:return this.$VideoComposerPollsStoreClass9(a);case b("VideoComposerActionTypes").POLLS_EDIT_ATTEMPT_HIDE_DIALOG:return this.$VideoComposerPollsStoreClass10(a);case b("VideoComposerActionTypes").POLLS_EDIT_ATTEMPT_SAVE_PREVIOUS:return this.$VideoComposerPollsStoreClass11(a);case b("VideoComposerActionTypes").POLLS_TOGGLE_WAS_LIVE_VOTING:return a.set("enableWasLiveVoting",c.enableWasLiveVoting);case b("VideoComposerActionTypes").POLLS_OPEN_POLLS_FORM_SECTION_ATTEMPT:return this.$VideoComposerPollsStoreClass12(a);case b("VideoComposerActionTypes").POLLS_OPEN_POLLS_FORM_SECTION_CONFIRM:return this.$VideoComposerPollsStoreClass13(a);case b("VideoComposerActionTypes").POLLS_OPEN_POLLS_FORM_SECTION_CANCEL:return a.set("showOpenPollsFormSectionConfirmationDialog",!1);case b("VideoComposerActionTypes").POLLS_OPEN_SLIDERS_FORM_SECTION_ATTEMPT:return this.$VideoComposerPollsStoreClass14(a);case b("VideoComposerActionTypes").POLLS_OPEN_SLIDERS_FORM_SECTION_CONFIRM:return this.$VideoComposerPollsStoreClass15(a);case b("VideoComposerActionTypes").POLLS_OPEN_SLIDERS_FORM_SECTION_CANCEL:return a.set("showOpenSlidersFormSectionConfirmationDialog",!1);case b("VideoComposerActionTypes").POLLS_DRAFT_UPDATE_SLIDER_QUESTION:return a.set("draftSlider",a.draftSlider.set("questionText",c.text));case b("VideoComposerActionTypes").POLLS_DRAFT_UPDATE_SLIDER_EMOJI:return a.set("draftSlider",a.draftSlider.set("emoji",c.emoji));case b("VideoComposerActionTypes").POLLS_EDIT_SLIDER_ATTEMPT:return this.$VideoComposerPollsStoreClass16(a,c.sliderID);case b("VideoComposerActionTypes").POLLS_DELETE_SLIDER_ATTEMPT:return a.set("deleteAttemptSliderID",c.sliderID);case b("VideoComposerActionTypes").POLLS_DELETE_SLIDER_CONFIRM:return this.$VideoComposerPollsStoreClass17(a);case b("VideoComposerActionTypes").POLLS_SAVE:return this.$VideoComposerPollsStoreClass18(a);case b("VideoComposerActionTypes").POLLS_SAVE_SLIDER:return this.$VideoComposerPollsStoreClass19(a);case b("VideoComposerActionTypes").RESET_COMPOSER:return this.getInitialState();default:return a}};d.$VideoComposerPollsStoreClass1=function(a){return b("gkx")("976432")&&!a.isLiveVideo};d.$VideoComposerPollsStoreClass6=function(a,b,c){switch(a.editorState){case h.ADDING_NEW_POLL:case h.EDITING_POLL:return a.set("draftPoll",a.draftPoll.set(b,c));case h.ADDING_NEW_SLIDER:case h.EDITING_SLIDER:return a.set("draftSlider",a.draftSlider.set(b,c));default:return a}};d.$VideoComposerPollsStoreClass12=function(a){if(a.editorState===h.ADDING_NEW_POLL||a.editorState===h.EDITING_POLL)return a;return this.$VideoComposerPollsStoreClass3(a)?a.set("showOpenPollsFormSectionConfirmationDialog",!0):this.$VideoComposerPollsStoreClass13(a)};d.$VideoComposerPollsStoreClass13=function(a){var b=this.$VideoComposerPollsStoreClass2(a,!1);return a.set("showOpenPollsFormSectionConfirmationDialog",!1).set("editorState",h.ADDING_NEW_POLL).set("draftPoll",b)};d.$VideoComposerPollsStoreClass14=function(a){if(a.editorState===h.ADDING_NEW_SLIDER||a.editorState===h.EDITING_SLIDER)return a;return this.$VideoComposerPollsStoreClass3(a)?a.set("showOpenSlidersFormSectionConfirmationDialog",!0):this.$VideoComposerPollsStoreClass15(a)};d.$VideoComposerPollsStoreClass15=function(a){return a.set("showOpenSlidersFormSectionConfirmationDialog",!1).set("editorState",h.ADDING_NEW_SLIDER).set("draftSlider",this.$VideoComposerPollsStoreClass20(a))};d.$VideoComposerPollsStoreClass3=function(a){switch(a.editorState){case h.EDITING_POLL:var c=a.polls.find(function(b){return b.id===a.draftPoll.id});return!b("immutable").is(c,a.draftPoll);case h.ADDING_NEW_POLL:return!!a.draftPoll.questionText.trim()||a.draftPoll.options.some(function(a){return!!a.text.trim()});case h.EDITING_SLIDER:return!1;case h.ADDING_NEW_SLIDER:return this.$VideoComposerPollsStoreClass21(a);case h.LIST_VIEW:case h.CLOSED:return!1}return!1};d.$VideoComposerPollsStoreClass21=function(a){return!!a.draftSlider.questionText.trim()||!!a.draftSlider.emoji.trim()};d.$VideoComposerPollsStoreClass18=function(a){var c=a.draftPoll;c=c.set("questionText",c.questionText.trim()).set("options",c.options.map(function(a){return a.set("text",a.text.trim())}).map(function(a){return a.set("stickerID",a.stickerID)}).map(function(a){return a.set("imageURL",a.imageURL)}).map(function(a){return a.set("imageFile",a.imageFile)}).filter(function(a){return!!a.text||!!a.stickerID}));c.options.size>=b("VideoComposerPollsConstants").MIN_OPTIONS_COUNT&&c.options.size<=b("VideoComposerPollsConstants").MAX_OPTIONS_COUNT||g(0,4514);a=a.set("draftPoll",c);c=a.editorState===h.ADDING_NEW_POLL?a.polls.push(a.draftPoll.set("id",b("uuid")())):a.polls.set(a.polls.findIndex(function(b){return b.id===a.draftPoll.id}),a.draftPoll);c=c.sortBy(function(a){return b("VideoComposerPollsUtils").timeStringToSeconds(a.startTime)});var d=a.draftPoll.isAdBreakPoll;a=this.$VideoComposerPollsStoreClass22(a).set("polls",c);d&&(a=this.$VideoComposerPollsStoreClass4(a,!0));return a};d.$VideoComposerPollsStoreClass19=function(a){var c=a.draftSlider;c=c.set("questionText",c.questionText.trim());a=a.set("draftSlider",c);c=a.editorState===h.ADDING_NEW_SLIDER?a.sliders.push(a.draftSlider.set("id",b("uuid")())):a.sliders.set(a.sliders.findIndex(function(b){return b.id===a.draftSlider.id}),a.draftSlider);c=c.sortBy(function(a){return b("VideoComposerPollsUtils").timeStringToSeconds(a.startTime)});return this.$VideoComposerPollsStoreClass22(a).set("sliders",c)};d.$VideoComposerPollsStoreClass16=function(a,b){return this.$VideoComposerPollsStoreClass3(a)?this.$VideoComposerPollsStoreClass23(a,b):this.$VideoComposerPollsStoreClass24(a,b)};d.$VideoComposerPollsStoreClass17=function(a){var b=a.sliders.findIndex(function(b){return b.id===a.deleteAttemptSliderID});return a.set("sliders",a.sliders["delete"](b)).set("deleteAttemptSliderID",null)};d.$VideoComposerPollsStoreClass5=function(a){return a.set("deleteAttemptPollID",null).set("deleteAttemptSliderID",null)};d.$VideoComposerPollsStoreClass4=function(a,b){a=this.$VideoComposerPollsStoreClass22(a);a=a.set("showCancelConfirmDialog",!1);a=a.set("showCloseEditorConfirmDialog",!1);b&&(a=this.$VideoComposerPollsStoreClass25(a));return a};d.$VideoComposerPollsStoreClass7=function(a,b){return a.set("showEditAttemptDialog",!0).set("editAttemptPollID",b)};d.$VideoComposerPollsStoreClass23=function(a,b){return a.set("showEditAttemptDialog",!0).set("editAttemptSliderID",b)};d.$VideoComposerPollsStoreClass10=function(a){return a.set("showEditAttemptDialog",!1).set("editAttemptPollID","").set("editAttemptSliderID","")};d.$VideoComposerPollsStoreClass11=function(a){a=this.$VideoComposerPollsStoreClass26(a);return this.$VideoComposerPollsStoreClass9(a)};d.$VideoComposerPollsStoreClass26=function(a){switch(a.editorState){case h.ADDING_NEW_POLL:case h.EDITING_POLL:return this.$VideoComposerPollsStoreClass18(a);case h.ADDING_NEW_SLIDER:case h.EDITING_SLIDER:return this.$VideoComposerPollsStoreClass19(a)}return a};d.$VideoComposerPollsStoreClass9=function(a){a=a.editAttemptSliderID.length>0?this.$VideoComposerPollsStoreClass24(a,a.editAttemptSliderID):this.$VideoComposerPollsStoreClass8(a,a.editAttemptPollID);return this.$VideoComposerPollsStoreClass10(a)};d.$VideoComposerPollsStoreClass8=function(a,b){var c=a.polls.find(function(a){return a.id===b});return a.set("showEditor",!0).set("editorState",h.EDITING_POLL).set("draftPoll",c)};d.$VideoComposerPollsStoreClass24=function(a,b){var c=a.sliders.find(function(a){return a.id===b});return!c?a:a.set("showEditor",!0).set("editorState",h.EDITING_SLIDER).set("draftSlider",c)};d.$VideoComposerPollsStoreClass22=function(a){return a.set("editorState",h.LIST_VIEW)};d.$VideoComposerPollsStoreClass25=function(a){return a.set("showEditor",!1).set("editorState",h.CLOSED)};d.$VideoComposerPollsStoreClass2=function(a,c){var d=i();d=d.set("options",d.options.push(j()).push(j())).set("isAdBreakPoll",c).set("pollType",c?"ad_break_poll":"scheduled");c&&(d=d.set("canChangePollType",!1));c=this.$VideoComposerPollsStoreClass27(a);c&&(d=d.set("startTime",this.$VideoComposerPollsStoreClass28(c.interactionStartTime,c.videoDuration)),d=d.set("endTime",this.$VideoComposerPollsStoreClass28(c.interactionEndTime,c.videoDuration)));d=d.set("showResults",!0);d=d.set("displayResultsTimestamp",b("VideoComposerPollsConstants").AFTER_VOTE_TIMESTAMP);return d};d.$VideoComposerPollsStoreClass20=function(a){var b=k();a=this.$VideoComposerPollsStoreClass27(a);a&&(b=b.set("startTime",this.$VideoComposerPollsStoreClass28(a.interactionStartTime,a.videoDuration)),b=b.set("endTime",this.$VideoComposerPollsStoreClass28(a.interactionEndTime,a.videoDuration)));return b};d.$VideoComposerPollsStoreClass27=function(a){var c=b("VideoComposerStores").getMetadataStore(a.videoComposerID).getVideoPreviewTimeData();c=c.videoDuration;if(!c||c<b("VideoComposerPollsConstants").MIN_POLL_DURATION||this.getNonAdBreakPolls(a.polls).size>0||a.sliders.size>0)return null;a=0;var d=c>=b("VideoComposerPollsConstants").INITIAL_POLL_DEFAULT_DURATION?b("VideoComposerPollsConstants").INITIAL_POLL_DEFAULT_DURATION:b("VideoComposerPollsConstants").MIN_POLL_DURATION;return{videoDuration:c,interactionStartTime:a,interactionEndTime:a+d}};d.$VideoComposerPollsStoreClass28=function(a,c){a=b("VideoComposerPollsUtils").secondsToTimeString(a);return c>=l&&a.split(":").length===2?"00:"+a:a};d.getPostRequestDataToSend=function(){var a=this,c=this.getState().polls.toArray().map(this.mapPollRecordToNewPollRequestData),d={};this.getState().polls.forEach(function(b,c){b=a.constructPollImageDataMap(b,c);d=Object.assign(d,b)});c=b("flattenPHPQueryData")({polls:c});c.pollImages=d;return b("Promise").resolve(c)};d.getEditRequestDataToSend=function(){var a=this,c=this.getState(),d=c.persistedPolls.filter(function(a){return c.polls.findIndex(function(b){return b.id===a.id})===-1}).map(function(a){return a.id}),e=[],f=[],g={};c.polls.forEach(function(b,c){if(b.isPersisted)e.push(a.mapPollRecordToEditPollRequestData(b));else{f.push(a.mapPollRecordToNewPollRequestData(b,c));b=a.constructPollImageDataMap(b,c);g=Object.assign(g,b)}});d=b("flattenPHPQueryData")({deleted_poll_ids:d,updated_polls:e,new_polls:f,enable_was_live_voting:c.enableWasLiveVoting});Object.assign(d,g);return b("Promise").resolve(d)};d.constructImageFileKey=function(a,b){return"poll_"+a+"_"+b};d.constructPollImageDataMap=function(a,b){var c={};a.options.forEach(function(a,d){if(a.imageFile){d=this.constructImageFileKey(b,d);c[d]=a.imageFile}},this);return c};d.mapPollRecordToEditPollRequestData=function(a){return{id:a.id,display_results_after_voting:a.showResults,display_results_timestamp:a.displayResultsTimestamp,voting_closed_timestamp:a.votingClosedTimestamp,start_time:this.$VideoComposerPollsStoreClass29(a.startTime),end_time:this.$VideoComposerPollsStoreClass29(a.endTime),is_ad_break_poll:a.isAdBreakPoll,poll_type:a.pollType}};d.isSufficientTimeSpanForPoll=function(a,c){return!c?!0:this.findMaxiumTimeSpanAvailableForPoll(a,c)>=b("VideoComposerPollsConstants").MIN_POLL_DURATION};d.numAdBreakPolls=function(a){return this.getAdBreakPolls(a).size};d.getNonAdBreakPolls=function(a){return a.filter(function(a){return a.pollType!=="ad_break_poll"})};d.getAdBreakPolls=function(a){return a.filter(function(a){return a.pollType==="ad_break_poll"})};d.findMaxiumTimeSpanAvailableForPoll=function(a,c){var d=this;if(a.size==0)return c||0;var e=b("immutable").List();a.forEach(function(a){var b={timeStampType:m,timestamp:d.$VideoComposerPollsStoreClass29(a.get("startTime"))||0};a={timeStampType:n,timestamp:d.$VideoComposerPollsStoreClass29(a.get("endTime"))||0};e=e.push(b);e=e.push(a)});a=e.sortBy(function(a){return a.timestamp});c=Math.max(a.first().timestamp-0,c-a.last().timestamp);var f=1;while(2*f<a.size)c=Math.max(c,a.get(2*f).timestamp-a.get(2*f-1).timestamp),f++;return c};d.hasValidationErrors=function(a){var c=this.getState();switch(c.editorState){case h.ADDING_NEW_POLL:case h.EDITING_POLL:if(b("VideoComposerPollsUtils").arePollQuestionAndOptionsInvalid(c.draftPoll))return!0;break;case h.ADDING_NEW_SLIDER:case h.EDITING_SLIDER:if(!c.draftSlider.questionText.trim())return!0;break}var d=b("VideoComposerStores").getMetadataStore(c.videoComposerID).getVideoPreviewTimeData();d=d.videoDuration;a=b("VideoComposerPollsUtils").validateDraftInteractionTimeWindow(this.$VideoComposerPollsStoreClass30(c),a,c.sliders,d);c=a.commonError;d=a.startTimeError;a=a.endTimeError;return!!d||!!a||!!c};d.$VideoComposerPollsStoreClass30=function(a){return a.editorState===h.ADDING_NEW_SLIDER||a.editorState===h.EDITING_SLIDER?a.draftSlider:a.draftPoll};d.$VideoComposerPollsStoreClass29=function(a){return a===""?null:b("VideoComposerPollsUtils").timeStringToSeconds(a)};return c}(b("VideoComposerStoreBase"));e.exports=d}),null);
__d("VideoComposerQuestionsTypes",["ImmutableRecordWithV4Types"],(function(a,b,c,d,e,f){"use strict";a=b("ImmutableRecordWithV4Types").Record;c=a({id:"",isPersisted:!1,questionText:"",startTime:"",endTime:""});e.exports={TextQuestionDataRecordFactory:c}}),null);
__d("VideoComposerQuestionsStoreClass",["Promise","ImmutableRecordWithV4Types","VideoComposerActionTypes","VideoComposerPollsUtils","VideoComposerQuestionsConstants","VideoComposerQuestionsTypes","VideoComposerStoreBase","VideoComposerStores","flattenPHPQueryData","immutable","uuid"],(function(a,b,c,d,e,f){"use strict";a=b("ImmutableRecordWithV4Types").Record;var g=b("VideoComposerQuestionsTypes").TextQuestionDataRecordFactory,h=3600,i=a({videoComposerID:"",draftQuestion:g(),isAddingNewQuestion:!1,isEditingQuestion:!1,questions:b("immutable").List(),showEditor:!1,showCancelConfirmDialog:!1,showCloseEditorConfirmDialog:!1});c=function(a){babelHelpers.inheritsLoose(c,a);function c(){var c,d;for(var e=arguments.length,f=new Array(e),g=0;g<e;g++)f[g]=arguments[g];return(c=d=a.call.apply(a,[this].concat(f))||this,d.mapQuestionRecordToNewQuestionRequestData=function(a,c){return{question_text:a.questionText,start_time:b("VideoComposerPollsUtils").timeStringToSeconds(a.startTime),end_time:b("VideoComposerPollsUtils").timeStringToSeconds(a.endTime)}},c)||babelHelpers.assertThisInitialized(d)}var d=c.prototype;d.getInitialState=function(){return i()};d.reduceImpl=function(a,c){switch(c.type){case b("VideoComposerActionTypes").QUESTIONS_ADD_NEW:var d=this.$VideoComposerQuestionsStoreClass1(a);return a.set("showEditor",!0).set("isAddingNewQuestion",!0).set("isEditingQuestion",!1).set("draftQuestion",d);case b("VideoComposerActionTypes").QUESTIONS_CLOSE_EDITOR_ATTEMPT:if(this.$VideoComposerQuestionsStoreClass2(a))return a.set("showCloseEditorConfirmDialog",!0);else return this.$VideoComposerQuestionsStoreClass3(a,!0);case b("VideoComposerActionTypes").QUESTIONS_CANCEL_CHANGES_ATTEMPT:if(this.$VideoComposerQuestionsStoreClass2(a))return a.set("showCancelConfirmDialog",!0);else return this.$VideoComposerQuestionsStoreClass3(a,a.questions.size===0);case b("VideoComposerActionTypes").QUESTIONS_DRAFT_UPDATE_END_TIME:return a.set("draftQuestion",a.draftQuestion.set("endTime",c.time));case b("VideoComposerActionTypes").QUESTIONS_DRAFT_UPDATE_QUESTION:return a.set("draftQuestion",a.draftQuestion.set("questionText",c.text));case b("VideoComposerActionTypes").QUESTIONS_DRAFT_UPDATE_START_TIME:return a.set("draftQuestion",a.draftQuestion.set("startTime",c.time));case b("VideoComposerActionTypes").QUESTIONS_EDIT_ATTEMPT:return a;case b("VideoComposerActionTypes").QUESTIONS_SAVE:return this.$VideoComposerQuestionsStoreClass4(a);case b("VideoComposerActionTypes").QUESTIONS_DELETE_ATTEMPT:var e=c.questionID;d=a.questions.findIndex(function(a){return a.id===e});return a.set("questions",a.questions["delete"](d));case b("VideoComposerActionTypes").QUESTIONS_CANCEL_CHANGES_ABANDON:return a.set("showCancelConfirmDialog",!1);case b("VideoComposerActionTypes").QUESTIONS_CANCEL_CHANGES_CONFIRM:return this.$VideoComposerQuestionsStoreClass3(a,!1);case b("VideoComposerActionTypes").QUESTIONS_CLOSE_EDITOR_ABANDON:return a.set("showCloseEditorConfirmDialog",!1);case b("VideoComposerActionTypes").QUESTIONS_CLOSE_EDITOR_CONFIRM:return this.$VideoComposerQuestionsStoreClass3(a,!0);default:return a}};d.$VideoComposerQuestionsStoreClass4=function(a){var c=a.draftQuestion;c=c.set("questionText",c.questionText.trim());var d=a.isAddingNewQuestion?a.questions.push(a.draftQuestion.set("id",b("uuid")())):a.questions.set(a.questions.findIndex(function(b){return b.id===a.draftQuestion.id}),a.draftQuestion);d=d.sortBy(function(a){return b("VideoComposerPollsUtils").timeStringToSeconds(a.startTime)});return this.$VideoComposerQuestionsStoreClass5(a.set("draftQuestion",c)).set("questions",d)};d.$VideoComposerQuestionsStoreClass2=function(a){if(a.isEditingQuestion){var c=a.questions.find(function(b){return b.id===a.draftQuestion.id});return!b("immutable").is(c,a.draftQuestion)}return a.isAddingNewQuestion?!!a.draftQuestion.questionText.trim():!1};d.$VideoComposerQuestionsStoreClass3=function(a,b){if(b)return this.$VideoComposerQuestionsStoreClass6(this.$VideoComposerQuestionsStoreClass5(a).set("showCancelConfirmDialog",!1).set("showCloseEditorConfirmDialog",!1));else return this.$VideoComposerQuestionsStoreClass5(a).set("showCancelConfirmDialog",!1).set("showCloseEditorConfirmDialog",!1)};d.$VideoComposerQuestionsStoreClass5=function(a){return a.set("isAddingNewQuestion",!1).set("isEditingQuestion",!1)};d.$VideoComposerQuestionsStoreClass6=function(a){return a.set("showEditor",!1)};d.$VideoComposerQuestionsStoreClass1=function(a){var c=g(),d=b("VideoComposerStores").getMetadataStore(a.videoComposerID).getState();d=d.videoDuration;if(d!=null){var e=d;e=d>=b("VideoComposerQuestionsConstants").INITIAL_QUESTION_DEFAULT_DURATION?b("VideoComposerQuestionsConstants").INITIAL_QUESTION_DEFAULT_DURATION:b("VideoComposerQuestionsConstants").MIN_QUESTION_DURATION;d=b("VideoComposerStores").getTrimmingEditorStore(a.videoComposerID).getState();a=d.endTime;d=d.startTime;a=a!=null?a:e;d=d||0;e=a-d;a=Math.ceil(e);c=c.set("startTime",a>=h?"00:00:00":"00:00");c=c.set("endTime",b("VideoComposerPollsUtils").secondsToTimeString(a))}return c};d.getPostRequestDataToSend=function(){var a=this.getState().questions.toArray().map(this.mapQuestionRecordToNewQuestionRequestData);a=b("flattenPHPQueryData")({questions:a});return b("Promise").resolve(a)};return c}(b("VideoComposerStoreBase"));e.exports=c}),null);
__d("VideoComposerSoundEditorSoundCollectionStoreClass",["invariant","DateConsts","ImmutableRecordWithV4Types","MediaManagerUtils","SoundCollectionConstants","SoundCollectionTabState","SoundCollectionTabStateToStoreKey","VideoComposerActionTypes","VideoComposerSoundEditorActions","VideoComposerSoundEditorUtils","VideoComposerStoreBase","VideoComposerStores","immutable","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";a=b("ImmutableRecordWithV4Types").Record;var h=b("SoundCollectionConstants").TAB_KEYS,i=["categorySelected","genreSelected","moodSelected","vocalSelected"],j=a({videoComposerID:"",audioPlayer:null,categorySelected:null,effectTab:new(b("SoundCollectionTabState"))("sound_effects"),genreSelected:null,isPlaying:!1,moodSelected:null,playTrack:null,selectedTab:"sound_tracks",selectedTracks:b("immutable").OrderedMap(),trackTab:new(b("SoundCollectionTabState"))("sound_tracks"),vocalSelected:null});c=function(a){babelHelpers.inheritsLoose(c,a);function c(){var c,d;for(var e=arguments.length,f=new Array(e),g=0;g<e;g++)f[g]=arguments[g];return(c=d=a.call.apply(a,[this].concat(f))||this,d.$VideoComposerSoundEditorSoundCollectionStoreClass5=function(a,c,e){var f=[];e.data.forEach(function(a){a.title&&f.push({artistName:a.display_artist,downloadLink:a.download_hd_url,id:a.id,lengthInSec:Math.round(a.duration_in_ms/b("DateConsts").MS_PER_SEC),mediaTags:a.media_tags?a.media_tags.data:[],title:a.title,type:c})});e.next&&b("VideoComposerSoundEditorActions").setSoundCollectionNextPagePromise(d.getState().videoComposerID,e.next(),c);b("VideoComposerSoundEditorActions").setSoundCollectionSearchResults(d.getState().videoComposerID,a.concat(f),c,e.summary.total_count)},c)||babelHelpers.assertThisInitialized(d)}var d=c.prototype;d.getInitialState=function(){return j()};d.reduceImpl=function(a,c){var d=c.soundCollectionTab||c.resultType||a.selectedTab;d==="sound_tracks"||d==="sound_effects"||g(0,3191);var e=b("SoundCollectionTabStateToStoreKey")[d],f=a.get(e);switch(c.type){case b("VideoComposerActionTypes").OPEN_SOUND_EDITOR:a=this.$VideoComposerSoundEditorSoundCollectionStoreClass1(a);return a;case b("VideoComposerActionTypes").CONFIRM_CLOSE_SOUND_EDITOR:case b("VideoComposerActionTypes").SOUND_EDITOR_SAVE_DRAFT:a=this.$VideoComposerSoundEditorSoundCollectionStoreClass2(a);return this.$VideoComposerSoundEditorSoundCollectionStoreClass3(a);case b("VideoComposerActionTypes").RESET_COMPOSER:a=this.getInitialState();return a;case b("VideoComposerActionTypes").SOUND_EDITOR_SET_SOUND_COLLECTION_AUDIO_PLAYER:a=a.set("audioPlayer",c.audioPlayer);return a;case b("VideoComposerActionTypes").SOUND_EDITOR_SET_SOUND_COLLECTION_FILTER_SELECTION:if(i.indexOf(c.tagtype)!==-1){var j=c.tagtype;a=a.set(j,c.value)}else f=f.set(c.tagtype,c.value),a=a.set(e,f);return this.$VideoComposerSoundEditorSoundCollectionStoreClass4(a,e);case b("VideoComposerActionTypes").SOUND_EDITOR_SET_SOUND_COLLECTION_IS_PLAYING:a=a.set("isPlaying",c.isPlaying);j=a.get("audioPlayer");j&&j.setPlayPauseTo(c.isPlaying);return a;case b("VideoComposerActionTypes").SOUND_EDITOR_SET_SOUND_COLLECTION_NEXT_PAGE_PROMISE:if(!e)return a;f=f.set("nextPagePromise",c.promise);return a.set(e,f);case b("VideoComposerActionTypes").SOUND_EDITOR_SET_SOUND_COLLECTION_PLAY_TRACK:a=a.set("playTrack",c.track?c.track:null).set("isPlaying",!0);return a;case b("VideoComposerActionTypes").SOUND_EDITOR_SET_SOUND_COLLECTION_SEARCH_RESULTS:if(!e)return a;f=f.set("results",c.results).set("totalResultsCount",c.totalResultsCount);return a.set(e,f);case b("VideoComposerActionTypes").SOUND_EDITOR_SET_SOUND_COLLECTION_TAB:return a.set("selectedTab",c.soundCollectionTab);case b("VideoComposerActionTypes").SOUND_EDITOR_SET_SOUND_COLLECTION_TAB_LOADING_DONE:f=f.set("loading",!1);return a.set(e,f);case b("VideoComposerActionTypes").SOUND_EDITOR_SET_SOUND_COLLECTION_TAB_LOADING_ERROR:f=f.set("errorInTab",!0).set("loading",!1);return a.set(e,f);case b("VideoComposerActionTypes").SOUND_EDITOR_SOUND_COLLECTION_INIT:j=b("MediaManagerUtils").getNewPromiseID();var k=[];for(var l=h,m=Array.isArray(l),n=0,l=m?l:l[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var o;if(m){if(n>=l.length)break;o=l[n++]}else{n=l.next();if(n.done)break;o=n.value}o=o;var p=a.get(o),q=b("VideoComposerSoundEditorUtils").getSoundCollectionTabQueryPromise(b("VideoComposerStores").getMetadataStore(a.videoComposerID).getAccessToken(),this.$VideoComposerSoundEditorSoundCollectionStoreClass5,j,this.$VideoComposerSoundEditorSoundCollectionStoreClass6(a),p);p=a.get(o).set("loading",!0).set("currentPromise",q).set("errorInTab",!1);a=a.set(o,p);k.push({currentPromise:q,tabKey:o})}this.$VideoComposerSoundEditorSoundCollectionStoreClass7(k,j);return a;case b("VideoComposerActionTypes").SOUND_EDITOR_SOUND_COLLECTION_LOAD_NEXT_PAGE:return this.$VideoComposerSoundEditorSoundCollectionStoreClass8(a,f,e,d);case b("VideoComposerActionTypes").SOUND_EDITOR_SOUND_COLLECTION_LOAD_TABS_DONE:for(var p=h,q=Array.isArray(p),o=0,p=q?p:p[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){if(q){if(o>=p.length)break;n=p[o++]}else{o=p.next();if(o.done)break;n=o.value}m=n;f=a.get(m).set("loading",!1);a=a.set(m,f)}return a;case b("VideoComposerActionTypes").SOUND_EDITOR_SOUND_COLLECTION_LOAD_TABS_ERROR:return a;case b("VideoComposerActionTypes").SOUND_EDITOR_SOUND_COLLECTION_SELECT_TRACK:return this.$VideoComposerSoundEditorSoundCollectionStoreClass9(a,c);case b("VideoComposerActionTypes").SOUND_EDITOR_SOUND_COLLECTION_UNSELECT_TRACK:return this.$VideoComposerSoundEditorSoundCollectionStoreClass10(a,c);case b("VideoComposerActionTypes").SOUND_EDITOR_ADD_NESTING_TRACK_ITEM:l=c.trackId;k=c.trackData;return this.$VideoComposerSoundEditorSoundCollectionStoreClass11(a,l,k);case b("VideoComposerActionTypes").SOUND_EDITOR_DELETE_ADDED_TRACK:return this.$VideoComposerSoundEditorSoundCollectionStoreClass12(a,c);case b("VideoComposerActionTypes").SOUND_EDITOR_SUBMIT_EFFECTS_SEARCHSTRING:a=this.$VideoComposerSoundEditorSoundCollectionStoreClass13(a,"effectTab",c.value);return this.$VideoComposerSoundEditorSoundCollectionStoreClass4(a,"effectTab");case b("VideoComposerActionTypes").SOUND_EDITOR_SUBMIT_TRACKS_SEARCHSTRING:a=this.$VideoComposerSoundEditorSoundCollectionStoreClass13(a,"trackTab",c.value);return this.$VideoComposerSoundEditorSoundCollectionStoreClass4(a,"trackTab");case b("VideoComposerActionTypes").SOUND_EDITOR_UPDATE_SELECTED_TRACK_NESTING_ITEM_ORDER:return this.$VideoComposerSoundEditorSoundCollectionStoreClass14(a,c.trackId);default:return a}};d.$VideoComposerSoundEditorSoundCollectionStoreClass2=function(a){for(var b=h,c=Array.isArray(b),d=0,b=c?b:b[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var e;if(c){if(d>=b.length)break;e=b[d++]}else{d=b.next();if(d.done)break;e=d.value}e=e;e=a.get(e).get("currentPromise");e&&e.isOngoing()&&e.cancel()}return a};d.$VideoComposerSoundEditorSoundCollectionStoreClass3=function(a){var b=a;b=b.selectedTracks;b=b.map(function(a){a.nestingItems=a.nestingItems.clear();return a});a=this.getInitialState();return a.set("selectedTracks",b)};d.$VideoComposerSoundEditorSoundCollectionStoreClass1=function(a){var c=b("VideoComposerStores").getSoundEditorStore(a.videoComposerID).getState();c=c.addedTracks;var d=a.selectedTracks;c.forEach(function(a){if(d.has(a.sourceId)){var b=d.get(a.sourceId);b.nestingItems=b.nestingItems.set(a.id,a)}});d=d.map(function(a){a.nestingItems.sort(function(a,c){return b("VideoComposerSoundEditorUtils").compareSelectedTracks(a,c)});return babelHelpers["extends"]({},a)});return a.set("selectedTracks",d)};d.$VideoComposerSoundEditorSoundCollectionStoreClass6=function(a){return{category:a.categorySelected,genre:a.genreSelected,mood:a.moodSelected,vocal:a.vocalSelected}};d.$VideoComposerSoundEditorSoundCollectionStoreClass8=function(a,c,d,e){if(!d)return a;var f=c.get("nextPagePromise");f&&(c=c.set("nextPagePromise",null).set("loading",!0),f.then(this.$VideoComposerSoundEditorSoundCollectionStoreClass5.bind(this,c.get("results"),e)).done(function(){b("VideoComposerSoundEditorActions").setSoundCollectionTabLoadingDone(a.videoComposerID,e)},function(){b("VideoComposerSoundEditorActions").setSoundCollectionTabLoadingError(a.videoComposerID,e)}));return a.set(d,c)};d.$VideoComposerSoundEditorSoundCollectionStoreClass15=function(a,c){var d=this,e=a,f=e.type,g=b("SoundCollectionTabStateToStoreKey")[f];a=a.set("results",[]).set("totalResultsCount",0).set("nextPagePromise",null).set("loading",!0);b("promiseDone")(c.promise,function(){c.id===d.getState().get(g).get("currentPromise").id?b("VideoComposerSoundEditorActions").setSoundCollectionTabLoadingDone(d.getState().videoComposerID,f):c.cancel()},function(a){a.isCanceled||b("VideoComposerSoundEditorActions").setSoundCollectionTabLoadingError(d.getState().videoComposerID,f)});return a};d.$VideoComposerSoundEditorSoundCollectionStoreClass7=function(a,c){var d=this,e=b("MediaManagerUtils").combineCancelablePromises(c,[].concat(a.map(function(a){return a.currentPromise})),"SOUND_COLLECTION_TAB",[]);b("promiseDone")(e.promise,function(){var c=!0;for(var f=a,g=Array.isArray(f),h=0,f=g?f:f[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var i;if(g){if(h>=f.length)break;i=f[h++]}else{h=f.next();if(h.done)break;i=h.value}i=i;if(i.currentPromise.id!==d.getState().get(i.tabKey).get("currentPromise").id){c=!1;break}}c?b("VideoComposerSoundEditorActions").loadSoundCollectionTabsDone(d.getState().videoComposerID):e.cancel()},function(a){a.isCanceled||b("VideoComposerSoundEditorActions").loadSoundCollectionTabsError(d.getState().videoComposerID,a)})};d.$VideoComposerSoundEditorSoundCollectionStoreClass11=function(a,c,d){var e=a.get("selectedTracks");if(e.has(c)){var f=e.get(c);d=f.nestingItems.set(d.id,d).sort(function(a,c){return b("VideoComposerSoundEditorUtils").compareSelectedTracks(a,c)});f={orderNumber:f.orderNumber,trackResult:f.trackResult,nestingItems:d};e=e.set(c,f);a=a.set("selectedTracks",e)}return a};d.$VideoComposerSoundEditorSoundCollectionStoreClass12=function(a,b){var c=b.trackResultId;b=b.addedTrackId;var d=a.get("selectedTracks");if(d.has(c)){var e=d.get(c);b=e.nestingItems["delete"](b);e={orderNumber:e.orderNumber,trackResult:e.trackResult,nestingItems:b};d=d.set(c,e);a=a.set("selectedTracks",d)}return a};d.$VideoComposerSoundEditorSoundCollectionStoreClass9=function(a,c){var d=a.get("selectedTracks"),e={orderNumber:d.size+1,trackResult:c.track,nestingItems:b("immutable").OrderedMap()};d=d.set(c.track.id,e);return a.set("selectedTracks",d)};d.$VideoComposerSoundEditorSoundCollectionStoreClass10=function(a,b){var c=a.get("selectedTracks"),d=c.get(b.trackId);c=c["delete"](b.trackId);c=c.map(function(a){a.orderNumber>d.orderNumber&&(a.orderNumber-=1);return a});return a.set("selectedTracks",c)};d.$VideoComposerSoundEditorSoundCollectionStoreClass13=function(a,b,c){return c===void 0?a:a.set(b,a.get(b).set("searchString",c))};d.$VideoComposerSoundEditorSoundCollectionStoreClass14=function(a,c){var d=a.get("selectedTracks");if(d.has(c)){var e=d.get(c),f=e.nestingItems.sort(function(a,c){return b("VideoComposerSoundEditorUtils").compareSelectedTracks(a,c)});e={orderNumber:e.orderNumber,trackResult:e.trackResult,nestingItems:f};d=d.set(c,e);a=a.set("selectedTracks",d)}return a};d.$VideoComposerSoundEditorSoundCollectionStoreClass4=function(a,c){var d=a.get(c),e=d.get("currentPromise");e&&e.isOngoing()&&e.cancel();var f=b("MediaManagerUtils").getNewPromiseID();e=b("VideoComposerSoundEditorUtils").getSoundCollectionTabQueryPromise(b("VideoComposerStores").getMetadataStore(a.videoComposerID).getAccessToken(),this.$VideoComposerSoundEditorSoundCollectionStoreClass5,f,this.$VideoComposerSoundEditorSoundCollectionStoreClass6(a),a.get(c));d=this.$VideoComposerSoundEditorSoundCollectionStoreClass15(d,e);return a.set(c,d.set("currentPromise",e))};d.getSelectedTrackDataById=function(a){var b=this.getState();b=b.selectedTracks;return b.has(a)?b.get(a):null};return c}(b("VideoComposerStoreBase"));e.exports=c}),null);
__d("VideoComposerSoundEditorStoreClass",["DateConsts","ImmutableRecordWithV4Types","SubscriptionsHandler","VideoComposerActionTypes","VideoComposerDragAndDropScrubberConstants","VideoComposerDragAndDropScrubberTypes","VideoComposerSoundEditorActions","VideoComposerStoreBase","VideoComposerStores","immutable","uuid"],(function(a,b,c,d,e,f){"use strict";a=b("ImmutableRecordWithV4Types").Record;var g=b("VideoComposerDragAndDropScrubberTypes").VideoComposerDragAndDropScrubberActionTypes,h=b("VideoComposerDragAndDropScrubberTypes").VideoComposerDragAndDropScrubberItemSourceNumberShapeTypes,i=b("VideoComposerDragAndDropScrubberTypes").VideoComposerDragAndDropScrubberItemSourceTypes,j={downloadLink:"",id:"0",lengthInSec:0,mediaTags:[],title:"",type:"sound_tracks"},k=a({videoComposerID:"",addedTracks:b("immutable").List(),audioPlayer:null,draftAddedTracks:b("immutable").List(),editingTrackData:null,hasChanged:!1,isPlaying:!1,playTrack:j,scrubber:null,showCancelConfirmDialog:!1,showEditor:!1,showTrackSelector:!0,showVideoVolumeEditor:!1,videoPlayerController:null,videoVolume:null}),l=1;c=function(a){babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.getInitialState=function(){return k()};d.reduceImpl=function(a,c){switch(c.type){case b("VideoComposerActionTypes").FINISH_TRACK_SELECTION:return a.set("showTrackSelector",!1);case b("VideoComposerActionTypes").OPEN_SOUND_EDITOR:a=this.$VideoComposerSoundEditorStoreClass2(a);return a.set("showEditor",!0);case b("VideoComposerActionTypes").OPEN_TRACK_SELECTOR:return a.set("editingTrackData",null).set("showTrackSelector",!0);case b("VideoComposerActionTypes").ATTEMPT_CLOSE_SOUND_EDITOR:return a.set("showCancelConfirmDialog",!0);case b("VideoComposerActionTypes").CANCEL_CLOSE_SOUND_EDITOR:return a.set("showCancelConfirmDialog",!1);case b("VideoComposerActionTypes").CONFIRM_CLOSE_SOUND_EDITOR:return this.$VideoComposerSoundEditorStoreClass3(a);case b("VideoComposerActionTypes").RESET_COMPOSER:a=this.getInitialState();return a;case b("VideoComposerActionTypes").SOUND_EDITOR_SET_VIDEO_PLAYER_VOLUME:var d=a;d=d.videoPlayerController;d&&d.setVolume(c.volume);return a;case b("VideoComposerActionTypes").SOUND_EDITOR_SET_VIDEO_VOLUME:return a.set("videoVolume",c.volume);case b("VideoComposerActionTypes").SOUND_EDITOR_SHOW_VIDEO_VOLUME_EDITOR:return a.set("showVideoVolumeEditor",c.show);case b("VideoComposerActionTypes").SOUND_EDITOR_EDIT_ADDED_TRACK:return this.$VideoComposerSoundEditorStoreClass4(a,c);case b("VideoComposerActionTypes").SOUND_EDITOR_DELETE_ADDED_TRACK:d=c.index;var e=c.trackResultId,f=c.addedTrackId;return this.$VideoComposerSoundEditorStoreClass5(a,d,e,f);case b("VideoComposerActionTypes").SOUND_EDITOR_REGISTER_SCRUBBER:return a.set("scrubber",c.scrubber);case b("VideoComposerActionTypes").SOUND_EDITOR_UPDATE_ADDED_TRACK:a=this.$VideoComposerSoundEditorStoreClass6(a,c);return a;case b("VideoComposerActionTypes").SOUND_EDITOR_UPDATE_ADDED_TRACK_VOLUME:return this.$VideoComposerSoundEditorStoreClass6(a,c);case b("VideoComposerActionTypes").SOUND_EDITOR_UPDATE_VIDEO_PLAYER_CONTROLLER:return this.$VideoComposerSoundEditorStoreClass7(a,c.vpc);case b("VideoComposerActionTypes").SOUND_EDITOR_SAVE_DRAFT:a=this.$VideoComposerSoundEditorStoreClass8(a);a=this.$VideoComposerSoundEditorStoreClass3(a);return a.set("showTrackSelector",!1);case b("VideoComposerActionTypes").SOUND_EDITOR_SCRUBBER_ADD_TRACK:return this.$VideoComposerSoundEditorStoreClass9(a,c);case b("VideoComposerActionTypes").SOUND_EDITOR_SET_SCRUBBER_FOCUS_POSITION:d=a;e=d.scrubber;e&&e.scrollToTimePosition(c.positionInMs);return a;case b("VideoComposerActionTypes").SOUND_EDITOR_SET_SOUND_COLLECTION_AUDIO_PLAYER:a=a.set("audioPlayer",c.audioPlayer);return a;case b("VideoComposerActionTypes").SOUND_EDITOR_SET_SOUND_COLLECTION_IS_PLAYING:a=a.set("isPlaying",c.isPlaying);f=a.get("audioPlayer");f&&f.setPlayPauseTo(c.isPlaying);return a;case b("VideoComposerActionTypes").SOUND_EDITOR_SET_SOUND_COLLECTION_PLAY_TRACK:a=a.set("playTrack",c.track?c.track:j).set("isPlaying",!0);return a;default:return a}};d.hasUnsavedDraftChanges=function(){return this.getState().hasChanged};d.$VideoComposerSoundEditorStoreClass7=function(a,c){this.$VideoComposerSoundEditorStoreClass1&&this.$VideoComposerSoundEditorStoreClass1.release();c&&(this.$VideoComposerSoundEditorStoreClass1=new(b("SubscriptionsHandler"))(),this.$VideoComposerSoundEditorStoreClass1.addSubscriptions(c.addListener("changeVolume",function(c){b("VideoComposerSoundEditorActions").setVideoVolume(a.videoComposerID,c.volume)}),c.addListener("muteVideo",function(c){b("VideoComposerSoundEditorActions").setVideoVolume(a.videoComposerID,0)}),c.addListener("unmuteVideo",function(d){b("VideoComposerSoundEditorActions").setVideoVolume(a.videoComposerID,c?c.getVolume():null)})),a=a.set("videoVolume",c.getVolume()));return a.set("videoPlayerController",c)};d.$VideoComposerSoundEditorStoreClass3=function(a){this.$VideoComposerSoundEditorStoreClass1&&this.$VideoComposerSoundEditorStoreClass1.release();var b=a,c=b.addedTracks;b=b.videoVolume;a=this.getInitialState();return a.set("addedTracks",c).set("videoVolume",b)};d.$VideoComposerSoundEditorStoreClass2=function(a){var b=a.addedTracks;b=b.map(function(a){return babelHelpers["extends"]({},a)});return a.set("draftAddedTracks",b)};d.$VideoComposerSoundEditorStoreClass8=function(a){var c=a.draftAddedTracks;return a.set("addedTracks",b("immutable").List(c))};d.$VideoComposerSoundEditorStoreClass4=function(a,b){return a.set("editingTrackData",b.addedTrackData)};d.$VideoComposerSoundEditorStoreClass10=function(a,c,d,e,f){var g=f.trackResult.lengthInSec*b("DateConsts").MS_PER_SEC,j=f.trackResult,k=j.artistName,m=j.downloadLink;j=j.title;return{lastModifiedTimestamp:Date.now(),endTimeInMs:a,id:b("uuid")(),maxEndTimeInMs:d?d.startTimeInMs-l:null,minStartTimeInMs:c?c.endTimeInMs+l:null,startTimeInMs:e,itemDurationInMs:g,itemStartTimeInMs:0,itemEndTimeInMs:g,itemVolume:b("VideoComposerDragAndDropScrubberConstants").DEFAULT_TRACK_VOLUME,sourceId:f.trackResult.id,sourceOrderNumberShape:f.trackResult.type==="sound_effects"?h.SQUARE:h.CIRCLE,sourceSubtitle:k?k:"",sourceTitle:j,sourceType:i.AUDIO,sourceURL:m}};d.$VideoComposerSoundEditorStoreClass11=function(a,b,c){a=c.findLastIndex(function(a){return a.startTimeInMs<b});var d=c.findIndex(function(a){return a.startTimeInMs>b}),e=a==-1?null:c.get(a);c=d==-1?null:c.get(d);return{leftItemIndex:a,leftItem:e,rightItemIndex:d,rightItem:c}};d.$VideoComposerSoundEditorStoreClass9=function(a,c){var d=b("VideoComposerStores").getSoundEditorSoundCollectionStore(a.videoComposerID).getSelectedTrackDataById(c.trackId);if(!d)return a;var e=a.get("draftAddedTracks"),f=c.startTimeInMs;c=c.endTimeInMs;var g=this.$VideoComposerSoundEditorStoreClass11(c,f,e),h=g.leftItemIndex,i=g.leftItem;g=g.rightItem;var j=Date.now();i&&(f=Math.max(i.endTimeInMs+l,f),i.maxEndTimeInMs=f-l,i.lastModifiedTimestamp=j++);g&&(c=Math.min(g.startTimeInMs-l,c),g.minStartTimeInMs=c+l,g.lastModifiedTimestamp=j++);if(c-f<b("VideoComposerDragAndDropScrubberConstants").MINIMUM_DURATION_IN_MS)return a;d=this.$VideoComposerSoundEditorStoreClass10(c,i,g,f,d);d.itemEndTimeInMs=c-f;d.lastModifiedTimestamp=j++;c=[];i&&c.push(i);c.push(d);g&&c.push(g);e=(f=e).splice.apply(f,[Math.max(h,0),c.length-1].concat(c));return a.set("draftAddedTracks",e).set("editingTrackData",d).set("hasChanged",!0)};d.$VideoComposerSoundEditorStoreClass6=function(a,b){b.actionType===g.RESIZE?a=this.$VideoComposerSoundEditorStoreClass12(a,b):b.actionType===g.MOVE?a=this.$VideoComposerSoundEditorStoreClass13(a,b):b.actionType===g.TRACK_VOLUME&&(a=this.$VideoComposerSoundEditorStoreClass14(a,b));if(a.editingTrackData){b=a.draftAddedTracks.get(b.index);a.editingTrackData&&a.editingTrackData.id===b.id&&(a=a.set("editingTrackData",b))}return a.set("hasChanged",!0)};d.$VideoComposerSoundEditorStoreClass5=function(a,b,c,d){c=a.get("draftAddedTracks");if(b===null||b==void 0){b=c.findIndex(function(b,a){return b.id===d});if(b===-1)return a}var e=Date.now(),f=b>0?c.get(b-1):null,g=b<c.size-1?c.get(b+1):null;f&&(f.maxEndTimeInMs=g?g.startTimeInMs:null,f.lastModifiedTimestamp=e++);g&&(g.minStartTimeInMs=f?f.endTimeInMs:0,g.lastModifiedTimestamp=e++);c=c.splice(b,1);e=[];f&&e.push(f);g&&e.push(g);c=(f=c).splice.apply(f,[Math.max(b-1,0),e.length].concat(e));return a.set("draftAddedTracks",c).set("hasChanged",!0)};d.$VideoComposerSoundEditorStoreClass14=function(a,b){var c=a.get("draftAddedTracks"),d=c.get(b.index);d.itemVolume=b.volume;d.lastModifiedTimestamp=Date.now();c=c.splice(b.index,1,d);return a.set("draftAddedTracks",c)};d.$VideoComposerSoundEditorStoreClass12=function(a,b){var c=a.get("draftAddedTracks"),d=b.startTimeInMs,e=b.endTimeInMs,f=c.get(b.index),g=f.startTimeInMs,h=f.endTimeInMs;f.startTimeInMs=d;f.endTimeInMs=e;var i=Date.now();f.itemStartTimeInMs-=g-d;f.itemEndTimeInMs-=h-e;f.lastModifiedTimestamp=i++;g=b.index>0?c.get(b.index-1):null;d=b.index<c.size-1?c.get(b.index+1):null;g&&(g.maxEndTimeInMs=f.startTimeInMs-l,g.lastModifiedTimestamp=i++);d&&(d.minStartTimeInMs=f.endTimeInMs+l,d.lastModifiedTimestamp=i++);h=[];g&&h.push(g);h.push(f);d&&h.push(d);c=(e=c).splice.apply(e,[Math.max(b.index-1,0),h.length].concat(h));return a.set("draftAddedTracks",c)};d.$VideoComposerSoundEditorStoreClass13=function(a,b){var c=a.get("draftAddedTracks"),d=b.startTimeInMs,e=b.endTimeInMs,f=c.findIndex(function(a,c){return c!=b.index&&a.endTimeInMs>=d&&a.startTimeInMs<=e}),g=Date.now();if(f===-1){f=c.get(b.index);f.startTimeInMs=b.startTimeInMs;f.endTimeInMs=b.endTimeInMs;f.lastModifiedTimestamp=g++;var h=b.index>0?c.get(b.index-1):null,i=b.index<c.size-1?c.get(b.index+1):null;h&&(h.maxEndTimeInMs=i?i.startTimeInMs:null,h.lastModifiedTimestamp=g++);i&&(i.minStartTimeInMs=h?h.endTimeInMs:0,i.lastModifiedTimestamp=g++);c=c.splice(b.index,1);var j=[];h&&j.push(h);i&&j.push(i);c=(h=c).splice.apply(h,[Math.max(b.index-1,0),j.length].concat(j));i=this.$VideoComposerSoundEditorStoreClass11(e,d,c);h=i.leftItemIndex;j=i.leftItem;i=i.rightItem;f.minStartTimeInMs=j?j.endTimeInMs+l:null;f.maxEndTimeInMs=i?i.startTimeInMs+l:null;j&&(j.maxEndTimeInMs=f.startTimeInMs-l,j.lastModifiedTimestamp=g++);i&&(i.minStartTimeInMs=f.endTimeInMs+l,i.lastModifiedTimestamp=g++);var k=[];j&&k.push(j);k.push(f);i&&k.push(i);c=(j=c).splice.apply(j,[Math.max(h,0),k.length-1].concat(k))}else{f=c.get(b.index);f.lastModifiedTimestamp=g++;c=c.splice(b.index,1,f)}return a.set("draftAddedTracks",c)};d.getAddedTrackIndexById=function(a){var b=this.getState();b=b.draftAddedTracks;return b.findIndex(function(b){return b.id===a})};d.getEditingTrackData=function(){var a=this.getState();a=a.editingTrackData;return a};d.getVideoEditorConfigData=function(){var a=this.getState(),b=a.addedTracks;a=a.videoVolume;b=b.size>0?b:null;a=a!=null&&a>=0?a:null;return{addedTracks:b,videoVolume:a}};return c}(b("VideoComposerStoreBase"));e.exports=c}),null);
__d("VideoComposerTrimmingEditorStoreClass",["Promise","ActorURI","AsyncRequest","ImmutableRecordWithV4Types","VideoComposerActionTypes","VideoComposerStoreBase","VideoComposerStores","VideoComposerTrimmingActions","XVideoComposerWasLiveTrimmingTabController"],(function(a,b,c,d,e,f){"use strict";a=b("ImmutableRecordWithV4Types").Record;var g=a({videoComposerID:"",draftEndTime:null,draftStartTime:null,endTime:null,isPlaying:!1,isWasLiveTrimmed:!1,showCancelConfirmDialog:!1,showEditor:!1,startTime:null,vpc:null});c=function(a){babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.getInitialState=function(){return g()};d.reduceImpl=function(a,c){switch(c.type){case b("VideoComposerActionTypes").ATTEMPT_CLOSE_TRIMMING_EDITOR:if(this.$VideoComposerTrimmingEditorStoreClass1(a))return a.set("showCancelConfirmDialog",!0);else return a.set("showEditor",!1);case b("VideoComposerActionTypes").CANCEL_CLOSE_TRIMMING_EDITOR:return a.set("showCancelConfirmDialog",!1);case b("VideoComposerActionTypes").CONFIRM_CLOSE_TRIMMING_EDITOR:a=a.set("showCancelConfirmDialog",!1);return a.set("showEditor",!1);case b("VideoComposerActionTypes").OPEN_TRIMMING_EDITOR:a=this.$VideoComposerTrimmingEditorStoreClass2(a);return a.set("showEditor",!0);case b("VideoComposerActionTypes").RESET_COMPOSER:return this.getInitialState();case b("VideoComposerActionTypes").TRIMMING_SAVE_DRAFT:a=this.$VideoComposerTrimmingEditorStoreClass3(a);return a.set("showEditor",!1);case b("VideoComposerActionTypes").TRIMMING_PREVIEW_BY_START_END:return this.$VideoComposerTrimmingEditorStoreClass4(a,c);case b("VideoComposerActionTypes").TRIMMING_SET_END_TIME:this.$VideoComposerTrimmingEditorStoreClass5(a.vpc,c.endTime);return a.set("draftEndTime",c.endTime);case b("VideoComposerActionTypes").TRIMMING_SET_PLAYER_STATE:return a.set("isPlaying",c.isPlaying);case b("VideoComposerActionTypes").TRIMMING_SET_START_TIME:this.$VideoComposerTrimmingEditorStoreClass5(a.vpc,c.startTime);return a.set("draftStartTime",c.startTime);case b("VideoComposerActionTypes").TRIMMING_SET_VPC:return a.set("vpc",c.vpc);case b("VideoComposerActionTypes").TRIMMING_SET_IS_WAS_LIVE_TRIMMED:return a.set("isWasLiveTrimmed",c.isWasLiveTrimmed);default:return a}};d.$VideoComposerTrimmingEditorStoreClass1=function(a){var b=a.draftEndTime,c=a.draftStartTime,d=a.endTime;a=a.startTime;return b!=d||c!=a};d.$VideoComposerTrimmingEditorStoreClass2=function(a){var b=a,c=b.endTime;b=b.startTime;a=a.set("draftEndTime",c).set("draftStartTime",b);return a};d.$VideoComposerTrimmingEditorStoreClass4=function(a,b){var c=a.get("vpc");c&&c.emit("previewByStartEndTime",{endTime:b.endTime?b.endTime:0,startTime:b.startTime?b.startTime:0});a=a.set("isPlaying",!0);return a};d.$VideoComposerTrimmingEditorStoreClass3=function(a){var b=a,c=b.draftEndTime;b=b.draftStartTime;a=a.set("endTime",c);a=a.set("startTime",b);return a};d.$VideoComposerTrimmingEditorStoreClass5=function(a,b){a&&a.seek(b)};d.getPostDataForEdit=function(){var a=this.getState(),c=a.draftStartTime;a=a.draftEndTime;var d={};c!=null&&(d.new_start_time=c);a!=null&&(d.new_end_time=a);return b("Promise").resolve(d)};d.fetchEditPostDataForWasLiveTrimming=function(a,c){var d=this;a=b("XVideoComposerWasLiveTrimmingTabController").getURIBuilder().setFBID("video_id",a).getURI();var e=b("ActorURI").create(a,c);return new(b("Promise"))(function(a,c){new(b("AsyncRequest"))(e).setHandler(function(c){b("VideoComposerTrimmingActions").setIsWasLiveTrimmed(d.getState().videoComposerID,c.payload.isWasLiveTrimmed);return a()}).setErrorHandler(function(a){c(a)}).send()})};d.isVideoTrimmed=function(){var a=this.getState(),b=a.endTime,c=a.startTime;a=a.vpc;if(!a)return!1;a=a.getPlaybackDuration();return!c&&(!b||b===a)?!1:!0};d.getVideoEditorConfigData=function(){var a=this.getState(),b=a.endTime,c=a.startTime;a=a.vpc;if(this.isVideoTrimmed()&&a){a=a.getPlaybackDuration();c=c?c:0;b=b?b:a;return{trim_before_start:c,trim_after_end:b}}return null};d.getTrimmedVideoDuration=function(){var a=this.getState(),c=a.endTime,d=a.startTime;a=a.videoComposerID;a=b("VideoComposerStores").getMetadataStore(a).getState();a=a.videoDuration;c=c==null?a==null?0:a:c;d=d||0;return c-d};return c}(b("VideoComposerStoreBase"));e.exports=c}),null);
__d("VideoComposerBestPracticesChecklistUtils",["VideoComposerStores","getMentionsTextForContentState"],(function(a,b,c,d,e,f){"use strict";var g=180;function a(a,c,d,e){d=d.isVideoHighQuality;var f=c.contentTags,h=c.descriptionEditorState;c=c.playlistIDs;e=e.showID;a=b("VideoComposerStores").getTrimmingEditorStore(a).getTrimmedVideoDuration();h=b("getMentionsTextForContentState")(h.getCurrentContent());f=f.length>0;h=h.trim()!=="";a=a>g;c=c.length>0||e!=null;return{hasMinVideoDuration:a,isDescriptionAdded:h,isTagAdded:f,isVideoHighQuality:d,isPlaylistsOrSeriesAdded:c}}e.exports={getBestPracticesChecklistConfig:a}}),null);
__d("VideoComposerCrosspostCaptionsUploadUtils",["Promise","ActorURI","AsyncRequest","GraphAPI","VideoComposerStores","XVideoCaptionUploadAsyncController","killswitch","promiseDone"],(function(a,b,c,d,e,f){"use strict";function a(a,c,d,e,f,i,j,k,l){if(i.length===0){k(a,e,c.id,f);return}if(b("killswitch")("PUBX_VIDEO_CROSSPOST_CREATE_SUBTITLES")){g(a,c,d,e,f,j,k,l);return}var m=c.id,n=b("XVideoCaptionUploadAsyncController").getURIBuilder().setInt("video_id",m).setBool("set_immediate_publish",!0),o=new FormData();i.forEach(function(a,b){b=a.getIsDefault()?"captions_default":"captions_file"+b;o.append(b,a.getFile())});i=n.getURI();n=b("ActorURI").create(i,e);new(b("AsyncRequest"))(n).setMethod("POST").setRawData(o).setHandler(function(b){b=b.payload;if(b&&b.success==="true"&&b.error===""){g(a,c,d,e,f,j,k,l);return}h(m);l(e,b.error)}).send()}function g(a,c,d,f,g,i,j,k){i=b("VideoComposerStores").getCaptionsStore(a).getState();i=i.localCaptionFiles;i=i.toArray();var l=c.id;if(i.length===0){j(a,f,l,g);return}b("promiseDone")(b("Promise").all(i.map(function(c){var g=new FormData();g.append("access_token",d);g.append("captions_file",c.getFile());c.getIsDefault()&&g.append("default_locale",c.getLocale());c=b("GraphAPI")("2.11",e.id).object("video",l).edge("captions").post(g);b("promiseDone")(c,function(){},function(b){h(l),k(a,f,b)});return c})),function(b){j(a,f,l,g)},function(b){h(l),k(a,f,b)})}function h(a){new(b("AsyncRequest"))().setURI("/ajax/video/actions/delete/").setData({fbid:a,redirect:!1}).send()}e.exports={postCaptionsFilesAndSubtitles:a}}),null);
__d("VideoComposerDealUtils",["VideoComposerStores"],(function(a,b,c,d,e,f){"use strict";function a(a){a=b("VideoComposerStores").getBasicStore(a).getState();var c=a.deal,d=a.fundedContentProgram;a=a.showFundedContentFlag;return a&&d===1&&(c==null?void 0:c.has_required_reviews)===!0}function c(a,b){return a==null||b==null?null:b.find(function(b){return b.deal_id==a})}function d(a){return a.filter(function(a){return a.status==="ACTIVE"})}e.exports={getDeal:c,videoRequiresReview:a,getActiveDeals:d}}),null);
__d("VideoEditMentionsTextArea.react",["cx","AtSignMentionsStrategy","DocumentCompositeMentionsSource","DocumentMentionsSource","EditorState","MentionsInput.react","MentionsInputTypeaheadView.react","MentionsInputUtility","React","getMentionsInputDecorator","joinClasses","prop-types"],(function(a,b,c,d,e,f,g){var h=b("React");a=function(a){"use strict";babelHelpers.inheritsLoose(c,a);function c(c){var d;d=a.call(this,c)||this;d.$1=function(a){if(d.props.disabled)return;d.setState({editorState:a});d.props.onChange(a)};d.focus=function(){d.refs.mentionsInput.focus()};var e=new(b("DocumentMentionsSource"))(b("AtSignMentionsStrategy"),c.searchSource);e=new(b("DocumentCompositeMentionsSource"))([e]);var f=c.textWithMentions,g;c.editorState?g=c.editorState:f?g=b("MentionsInputUtility").createFromTextWithMentions(f,b("getMentionsInputDecorator")()):g=b("EditorState").createEmpty(b("getMentionsInputDecorator")());c.onChange(g);d.state={compositeMentionsSource:e,editorState:g};return d}var d=c.prototype;d.render=function(){var a=b("joinClasses")("_2oc3",this.props.className);return h.jsx(b("MentionsInput.react"),{className:a,editorState:this.state.editorState,mentionsSource:this.state.compositeMentionsSource,placeholder:this.props.placeholder,typeaheadView:b("MentionsInputTypeaheadView.react"),typeaheadViewProps:{},onChange:this.$1,ref:"mentionsInput"})};return c}(h.Component);a.propTypes={disabled:b("prop-types").bool};a.defaultProps={disabled:!1};e.exports=a}),null);